/*
 Navicat Premium Data Transfer

 Source Server         : 10.10.80.22-test
 Source Server Type    : MySQL
 Source Server Version : 80020
 Source Host           : 10.10.80.22:3206
 Source Schema         : decent_cloud

 Target Server Type    : MySQL
 Target Server Version : 80020
 File Encoding         : 65001

 Date: 22/02/2023 14:24:11
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Procedure structure for cx_szzt_kcrbb_cw2_5g
-- ----------------------------
DROP PROCEDURE IF EXISTS `cx_szzt_kcrbb_cw2_5g`;
delimiter ;;
CREATE PROCEDURE `cx_szzt_kcrbb_cw2_5g`(in v_showroom_identity varchar(60),v_rq date,`v_start` int, `v_len` int)
BEGIN
###############################################
#创 建 人：赵富强
#描    述：报表：53.深圳展厅库存日报表_财务
#特殊描述：保留了老系统对字段bjJDSrkje和bjJDSckje的征用，即bjJDSrkje征用为商品中心入库金重、bjJDcrkje征用为商品中心出库金重
#修改记录：1、2022-07-20 委外退货单去掉退货状态为已完成的限制，并加上单据是否作废的限制 hyj
#          2、2022-07-20 将商品流水表和展厅库存日总账表的数据查出来放在临时表，并加上索引，后面再从临时表查数据
#          3、2022-07-20 福州工厂入库需要加 福州K金工厂 福州镶嵌工厂
#          4、2022-07-26 商品流水账加  and djh not like 'zj20%' 质检的流水不计算，因为调拨里面已经计算过了
#          5、2022-08-01 修改深圳展厅出库、深圳工厂出库和深圳工厂熔料出库的取值 hyj
#          6、2022-08-11 将足金嵌的数据合并到千足嵌中
#          7、2022-08-17 把千足嵌拆开拆成   镶嵌Q柜  镶嵌柜-德钰东方
#          8、2022-08-22 添加成都展厅的数据   
#          9、2022-08-23 因维修仓、德钰东方的进销存都在老系统操作，因此新系统这两个仓位的库存请信息部清零；
#          10、2022-09-08 添加海南展厅的数据 
#          11、2022-10-12 注释掉中文表头部分 hyj
#          12、2022-10-14 添加条件djm<>'单件调拨出库单' and djm<>'单件调拨入库单' zfq
#          13、2022-10-24 将古法金的取值条件规则和收发的古法金的取值规则调整一致，方杰确认修改 zfq
#          14、2022-10-25 将千足金/千足硬金(期初)的取值条件规则和收发的千足金/千足硬金(期初)的取值规则调整一致，方杰确认修改 zfq
#          15、2022-11-01 放开镶嵌柜-德钰东方的数据
#          16、2022-11-22 库存收发存调整了一下成色名称取数逻辑，由于该报表期初逻辑来源库存收发存，相应调整下 hyj
#          17、2022-11-23 德钰东方|件数的当天结余数据更新时要更新临时表$temp9_new（原先是更新临时表$temp9） hyj
#          18、2022-12-21 添加沈阳展厅的数据
#          19、2022-12-21 期初数据添加其他柜台
#          20、2023-01-11 期初数据将河南-硬金结算的取值成色归属于硬金 zfq
#          21、2023-01-12 期初数据将河南-硬金柜的取值成色归属于硬金 zfq
#          22、2023-02-20 期初数据将,物流部-千足硬金 的取值成色归属于硬金 zfq
#          2023-02-22 硬金成色统计新增柜台 zfq
###############################################
DECLARE v_wdmc VARCHAR(60);

drop temporary table if exists $temp_splsz;
create temporary table $temp_splsz(index idx1(wdmc,ckmc,jsmc)) as  
select * from t_ka_splsz
where rq = v_rq
and djh not like 'zj%' and djm<>'单件调拨出库单' and djm<>'单件调拨入库单';


update $temp_splsz a
  inner join t_receive b
     on a.djh = b.receive_code
      AND B.variety ='HJXQ'
  INNER JOIN t_move_counter C
     ON B.receive_code = C.receive_code
     SET A.CKMC = C.showroom_counter_name
  where a.ckmc = '配货中心'
    AND DJM='调拨入库单';

drop temporary table if exists $temp_ztkcrzz;
create temporary table $temp_ztkcrzz(index idx1(wdmc,ckmc,jsmc)) as  
select * from t_ka_ztkcrzz
where rq = v_rq;
 
set v_wdmc=(select showroom_name from t_showroom where showroom_identity=v_showroom_identity);

drop temporary table if exists $temp1;
create temporary table $temp1 as 
select '千足金' as plm,
 sum(qc) as qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk,
 0 as mxhck,
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
	from 
	 (
	 SELECT CASE WHEN CKMC = '镶嵌Q柜' OR CKMC = '镶嵌硬金柜'OR CKMC = '镶嵌柜-德钰东方' or CKMC = '客单组镶嵌德钰东方' or CKMC = '客单组镶嵌柜' OR CKMC = '维修仓' 
      THEN '千足嵌'
      WHEN (JSMC = '千足硬金') AND CKMC <> '镶嵌Q柜' 
       AND CKMC <> '镶嵌硬金柜'AND CKMC <> '镶嵌柜-德钰东方' 
      AND ckmc <> '客单组镶嵌德钰东方' AND ckmc <> '客单组镶嵌柜' 
      AND CKMC <> '维修仓' AND CKMC <> '古法金柜'
      AND CKMC <> '精品G柜' AND CKMC <> '硬金古法金柜'  
      and ckmc not in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','千足结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','物流部','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')
       and ckmc <> '无字印柜'
       and ckmc <> '客单组'
       and ckmc <> '客单组(5G)'
       and ckmc <> '配货中心'
       THEN '千足金'
      when ckmc in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')OR (ckmc='千足结算' and jsmc='千足硬金') OR (ckmc='广西-千足结算' and jsmc='千足硬金') or(ckmc='物流部' and jsmc='千足硬金')
      then '千足硬金'
            WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity)  
      THEN ''
            WHEN CKMC = '精品G柜' OR JSMC = '足金(5G)' 
      THEN '足金(5G)'
            WHEN JSMC = '古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜' 
      THEN '古法金' 
      when ckmc = '普货A柜'
      then '千足金'
      ELSE JSMC 
    END AS CSMC, 
      CASE 
    WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity) 
    THEN CONCAT('料仓-', JSMC) 
    ELSE CKMC 
   END AS CKMC, 
       QCJZ AS QC
   FROM T_KA_ZTKCRZZ
 WHERE WDMC = '深圳展厅' 
   AND RQ = v_rq
   AND (JSMC NOT LIKE '虚拟金料%')
	 ) t where csmc='千足金'
	 ;

-- 财务报表千足金期初的取值和收发存保持一致(曾维勤和方杰沟通确认修改2022-10-25) 结束-----------------------------------------------------------------------------------------------

--  select '千足金' as plm,
--  sum(qcjz) AS qc,
--  0 as krtcp,
--  0 as fzgcrk,
--  0 as fzztrk,
--  0 as B2BRK,
--  0 as szgcrk,
--  0 as szztrk,
--  0 as bjztrk,
--  0 as bjrkje,
--  0 as bjjdsztrk,
--  0 as bjJDSrkje,
--  0 as zbztrk,
--  0 as sdztrk,
--  0 as sdxxyztrk,
--  0 as jxjdsyyzxrk,
--  0 as jxxxyztrk,
--  0 as KJztrk,
--  0 as wwrk,
--  0 as cgrk,
--  0 as qtrk,
--  0 as rkxj,
--  0 as xsck,
--  0 as szztck,
--  0 as szgcck,
--  0 as sZGCRLck,
--  0 as bjztck,
--  0 as bjckje,
--  0 as bjJDSztck,
--  0 as bjJDSckje,
--  0 as fzztck,
--  0 as B2BCK,
--  0 as zbztck,
--  0 as sdztck,
--  0 as sdXXYztck,
--  0 as jxjdsyyzxck,
--  0 as jxxxyztck,
--  0 as KJztck,
--  0 as wwth,
--  0 as rlzl,
--  0 as wxzl,
--  0 as qxzl ,
--  0 as wtzl,
--  0 as ckxj,
--  0 as dqjc,
--  0 as yk,
--  0 as ymyprk,
--  0 as ymypck,
--  0 as zjdxrk,
--  0 as zjdxck,
--  0 as fjzjrk,
--  0 as fjzjck,
--  0 as mxhrk, -- 梦享会
--  0 as mxhck, -- 梦享会
--  0 as cdztrk, -- 成都展厅入库
--  0 as cdztck,
--  0 as hnztrk,
--  0 as hnztck
--  from $temp_ztkcrzz
-- where wdmc = v_wdmc 
--   and CKMC<>'镶嵌Q柜' 
--     AND CKMC <>'镶嵌柜-德钰东方' 
--     AND CKMC <>'德钰东方K金柜' 
--     and CKMC<>'客单组镶嵌德钰东方' 
--     and CKMC<>'客单组镶嵌柜' 
--     and ckmc<>'镶嵌硬金柜' 
--     and ckmc<>'古法金柜' 
--     and ckmc<>'古法硬金柜' 
--     and ckmc<>'精品G柜'
--   and ckmc<>'维修仓' 
-- -- and NOT EXISTS(SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY AND CKMC = COUNTER_NAME) 
--   and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
--   and ckmc<>'千足赤辰金' 
--     and v_rq=DATE(rq) 
--     and (jsmc='千足金' );

 
-- -------取得商品流水帐里千足素金的入出记录（流水帐
drop temporary table if exists $temp2;

create temporary table $temp2 as 
select '千足金' as plm,
0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS b2brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end) AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0)when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end)  AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'  and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'   and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end) AS qxzl,
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end) AS wtzl,
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where wdmc=v_wdmc 
  and CKMC<>'镶嵌Q柜' 
    AND CKMC <>'镶嵌柜-德钰东方' 
    and CKMC<>'客单组镶嵌德钰东方' 
    and CKMC<>'客单组镶嵌柜'
    AND CKMC <>'德钰东方K金柜'
    and ckmc<>'镶嵌硬金柜'
    and ckmc<>'古法金柜'
    and ckmc<>'古法硬金柜'
    and ckmc<>'精品G柜'
    and ckmc<>'千足赤辰金'
  and ckmc<>'维修仓' 

  and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
  and v_rq=DATE(rq) 
    and (jsmc='千足金');


drop temporary table if exists $temp3;
create temporary table $temp3 as 
select 
'千足金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck)  as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp1 
union all
select * from $temp2 
)a;
update $temp3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);

drop temporary table if exists $tempzj1;
create temporary table $tempzj1 as 
 select '足金' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜' and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'镶嵌硬金柜' and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜'
and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
and ckmc<>'千足赤辰金' and v_rq=DATE(rq) and (jsmc='足金' );

drop temporary table if exists $tempzj2;
create temporary table $tempzj2 as 
select'足金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end) AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end)  AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发' and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发' and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where wdmc=v_wdmc and CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜'  and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'镶嵌硬金柜' and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜'
and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
and v_rq=DATE(rq) and (jsmc='足金' );


drop temporary table if exists $tempzj3;
create temporary table $tempzj3 as 
select 
'足金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $tempzj1 
union all
select * from $tempzj2 
)a;
update $tempzj3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);
-- --------------------------------------硬金
-- drop temporary table if exists $yj0 ;
-- create temporary table $yj0  as 
--  select '硬金' as plm,
--  sum(qcjz) AS qc,
--  0 as krtcp,
--  0 as fzgcrk,
--  0 as fzztrk,
--  0 as B2BRK,
--  0 as szgcrk,
--  0 as szztrk,
--  0 as bjztrk,
--  0 as bjrkje,
--  0 as bjjdsztrk,
--  0 as bjJDSrkje,
--  0 as zbztrk,
--  0 as sdztrk,
--  0 as sdxxyztrk,
--  0 as jxjdsyyzxrk,
--  0 as jxxxyztrk,
--  0 as KJztrk,
--  0 as wwrk,
--  0 as cgrk,
--  0 as qtrk,
--  0 as rkxj,
--  0 as xsck,
--  0 as szztck,
--  0 as szgcck,
--  0 as sZGCRLck,
--  0 as bjztck,
--  0 as bjckje,
--  0 as bjJDSztck,
--  0 as bjJDSckje,
--  0 as fzztck,
--  0 as B2BCK,
--  0 as zbztck,
--  0 as sdztck,
--  0 as sdXXYztck,
--  0 as jxjdsyyzxck,
--  0 as jxxxyztck,
--  0 as KJztck,
--  0 as wwth,
--  0 as rlzl,
--  0 as wxzl,
--  0 as qxzl ,
--  0 as wtzl,
--  0 as ckxj,
--  0 as dqjc,
--  0 as yk,
--  0 as ymyprk,
--  0 as ymypck,
--  0 as zjdxrk,
--  0 as zjdxck,
--  0 as fjzjrk,
--  0 as fjzjck,
--  0 as mxhrk, -- 梦享会
--  0 as mxhck, -- 梦享会
--  0 as cdztrk, -- 成都展厅入库
--  0 as cdztck,
--  0 as hnztrk,
--  0 as hnztck
--  from $temp_ztkcrzz
-- where wdmc=v_wdmc and CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜' and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜'  and ckmc<>'镶嵌硬金柜' and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜'
-- and ckmc<>'维修仓' 
-- -- and NOT EXISTS(SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY AND CKMC = COUNTER_NAME) 
-- and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
-- 
-- and ckmc<>'千足赤辰金' and v_rq=DATE(rq) and (jsmc='千足硬金' );
drop temporary table if exists $yj0 ;
create temporary table $yj0  as 
select '硬金' as plm,
 sum(qc) as qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk,
 0 as mxhck,
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
	from 
	 (
	 SELECT CASE WHEN CKMC = '镶嵌Q柜' OR CKMC = '镶嵌硬金柜'OR CKMC = '镶嵌柜-德钰东方' or CKMC = '客单组镶嵌德钰东方' or CKMC = '客单组镶嵌柜' OR CKMC = '维修仓' 
      THEN '千足嵌'
      WHEN (JSMC = '千足硬金') AND CKMC <> '镶嵌Q柜' 
       AND CKMC <> '镶嵌硬金柜'AND CKMC <> '镶嵌柜-德钰东方' 
      AND ckmc <> '客单组镶嵌德钰东方' AND ckmc <> '客单组镶嵌柜' 
      AND CKMC <> '维修仓' AND CKMC <> '古法金柜'
      AND CKMC <> '精品G柜' AND CKMC <> '硬金古法金柜'  
      and ckmc not in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','千足结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','物流部','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')
       and ckmc <> '无字印柜'
       and ckmc <> '客单组'
       and ckmc <> '客单组(5G)'
       and ckmc <> '配货中心'
       THEN '千足金'
      when ckmc in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')OR (ckmc='千足结算' and jsmc='千足硬金')OR (ckmc='广西-千足结算' and jsmc='千足硬金')or(ckmc='物流部' and jsmc='千足硬金')
      then '千足硬金'
            WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity)  
      THEN ''
            WHEN CKMC = '精品G柜' OR JSMC = '足金(5G)' 
      THEN '足金(5G)'
            WHEN JSMC = '古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜' 
      THEN '古法金' 
      when ckmc = '普货A柜'
      then '千足金'
      ELSE JSMC 
    END AS CSMC, 
      CASE 
    WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity) 
    THEN CONCAT('料仓-', JSMC) 
    ELSE CKMC 
   END AS CKMC, 
       QCJZ AS QC
   FROM T_KA_ZTKCRZZ
 WHERE WDMC = '深圳展厅' 
   AND RQ = v_rq
   AND (JSMC NOT LIKE '虚拟金料%')
	 ) t where csmc='千足硬金'
	 ;


drop temporary table if exists $YJ1 ;
create temporary table $YJ1  as 
select'硬金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end) AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end)  AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz

where wdmc=v_wdmc and CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜'  and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'镶嵌硬金柜' and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜'
and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='千足硬金' );

drop temporary table if exists $YJ;
create temporary table $YJ as 
select 
'硬金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)   as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $YJ0 
union all
select * from $YJ1 
)a;
update $YJ
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);



drop temporary table if exists $temp4 ;
create temporary table $temp4  as 
 select '镶嵌Q柜|重量' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
  0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc AND( CKMC='镶嵌Q柜' );

drop temporary table if exists $temp5 ;
create temporary table $temp5  as 
select'镶嵌Q柜|重量' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end) AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜');

drop temporary table if exists $temp6;
create temporary table $temp6 as 
select 
'镶嵌Q柜|重量' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp4 
union all
select * from $temp5 
)a;
update $temp6
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);



drop temporary table if exists $temp7 ;
create temporary table $temp7  as 
 select '镶嵌Q柜|件数' as plm,
 sum(qcjs) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc AND( CKMC = '镶嵌Q柜');

drop temporary table if exists $temp8 ;
create temporary table $temp8  as 
select'镶嵌Q柜|件数' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(js,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjJDSztrk,
0 AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(js,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(js,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(js,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(js,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(js,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(js,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(js,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(js,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜');

drop temporary table if exists $temp9;
create temporary table $temp9 as 
select 
'镶嵌Q柜|件数' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp7 
union all
select * from $temp8 
)a;
update $temp9
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);



drop temporary table if exists $temp10 ;
create temporary table $temp10  as 
 select '镶嵌Q柜|标签金额' as plm,
 sum(qcje) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc AND( CKMC='镶嵌Q柜' ); 

drop temporary table if exists $temp11 ;
create temporary table $temp11  as 
select'镶嵌Q柜|标签金额' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(bqjg,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收' and  plmc='镶嵌' and jsmc='千足金' then ifnull(bqjg,0) 
              when djm='调拨入库单'  and sffx='收' and chf like '福州工厂%' and ckmc='维修仓' then ifnull(bqjg,0) 
           else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(bqjg,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(bqjg,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(bqjg,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜');

drop temporary table if exists $temp12;
create temporary table $temp12 as 
select 
'镶嵌Q柜|标签金额' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck)  as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp10 
union all
select * from $temp11 
)a;
update $temp12
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);




drop temporary table if exists $temp4_new ;
create temporary table $temp4_new  as 
 select '德钰东方|重量' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc 
and (CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' OR ckmc='镶嵌硬金柜') and v_rq=DATE(rq)  ;

drop temporary table if exists $temp5_new ;
create temporary table $temp5_new  as 
select '德钰东方|重量' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end) AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq 
and (CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜'or ckmc='镶嵌硬金柜') ;

drop temporary table if exists $temp6_new;
create temporary table $temp6_new as 
select 
'德钰东方|重量' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp4_new 
union all
select * from $temp5_new 
)a;
update $temp6_new
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);



drop temporary table if exists $temp7_new ;
create temporary table $temp7_new  as 
 select '德钰东方|件数' as plm,
 sum(qcjs) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
  0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc 
and (CKMC = '镶嵌柜-德钰东方' OR CKMC = '德钰东方K金柜' or CKMC = '客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜'  OR ckmc='镶嵌硬金柜')  and v_rq=DATE(rq)  ;

drop temporary table if exists $temp8_new ;
create temporary table $temp8_new  as 
select'德钰东方|件数' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(js,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjJDSztrk,
0 AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(js,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(js,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(js,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(js,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(js,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(js,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(js,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(js,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq 
and (CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜')  ;

drop temporary table if exists $temp9_new;
create temporary table $temp9_new as 
select 
'德钰东方|件数' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp7_new 
union all
select * from $temp8_new 
)a;
update $temp9_new 
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);


drop temporary table if exists $temp10_new ;
create temporary table $temp10_new  as 
 select '德钰东方|标签金额' as plm,
 sum(qcje) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
  0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc 
and (CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' OR ckmc='镶嵌硬金柜')  and v_rq=DATE(rq)  ;

drop temporary table if exists $temp11_new ;
create temporary table $temp11_new  as 
select'德钰东方|标签金额' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(bqjg,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收' and  plmc='镶嵌' and jsmc='千足金' then ifnull(bqjg,0) 
              when djm='调拨入库单'  and sffx='收' and chf like '福州工厂%' and ckmc='维修仓' then ifnull(bqjg,0) 
           else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(bqjg,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(bqjg,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(bqjg,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq 
and  (CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜')  ;

drop temporary table if exists $temp12_new;
create temporary table $temp12_new as 
select 
'德钰东方|标签金额' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)   as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $temp10_new 
union all
select * from $temp11_new 
)a;
update $temp12_new
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);




drop temporary table if exists $tempgf1 ;
create temporary table $tempgf1  as 
select '古法金' as plm,
 sum(qc) as qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk,
 0 as mxhck,
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
  0 as syztrk,
 0 as syztck
	from 
	 (
	 SELECT CASE WHEN CKMC = '镶嵌Q柜' OR CKMC = '镶嵌硬金柜'OR CKMC = '镶嵌柜-德钰东方' or CKMC = '客单组镶嵌德钰东方' or CKMC = '客单组镶嵌柜' OR CKMC = '维修仓' 
      THEN '千足嵌'
      WHEN (JSMC = '千足硬金') AND CKMC <> '镶嵌Q柜' 
       AND CKMC <> '镶嵌硬金柜'AND CKMC <> '镶嵌柜-德钰东方' 
      AND ckmc <> '客单组镶嵌德钰东方' AND ckmc <> '客单组镶嵌柜' 
      AND CKMC <> '维修仓' AND CKMC <> '古法金柜'
      AND CKMC <> '精品G柜' AND CKMC <> '硬金古法金柜'  
      and ckmc not in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','千足结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','物流部','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')
       and ckmc <> '无字印柜'
       and ckmc <> '客单组'
       and ckmc <> '客单组(5G)'
       and ckmc <> '配货中心'
       THEN '千足金'
      when ckmc in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')OR (ckmc='千足结算' and jsmc='千足硬金')OR (ckmc='广西-千足结算' and jsmc='千足硬金')or(ckmc='物流部' and jsmc='千足硬金')
      then '千足硬金'
            WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity)  
      THEN ''
            WHEN CKMC = '精品G柜' OR JSMC = '足金(5G)' 
      THEN '足金(5G)'
            WHEN JSMC = '古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜' 
      THEN '古法金' 
      when ckmc = '普货A柜'
      then '千足金'
      ELSE JSMC 
    END AS CSMC, 
      CASE 
    WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity) 
    THEN CONCAT('料仓-', JSMC) 
    ELSE CKMC 
   END AS CKMC, 
       QCJZ AS QC
   FROM T_KA_ZTKCRZZ
 WHERE WDMC = '深圳展厅' 
   AND RQ = v_rq
   AND (JSMC NOT LIKE '虚拟金料%')
	 ) t where csmc='古法金';
--  select '古法金' as plm,
--  sum(qcjz) AS qc,
--  0 as krtcp,
--  0 as fzgcrk,
--  0 as fzztrk,
--  0 as B2BRK,
--  0 as szgcrk,
--  0 as szztrk,
--  0 as bjztrk,
--  0 as bjrkje,
--  0 as bjjdsztrk,
--  0 as bjJDSrkje,
--  0 as zbztrk,
--  0 as sdztrk,
--  0 as sdxxyztrk,
--  0 as jxjdsyyzxrk,
--  0 as jxxxyztrk,
--  0 as KJztrk,
--  0 as wwrk,
--  0 as cgrk,
--  0 as qtrk,
--  0 as rkxj,
--  0 as xsck,
--  0 as szztck,
--  0 as szgcck,
--  0 as sZGCRLck,
--  0 as bjztck,
--  0 as bjckje,
--  0 as bjJDSztck,
--  0 as bjJDSckje,
--  0 as fzztck,
--  0 as B2BCK,
--  0 as zbztck,
--  0 as sdztck,
--  0 as sdXXYztck,
--  0 as jxjdsyyzxck,
--  0 as jxxxyztck,
--  0 as KJztck,
--  0 as wwth,
--  0 as rlzl,
--  0 as wxzl,
--  0 as qxzl ,
--  0 as wtzl,
--  0 as ckxj,
--  0 as dqjc,
--  0 as yk,
--  0 as ymyprk,
--  0 as ymypck,
--  0 as zjdxrk,
--  0 as zjdxck,
--  0 as fjzjrk,
--  0 as fjzjck,
--  0 as mxhrk, -- 梦享会
--  0 as mxhck, -- 梦享会
--  0 as cdztrk, -- 成都展厅入库
--  0 as cdztck,
--  0 as hnztrk,
--  0 as hnztck
--  from $temp_ztkcrzz
-- where wdmc=v_wdmc and ckmc<>'维修仓' 
-- -- and NOT EXISTS(SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY AND CKMC = COUNTER_NAME) 
-- and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
-- 
-- -- and v_rq=DATE(rq) and (jsmc='古法金' OR ((jsmc='千足金' OR jsmc='千足硬金' or  jsmc='足金')and (ckmc='古法金柜' OR ckmc='古法硬金柜' )));
-- and v_rq=DATE(rq) and (jsmc='古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜'); 
-- -------取得商品流水帐里千足素金的入出记录（流水帐）	 
drop temporary table if exists $tempgf2 ;
create temporary table $tempgf2  as 
select'古法金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and ckmc<>'维修仓'  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 


and v_rq=DATE(rq) and (jsmc='古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜'); 
drop temporary table if exists $tempgf3;
create temporary table $tempgf3 as 
select 
'古法金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $tempgf1 
union all
select * from $tempgf2 
)a;
update $tempgf3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);






drop temporary table if exists $tempgfwz1 ;
create temporary table $tempgfwz1  as 
select '古法万足金' as plm,
 sum(qc) as qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk,
 0 as mxhck,
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
  0 as syztrk,
 0 as syztck
	from 
	 (
	 SELECT CASE WHEN CKMC = '镶嵌Q柜' OR CKMC = '镶嵌硬金柜'OR CKMC = '镶嵌柜-德钰东方' or CKMC = '客单组镶嵌德钰东方' or CKMC = '客单组镶嵌柜' OR CKMC = '维修仓' 
      THEN '千足嵌'
      WHEN (JSMC = '千足硬金') AND CKMC <> '镶嵌Q柜' 
       AND CKMC <> '镶嵌硬金柜'AND CKMC <> '镶嵌柜-德钰东方' 
      AND ckmc <> '客单组镶嵌德钰东方' AND ckmc <> '客单组镶嵌柜' 
      AND CKMC <> '维修仓' AND CKMC <> '古法金柜'
      AND CKMC <> '精品G柜' AND CKMC <> '硬金古法金柜'  
      and ckmc not in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','千足结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','物流部','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')
       and ckmc <> '无字印柜'
       and ckmc <> '客单组'
       and ckmc <> '客单组(5G)'
       and ckmc <> '配货中心'
       THEN '千足金'
      when ckmc in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')OR (ckmc='千足结算' and jsmc='千足硬金')OR (ckmc='广西-千足结算' and jsmc='千足硬金')or(ckmc='物流部' and jsmc='千足硬金')
      then '千足硬金'
            WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity)  
      THEN ''
            WHEN CKMC = '精品G柜' OR JSMC = '足金(5G)' 
      THEN '足金(5G)'
            WHEN JSMC = '古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜' 
      THEN '古法金' 
      when ckmc = '普货A柜'
      then '千足金'
      ELSE JSMC 
    END AS CSMC, 
      CASE 
    WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity) 
    THEN CONCAT('料仓-', JSMC) 
    ELSE CKMC 
   END AS CKMC, 
       QCJZ AS QC
   FROM T_KA_ZTKCRZZ
 WHERE WDMC = '深圳展厅' 
   AND RQ = v_rq
   AND (JSMC NOT LIKE '虚拟金料%')
	 ) t where csmc='古法万足金';
--  select '古法万足金' as plm,
--  sum(qcjz) AS qc,
--  0 as krtcp,
--  0 as fzgcrk,
--  0 as fzztrk,
--  0 as B2BRK,
--  0 as szgcrk,
--  0 as szztrk,
--  0 as bjztrk,
--  0 as bjrkje,
--  0 as bjjdsztrk,
--  0 as bjJDSrkje,
--  0 as zbztrk,
--  0 as sdztrk,
--  0 as sdxxyztrk,
--  0 as jxjdsyyzxrk,
--  0 as jxxxyztrk,
--  0 as KJztrk,
--  0 as wwrk,
--  0 as cgrk,
--  0 as qtrk,
--  0 as rkxj,
--  0 as xsck,
--  0 as szztck,
--  0 as szgcck,
--  0 as sZGCRLck,
--  0 as bjztck,
--  0 as bjckje,
--  0 as bjJDSztck,
--  0 as bjJDSckje,
--  0 as fzztck,
--  0 as B2BCK,
--  0 as zbztck,
--  0 as sdztck,
--  0 as sdXXYztck,
--  0 as jxjdsyyzxck,
--  0 as jxxxyztck,
--  0 as KJztck,
--  0 as wwth,
--  0 as rlzl,
--  0 as wxzl,
--  0 as qxzl ,
--  0 as wtzl,
--  0 as ckxj,
--  0 as dqjc,
--  0 as yk,
--  0 as ymyprk,
--  0 as ymypck,
--  0 as zjdxrk,
--  0 as zjdxck,
--  0 as fjzjrk,
--  0 as fjzjck,
--  0 as mxhrk, -- 梦享会
--  0 as mxhck, -- 梦享会
--  0 as cdztrk, -- 成都展厅入库
--  0 as cdztck,
--  0 as hnztrk,
--  0 as hnztck
--  from $temp_ztkcrzz
-- where wdmc=v_wdmc and ckmc<>'维修仓' 
-- -- and NOT EXISTS(SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY AND CKMC = COUNTER_NAME) 
-- and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
-- 
-- and v_rq=date(rq) and (jsmc='古法万足金' or jsmc='万足古法' );


























drop temporary table if exists $tempgfwz2 ;
create temporary table $tempgfwz2  as 
select'古法万足金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
         when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and ckmc<>'维修仓'  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=date(rq) and (jsmc='古法万足金' or jsmc='万足古法');

drop temporary table if exists $tempgfwz3;
create temporary table $tempgfwz3 as 
select 
'古法万足金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck
from (
select * from $tempgfwz1 
union all
select * from $tempgfwz2 
)a;
update $tempgfwz3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);


drop temporary table if exists $tempgfwj1 ;
create temporary table $tempgfwj1  as 
 select '古法999.99' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='古法999.99');


drop temporary table if exists $tempgfwj2 ;
create temporary table $tempgfwj2  as 
select'古法999.99' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
         when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and ckmc<>'维修仓'  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='古法999.99');

drop temporary table if exists $tempgfwj3;
create temporary table $tempgfwj3 as 
select 
'古法999.99' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $tempgfwj1 
union all
select * from $tempgfwj2 
)a;
update $tempgfwj3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);





drop temporary table if exists $tempqzccj1 ;
create temporary table $tempqzccj1  as 
 select '千足赤辰金' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='千足赤辰金' OR ((jsmc='千足金' OR jsmc='千足硬金' or  jsmc='足金')and (ckmc='千足赤辰金柜' OR ckmc='古法硬金柜' )) );


drop temporary table if exists $tempqzccj2 ;
create temporary table $tempqzccj2  as 
select'千足赤辰金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
         when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and ckmc<>'维修仓'  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and (jsmc='千足赤辰金' OR ((jsmc='千足金')and (ckmc='千足赤辰金' )));

drop temporary table if exists $tempqzccj3;
create temporary table $tempqzccj3 as 
select 
'千足赤辰金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $tempqzccj1 
union all
select * from $tempqzccj2 
)a;
update $tempqzccj3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);





drop temporary table if exists $tempwzccj1 ;
create temporary table $tempwzccj1  as 
 select '万足赤辰金' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and ckmc<>'维修仓' 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='万足赤辰金');


drop temporary table if exists $tempwzccj2 ;
create temporary table $tempwzccj2  as 
select'万足赤辰金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jz,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
         when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jcgfje,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and ckmc<>'维修仓'  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and v_rq=DATE(rq) and (jsmc='万足赤辰金' OR ((jsmc='金9999')and (ckmc='万足赤辰金' )));

drop temporary table if exists $tempwzccj3;
create temporary table $tempwzccj3 as 
select 
'万足赤辰金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $tempwzccj1 
union all
select * from $tempwzccj2 
)a;
update $tempwzccj3
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);
-- -------------------------------------------------------------------------------------
-- -----------------------------足金镶嵌
-- --------------------------------------------------------------------------------------
#-- -------取得展厅库存总帐中千足嵌的期初重量
#drop temporary table if exists $ZJZ1 ;
#create temporary table $ZJZ1  as 
# select '足金嵌|重量' as plm,
# sum(qcjz) AS qc,
# 0 as krtcp,
# 0 as fzgcrk,
# 0 as fzztrk,
# 0 as B2BRK,
# 0 as szgcrk,
# 0 as szztrk,
# 0 as bjztrk,
# 0 as bjrkje,
# 0 as bjjdsztrk,
# 0 as bjJDSrkje,
# 0 as zbztrk,
# 0 as sdztrk,
# 0 as sdxxyztrk,
# 0 as jxjdsyyzxrk,
# 0 as jxxxyztrk,
# 0 as KJztrk,
# 0 as wwrk,
# 0 as cgrk,
# 0 as qtrk,
# 0 as rkxj,
# 0 as xsck,
# 0 as szztck,
# 0 as szgcck,
# 0 as sZGCRLck,
# 0 as bjztck,
# 0 as bjckje,
# 0 as bjJDSztck,
# 0 as bjJDSckje,
# 0 as fzztck,
# 0 as B2BCK,
# 0 as zbztck,
# 0 as sdztck,
# 0 as sdXXYztck,
# 0 as jxjdsyyzxck,
# 0 as jxxxyztck,
# 0 as KJztck,
# 0 as wwth,
# 0 as rlzl,
# 0 as wxzl,
# 0 as qxzl ,
# 0 as wtzl,
# 0 as ckxj,
# 0 as dqjc,
# 0 as yk,
# 0 as ymyprk,
# 0 as ymypck,
# 0 as zjdxrk,
# 0 as zjdxck,
# 0 as fjzjrk,
# 0 as fjzjck,
# 0 as mxhrk, -- 梦享会
# 0 as mxhck -- 梦享会
# from $temp_ztkcrzz
#where wdmc=v_wdmc and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜') and v_rq=DATE(rq) AND JSMC = '足金';
#
#-- -------取得商品流水帐里千足素金的入出记录（流水帐）
#drop temporary table if exists $zjz2 ;
#create temporary table $zjz2  as 
#select'足金嵌|重量' as plm,0 AS qc,
#-- ---商品流水帐入库数据取得
#sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
#sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS B2Brk,
#sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS szgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS zbztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS sdXXYztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS jxxxyztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS KJztrk,
#sum(case when swlx='委外入库'  and sffx='收' and  plmc='镶嵌' then ifnull(jz,0) 
#           else 0 end) AS WWRK,
#sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
#0 as qtrk,
#0 AS rkxj,
#-- ---商品流水帐出库数据取得
#sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
#sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS szztck,
#sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
#sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
#sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjztck,
#sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjckje,
#sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjjdsztck,
#sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS bjJDSckje,
#sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fzztck,
#sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS B2Bck,
#sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS zbztck,
#sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdztck,
#sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS sdXXYztck,
#sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
#sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS jxxxyztck,
#sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS KJztck,
#sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
#sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
#sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) AS wxzl,
#sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
#sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
#0 AS ckxj,
#0 AS dqjc,
#sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS ymyprk,
#sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS ymypck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS zjdxrk,
#sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS zjdxck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(jz,0) else 0 end) AS fjzjrk,
#sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS fjzjck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,-- 梦享会
#sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck-- 梦享会
#from $temp_splsz
#where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or ckmc='镶嵌硬金柜')AND JSMC = '足金';
#
#drop temporary table if exists $ZJZ;
#create temporary table $ZJZ as 
#select 
#'足金嵌|重量' as plm,
#sum(qc) as qc,
#sum(krtcp) as krtcp,
#sum(fzgcrk) as fzgcrk,
#SUM(fzztrk) as fzztrk,
#SUM(B2Brk) as B2Brk,
#SUM(szgcrk) as szgcrk,
#sum(szztrk) as szztrk,
#SUM(bjztrk) as bjztrk,
#SUM(bjrkje) as bjrkje,
#SUM(bjJDSztrk) as bjJDSztrk,
#SUM(bjJDSrkje) as bjJDSrkje,
#SUM(zbztrk) as zbztrk,
#SUM(sdztrk) as sdztrk,
#SUM(sdXXYztrk) as sdXXYztrk,
#SUM(KJztrk) as KJztrk,
#SUM(WWRK) as wwrk,
#sum(cgrk) as cgrk,
#sum(qtrk) as qtrk,
#sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk) as rkxj,
#sum(xsck) as xsck,
#sum(szztck) as szztck,
#SUM(szgcck) as szgcck,
#SUM(szgcRLck) as szgcRLck,
#SUM(bjztck) as bjztck,
#SUM(bjckje) as bjckje,
#SUM(bjJDSztck) as bjJDSztck,
#SUM(bjJDSckje) as bjJDSckje,
#SUM(fzztck) as fzztck,
#SUM(B2Bck) as B2Bck,
#SUM(zbztck) as zbztck,
#SUM(sdztck) as sdztck,
#SUM(sdXXYztck) as sdXXYztck,
#SUM(KJztck) as KJztck,
#sum(wwth) as wwth ,
#sum(rlzl) as rlzl,
#sum(wxzl) as wxzl,
#SUM(qxzl) as qxzl,
#SUM(wtzl) as wtzl,
#sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck) as ckxj,
#sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
#sum(yk) as yk,
#SUM(jxjdsyyzxck) as jxjdsyyzxck,
#SUM(jxxxyztck) as jxxxyztck,
#SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
#SUM(jxxxyztrk) as jxxxyztrk,
#SUM(ymyprk) as ymyprk,
#SUM(ymypck) as ymypck,
#SUM(zjdxrk) as zjdxrk,
#SUM(zjdxck) as zjdxck,
#SUM(fjzjrk) as fjzjrk,
#SUM(fjzjck) as fjzjck,
#sum(mxhrk) as mxhrk, -- 梦享会
#sum(mxhck) as mxhck -- 梦享会 
#from (
#select * from $zjz1
#union all
#select * from $zjz2 
#)a;
#update $ZJZ
#set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);
#
#-- ---------------------------------------------------------------
#-- -------取得展厅库存总帐中千足嵌的期初件数
#drop temporary table if exists $ZJJ1 ;
#create temporary table $ZJJ1  as 
# select '足金嵌|件数' as plm,
# sum(qcjs) AS qc,
# 0 as krtcp,
# 0 as fzgcrk,
# 0 as fzztrk,
# 0 as B2BRK,
# 0 as szgcrk,
# 0 as szztrk,
# 0 as bjztrk,
# 0 as bjrkje,
# 0 as bjjdsztrk,
# 0 as bjJDSrkje,
# 0 as zbztrk,
# 0 as sdztrk,
# 0 as sdxxyztrk,
# 0 as jxjdsyyzxrk,
# 0 as jxxxyztrk,
# 0 as KJztrk,
# 0 as wwrk,
# 0 as cgrk,
# 0 as qtrk,
# 0 as rkxj,
# 0 as xsck,
# 0 as szztck,
# 0 as szgcck,
# 0 as sZGCRLck,
# 0 as bjztck,
# 0 as bjckje,
# 0 as bjJDSztck,
# 0 as bjJDSckje,
# 0 as fzztck,
# 0 as B2BCK,
# 0 as zbztck,
# 0 as sdztck,
# 0 as sdXXYztck,
# 0 as jxjdsyyzxck,
# 0 as jxxxyztck,
# 0 as KJztck,
# 0 as wwth,
# 0 as rlzl,
# 0 as wxzl,
# 0 as qxzl ,
# 0 as wtzl,
# 0 as ckxj,
# 0 as dqjc,
# 0 as yk,
# 0 as ymyprk,
# 0 as ymypck,
# 0 as zjdxrk,
# 0 as zjdxck,
# 0 as fjzjrk,
# 0 as fjzjck,
# 0 as mxhrk, -- 梦享会
# 0 as mxhck -- 梦享会
# from $temp_ztkcrzz
#where wdmc=v_wdmc and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or ckmc='镶嵌硬金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' )  and v_rq=DATE(rq)  AND JSMC = '足金';
#
#-- -------取得商品流水帐里千足素金的入出记录（流水帐）
#drop temporary table if exists $ZJJ2 ;
#create temporary table $ZJJ2  as 
#select'足金嵌|件数' as plm,0 AS qc,
#-- ---商品流水帐入库数据取得
#sum(case when swlx='客户退饰' and sffx='收'   then ifnull(js,0) else 0 end) AS krtcp,
#sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS B2Brk,
#sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS szgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS szztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjztrk,
#0 AS bjrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS bjJDSztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(js,0) else 0 end) AS bjJDSrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS zbztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS sdXXYztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxjdsyyzxrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS jxxxyztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS KJztrk,
#sum(case when swlx='委外入库'  and sffx='收' and  plmc='镶嵌' and jsmc='千足金' then ifnull(js,0) 
#           else 0 end) AS WWRK,
#sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(js,0) else 0 end) AS cgrk,
#0 as qtrk,
#0 AS rkxj,
#-- ---商品流水帐出库数据取得
#sum(case when swlx='销售出库' and sffx='发'  then ifnull(js,0) else 0 end) AS xsck,
#sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS szztck,
#sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcck,
#sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcRLck,
#sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjztck,
#0 AS bjckje,
#sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjjdsztck,
#sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS bjJDSckje,
#sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fzztck,
#sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS B2Bck,
#sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS zbztck,
#sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdztck,
#sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS sdXXYztck,
#sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxjdsyyzxck,
#sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS jxxxyztck,
#sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS KJztck,
#sum(case when swlx='委外退货' and sffx='发'   then ifnull(js,0) else 0 end) AS wwth,
#sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(js,0) else 0 end) AS rlzl,
#sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS wxzl,
#sum(case when swlx='清洗' and sffx='发'  then ifnull(js,0) else 0 end)AS qxzl,   
#sum(case when swlx='质量问题' and sffx='发'  then ifnull(js,0) else 0 end)AS wtzl,   
#0 AS ckxj,
#0 AS dqjc,
#sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(js,0) else 0 end) AS yk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS ymyprk,
#sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS ymypck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS zjdxrk,
#sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS zjdxck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(js,0) else 0 end) AS fjzjrk,
#sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS fjzjck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,-- 梦享会
#sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck-- 梦享会
#from $temp_splsz
#where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜' or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜') AND JSMC = '足金';
#
#drop temporary table if exists $ZJJ;
#create temporary table $ZJJ as 
#select 
#'足金嵌|件数' as plm,
#sum(qc) as qc,
#sum(krtcp) as krtcp,
#sum(fzgcrk) as fzgcrk,
#SUM(fzztrk) as fzztrk,
#SUM(B2Brk) as B2Brk,
#SUM(szgcrk) as szgcrk,
#sum(szztrk) as szztrk,
#SUM(bjztrk) as bjztrk,
#SUM(bjrkje) as bjrkje,
#SUM(bjJDSztrk) as bjJDSztrk,
#SUM(bjJDSrkje) as bjJDSrkje,
#SUM(zbztrk) as zbztrk,
#SUM(sdztrk) as sdztrk,
#SUM(sdXXYztrk) as sdXXYztrk,
#SUM(KJztrk) as KJztrk,
#SUM(WWRK) as wwrk,
#sum(cgrk) as cgrk,
#sum(qtrk) as qtrk,
#sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk) as rkxj,
#sum(xsck) as xsck,
#sum(szztck) as szztck,
#SUM(szgcck) as szgcck,
#SUM(szgcRLck) as szgcRLck,
#SUM(bjztck) as bjztck,
#SUM(bjckje) as bjckje,
#SUM(bjJDSztck) as bjJDSztck,
#SUM(bjJDSckje) as bjJDSckje,
#SUM(fzztck) as fzztck,
#SUM(B2Bck) as B2Bck,
#SUM(zbztck) as zbztck,
#SUM(sdztck) as sdztck,
#SUM(sdXXYztck) as sdXXYztck,
#SUM(KJztck) as KJztck,
#sum(wwth) as wwth ,
#sum(rlzl) as rlzl,
#sum(wxzl) as wxzl,
#SUM(qxzl) as qxzl,
#SUM(wtzl) as wtzl,
#sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck) as ckxj,
#sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
#sum(yk) as yk,
#SUM(jxjdsyyzxck) as jxjdsyyzxck,
#SUM(jxxxyztck) as jxxxyztck,
#SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
#SUM(jxxxyztrk) as jxxxyztrk,
#SUM(ymyprk) as ymyprk,
#SUM(ymypck) as ymypck,
#SUM(zjdxrk) as zjdxrk,
#SUM(zjdxck) as zjdxck,
#SUM(fjzjrk) as fjzjrk,
#SUM(fjzjck) as fjzjck,
#sum(mxhrk) as mxhrk, -- 梦享会
#sum(mxhck) as mxhck -- 梦享会 
#from (
#select * from $ZJJ1
#union all
#select * from $ZJJ2 
#)a;
#update $ZJJ
#set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);


-- ---------------------------------------------------------------------------
-- -------取得展厅库存总帐中千足嵌的期初金额
#drop temporary table if exists $ZJE1 ;
#create temporary table $ZJE1  as 
# select '足金镶嵌标签金额' as plm,
# sum(qcje) AS qc,
# 0 as krtcp,
# 0 as fzgcrk,
# 0 as fzztrk,
# 0 as B2BRK,
# 0 as szgcrk,
# 0 as szztrk,
# 0 as bjztrk,
# 0 as bjrkje,
# 0 as bjjdsztrk,
# 0 as bjJDSrkje,
# 0 as zbztrk,
# 0 as sdztrk,
# 0 as sdxxyztrk,
# 0 as jxjdsyyzxrk,
# 0 as jxxxyztrk,
# 0 as KJztrk,
# 0 as wwrk,
# 0 as cgrk,
# 0 as qtrk,
# 0 as rkxj,
# 0 as xsck,
# 0 as szztck,
# 0 as szgcck,
# 0 as sZGCRLck,
# 0 as bjztck,
# 0 as bjckje,
# 0 as bjJDSztck,
# 0 as bjJDSckje,
# 0 as fzztck,
# 0 as B2BCK,
# 0 as zbztck,
# 0 as sdztck,
# 0 as sdXXYztck,
# 0 as jxjdsyyzxck,
# 0 as jxxxyztck,
# 0 as KJztck,
# 0 as wwth,
# 0 as rlzl,
# 0 as wxzl,
# 0 as qxzl ,
# 0 as wtzl,
# 0 as ckxj,
# 0 as dqjc,
# 0 as yk,
# 0 as ymyprk,
# 0 as ymypck,
# 0 as zjdxrk,
# 0 as zjdxck,
# 0 as fjzjrk,
# 0 as fjzjck,
# 0 as mxhrk, -- 梦享会
# 0 as mxhck -- 梦享会
# from $temp_ztkcrzz
#where wdmc=v_wdmc and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜' or ckmc='维修仓') and v_rq=DATE(rq) AND JSMC = '足金';
#
#-- -------取得商品流水帐里千足素金的入出记录（流水帐）
#drop temporary table if exists $ZJE2 ;
#create temporary table $ZJE2  as 
#select'足金镶嵌标签金额' as plm,0 AS qc,
#-- ---商品流水帐入库数据取得
#sum(case when swlx='客户退饰' and sffx='收'   then ifnull(bqjg,0) else 0 end) AS krtcp,
#sum(case when swlx='调拨入库' and  sffx='收' and chf like (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS fzztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%' and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS B2Brk,
#sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%' and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS szgcrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS szztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjztrk,
#0 AS bjrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS bjJDSztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%' and djm<>'单件调拨入库单' then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'   and djm<>'单件调拨入库单'  then ifnull(bqjg,0) else 0 end) AS zbztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS sdXXYztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS jxxxyztrk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS KJztrk,
#sum(case when swlx='委外入库'  and sffx='收' and  plmc='镶嵌' and jsmc='千足金' then ifnull(bqjg,0) 
#              when djm='调拨入库单'  and sffx='收' and chf like '福州工厂%' and ckmc='维修仓' then ifnull(bqjg,0) 
#           else 0 end) AS WWRK,
#sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS cgrk,
#0 as qtrk,
#0 AS rkxj,
#-- ---商品流水帐出库数据取得
#sum(case when swlx='销售出库' and sffx='发'  then ifnull(bqjg,0) else 0 end) AS xsck,
#sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS szztck,
#sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcck,
#sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS szgcRLck,
#sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjztck,
#0 AS bjckje,
#sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjjdsztck,
#sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS bjJDSckje,
#sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fzztck,
#sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS B2Bck,
#sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS zbztck,
#sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdztck,
#sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS sdXXYztck,
#sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxjdsyyzxck,
#sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS jxxxyztck,
#sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS KJztck,
#sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
#sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
#sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(bqjg,0) else 0 end) AS wxzl,
#sum(case when swlx='清洗' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS qxzl,   
#sum(case when swlx='质量问题' and sffx='发'  then ifnull(bqjg,0) else 0 end)AS wtzl,   
#0 AS ckxj,
#0 AS dqjc,
#sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS yk,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS ymyprk,
#sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS ymypck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS zjdxrk,
#sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS zjdxck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  and djm<>'单件调拨入库单'   then ifnull(bqjg,0) else 0 end) AS fjzjrk,
#sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(bqjg,0) else 0 end) AS fjzjck,
#sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) as mxhrk,-- 梦享会
#sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(jz,0) else 0 end) as mxhck-- 梦享会
#from $temp_splsz
#where  wdmc=v_wdmc and DATE(rq)=v_rq and (CKMC='镶嵌Q柜' OR CKMC ='镶嵌柜-德钰东方' OR CKMC ='德钰东方K金柜'  or CKMC='客单组镶嵌德钰东方' or CKMC='客单组镶嵌柜' or ckmc='镶嵌硬金柜' or ckmc='维修仓')AND JSMC = '足金';
#
#drop temporary table if exists $ZJE;
#create temporary table $ZJE as 
#select 
#'足金镶嵌标签金额' as plm,
#sum(qc) as qc,
#sum(krtcp) as krtcp,
#sum(fzgcrk) as fzgcrk,
#SUM(fzztrk) as fzztrk,
#SUM(B2Brk) as B2Brk,
#SUM(szgcrk) as szgcrk,
#sum(szztrk) as szztrk,
#SUM(bjztrk) as bjztrk,
#SUM(bjrkje) as bjrkje,
#SUM(bjJDSztrk) as bjJDSztrk,
#SUM(bjJDSrkje) as bjJDSrkje,
#SUM(zbztrk) as zbztrk,
#SUM(sdztrk) as sdztrk,
#SUM(sdXXYztrk) as sdXXYztrk,
#SUM(KJztrk) as KJztrk,
#SUM(WWRK) as wwrk,
#sum(cgrk) as cgrk,
#sum(qtrk) as qtrk,
#sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk) as rkxj,
#sum(xsck) as xsck,
#sum(szztck) as szztck,
#SUM(szgcck) as szgcck,
#SUM(szgcRLck) as szgcRLck,
#SUM(bjztck) as bjztck,
#SUM(bjckje) as bjckje,
#SUM(bjJDSztck) as bjJDSztck,
#SUM(bjJDSckje) as bjJDSckje,
#SUM(fzztck) as fzztck,
#SUM(B2Bck) as B2Bck,
#SUM(zbztck) as zbztck,
#SUM(sdztck) as sdztck,
#SUM(sdXXYztck) as sdXXYztck,
#SUM(KJztck) as KJztck,
#sum(wwth) as wwth ,
#sum(rlzl) as rlzl,
#sum(wxzl) as wxzl,
#SUM(qxzl) as qxzl,
#SUM(wtzl) as wtzl,
#sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck) as ckxj,
#sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
#sum(yk) as yk,
#SUM(jxjdsyyzxck) as jxjdsyyzxck,
#SUM(jxxxyztck) as jxxxyztck,
#SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
#SUM(jxxxyztrk) as jxxxyztrk,
#SUM(ymyprk) as ymyprk,
#SUM(ymypck) as ymypck,
#SUM(zjdxrk) as zjdxrk,
#SUM(zjdxck) as zjdxck,
#SUM(fjzjrk) as fjzjrk,
#SUM(fjzjck) as fjzjck,
#sum(mxhrk) as mxhrk, -- 梦享会
#sum(mxhck) as mxhck -- 梦享会 
#from (
#select * from $ZJE1
#union all
#select * from $ZJE2 
#)a;
#update $ZJE
#set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);

drop temporary table if exists $temp13 ;
create temporary table $temp13  as
select '万足金' as plm,
 sum(qc) as qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk,
 0 as mxhck,
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
	from 
	 (
	 SELECT CASE WHEN CKMC = '镶嵌Q柜' OR CKMC = '镶嵌硬金柜'OR CKMC = '镶嵌柜-德钰东方' or CKMC = '客单组镶嵌德钰东方' or CKMC = '客单组镶嵌柜' OR CKMC = '维修仓' 
      THEN '千足嵌'
      WHEN (JSMC = '千足硬金') AND CKMC <> '镶嵌Q柜' 
       AND CKMC <> '镶嵌硬金柜'AND CKMC <> '镶嵌柜-德钰东方' 
      AND ckmc <> '客单组镶嵌德钰东方' AND ckmc <> '客单组镶嵌柜' 
      AND CKMC <> '维修仓' AND CKMC <> '古法金柜'
      AND CKMC <> '精品G柜' AND CKMC <> '硬金古法金柜'  
      and ckmc not in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','千足结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','物流部','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')
       and ckmc <> '无字印柜'
       and ckmc <> '客单组'
       and ckmc <> '客单组(5G)'
       and ckmc <> '配货中心'
       THEN '千足金'
      when ckmc in ('硬金B柜', '硬金A柜', '硬金结算', '硬金精品D柜', '无字印柜', '单件化硬金柜台', '硬金精品C柜', '荟萃楼-硬金', '文创园-硬金结算', '文创园-千足硬金柜', '吉林-硬金', '吉林-硬金结算','广西-硬金柜','昆明-硬金柜','昆明-硬金结算','湖北-硬金柜','湖北-硬金结算','广西-硬金结算','深圳-单件化硬金柜台','福州-单件化硬金柜台','河南-硬金结算','河南-硬金柜','安徽-硬金柜', '安徽-硬金结算', '文创园-硬金A柜', '文创园-硬金B柜', '文创园-硬金C柜','江苏国中展销-硬金柜', '江苏国中展销-硬金结算', '湖南-硬金柜', '湖南-硬金结算', '硬金无氢柜', '硬金柜', '陕西-硬金柜', '陕西-硬金结算')OR (ckmc='千足结算' and jsmc='千足硬金')OR (ckmc='广西-千足结算' and jsmc='千足硬金')or(ckmc='物流部' and jsmc='千足硬金')
      then '千足硬金'
            WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity)  
      THEN ''
            WHEN CKMC = '精品G柜' OR JSMC = '足金(5G)' 
      THEN '足金(5G)'
            WHEN JSMC = '古法金' OR CKMC = '古法金柜' OR CKMC = '硬金古法金柜' 
      THEN '古法金' 
      when ckmc = '普货A柜'
      then '千足金'
      ELSE JSMC 
    END AS CSMC, 
      CASE 
    WHEN CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = v_showroom_identity) 
    THEN CONCAT('料仓-', JSMC) 
    ELSE CKMC 
   END AS CKMC, 
       QCJZ AS QC
   FROM T_KA_ZTKCRZZ
 WHERE WDMC = '深圳展厅' 
   AND RQ = v_rq
   AND (JSMC NOT LIKE '虚拟金料%')
	 ) t where csmc='金9999' ;
--  select '万足金' as plm,
--  sum(qcjz) AS qc,
--  0 as krtcp,
--  0 as fzgcrk,
--  0 as fzztrk,
--  0 as B2BRK,
--  0 as szgcrk,
--  0 as szztrk,
--  0 as bjztrk,
--  0 as bjrkje,
--  0 as bjjdsztrk,
--  0 as bjJDSrkje,
--  0 as zbztrk,
--  0 as sdztrk,
--  0 as sdxxyztrk,
--  0 as jxjdsyyzxrk,
--  0 as jxxxyztrk,
--  0 as KJztrk,
--  0 as wwrk,
--  0 as cgrk,
--  0 as qtrk,
--  0 as rkxj,
--  0 as xsck,
--  0 as szztck,
--  0 as szgcck,
--  0 as sZGCRLck,
--  0 as bjztck,
--  0 as bjckje,
--  0 as bjJDSztck,
--  0 as bjJDSckje,
--  0 as fzztck,
--  0 as B2BCK,
--  0 as zbztck,
--  0 as sdztck,
--  0 as sdXXYztck,
--  0 as jxjdsyyzxck,
--  0 as jxxxyztck,
--  0 as KJztck,
--  0 as wwth,
--  0 as rlzl,
--  0 as wxzl,
--  0 as qxzl ,
--  0 as wtzl,
--  0 as ckxj,
--  0 as dqjc,
--  0 as yk,
--  0 as ymyprk,
--  0 as ymypck,
--  0 as zjdxrk,
--  0 as zjdxck,
--  0 as fjzjrk,
--  0 as fjzjck,
--  0 as mxhrk, -- 梦享会
--  0 as mxhck, -- 梦享会
--  0 as cdztrk, -- 成都展厅入库
--  0 as cdztck,
--  0 as hnztrk,
--  0 as hnztck
--  from $temp_ztkcrzz
-- where wdmc=v_wdmc and v_rq=DATE(rq) 
-- -- and NOT EXISTS(SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY AND CKMC = COUNTER_NAME) 
-- and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
-- 
-- and jsmc='金9999' and ckmc<>'万足赤辰金';
drop temporary table if exists $temp14 ;
create temporary table $temp14  as 
select'万足金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then jz else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) as qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   then ifnull(jz,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'    then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'     then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'     then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'     then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and jsmc='金9999'  and ckmc<>'万足赤辰金';

drop temporary table if exists $temp15;
create temporary table $temp15 as 
select 
'万足金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $temp13
union all
select * from $temp14 
)a;
update $temp15
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);




drop temporary table if exists $temp1388 ;
create temporary table $temp1388  as 
 select '五九金' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and v_rq=DATE(rq) 

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and jsmc='金99999';


drop temporary table if exists $temp1488 ;
create temporary table $temp1488  as 
select'五九金' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then jz else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) as qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   then ifnull(jz,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'    then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'     then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'     then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'     then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  

and ckmc not in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 

and jsmc='金99999';

drop temporary table if exists $temp1588;
create temporary table $temp1588 as 
select 
'五九金' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp1388
union all
select * from $temp1488 
)a;
update $temp1588
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);






drop temporary table if exists $temp1688 ;
create temporary table $temp1688  as 
 select '足金(5G)' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and v_rq=DATE(rq) and ((ckmc='精品G柜' and jsmc='千足金')or jsmc='足金(5G)');


drop temporary table if exists $temp1788 ;
create temporary table $temp1788  as 
select'足金(5G)' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then jz else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) as qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   then ifnull(jz,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'    then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'     then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'     then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'     then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ((ckmc='精品G柜' and jsmc='千足金')or jsmc='足金(5G)');

drop temporary table if exists $temp1888;
create temporary table $temp1888 as 
select 
'足金(5G)' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $temp1688
union all
select * from $temp1788 
)a;
update $temp1888
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);



drop temporary table if exists $tempwq1688 ;
create temporary table $tempwq1688  as 
 select '足金(无氰)' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and v_rq=DATE(rq) and (jsmc='足金(无氰)');


drop temporary table if exists $tempwq1788 ;
create temporary table $tempwq1788  as 
select'足金(无氰)' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jz,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jz,0) else 0 end) AS bjztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%'   then ifnull(jcgfje,0) else 0 end)AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(bqjg,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jz,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then jz else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jz,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jz,0) else 0 end) as qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'       and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end) AS bjztck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'   then ifnull(jz,0) else 0 end) AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(jz,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jz,0) else 0 end) AS fjzjck,


sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'   then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发'    then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'     then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'     then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'     then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发'     then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ( jsmc='足金(无氰)');

drop temporary table if exists $tempwq1888;
create temporary table $tempwq1888 as 
select 
'足金(无氰)' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempwq1688
union all
select * from $tempwq1788 
)a;
update $tempwq1888
set dqjc=ifnull(qc,0)+ifnull(rkxj,0)-ifnull(ckxj,0)+ifnull(yk,0);






drop temporary table if exists $wwth;
create temporary table $wwth as  
select purity_name as csmch,sum(return_total_price) as jehj 
  from t_sales_return 
  where DATE(create_time)=v_rq 
    and `status`=0 
      and showroom_name=v_wdmc 
      and supplier_type = 1 
      
      and status = 0
  group by purity_name;
  
  
  


drop temporary table if exists $temp200 ;
create temporary table $temp200  as 
 select '千足金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck

  ;

drop temporary table if exists $temp201 ;
create temporary table $temp201  as 
select'千足金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ifnull(FJGFJE,0)+ifnull(BQJG,0) else 0 end) AS krtcp,
 
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end )AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end )AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end )AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,

sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS qxzl,   

sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wtzl, 
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end ) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ( jsmc='千足金')  AND CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜'  and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'镶嵌硬金柜' 
and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜'  and ckmc<>'千足赤辰金';

drop temporary table if exists $temp20;
create temporary table $temp20 as 
select 
'千足金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $temp200
union all
select * from $temp201 
)a;

update $temp20 a,$wwth b set a.wwth=b.jehj where b.csmch='千足金';


drop temporary table if exists $tempzj200 ;
create temporary table $tempzj200  as 
 select '足金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;

drop temporary table if exists $tempzj201 ;
create temporary table $tempzj201  as 
select'足金工费' as plm,0 AS qc,

 sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,

sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and (jsmc='足金' )  AND CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜'  and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'镶嵌硬金柜' 
and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' and ckmc<>'精品G柜';


drop temporary table if exists $tempzj20;
create temporary table $tempzj20 as 
select 
'足金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempzj200
union all
select * from $tempzj201 
)a;


update $tempzj20 a,$wwth b set a.wwth=b.jehj where b.csmch='足金';



drop temporary table if exists $tempgf200 ;
create temporary table $tempgf200  as 
 select '古法金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempgf201 ;
create temporary table $tempgf201  as 
select'古法金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ( jsmc='古法金' OR ((jsmc='千足金' OR jsmc='千足硬金')and (ckmc='古法金柜' OR ckmc='古法硬金柜' )));

drop temporary table if exists $tempgf20;
create temporary table $tempgf20 as 
select 
'古法金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempgf200
union all
select * from $tempgf201 
)a;
update $tempgf20 a,$wwth b set a.wwth=b.jehj where b.csmch='古法金';



drop temporary table if exists $tempgfwz200 ;
create temporary table $tempgfwz200  as 
 select '古法万足工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempgfwz201 ;
create temporary table $tempgfwz201  as 
select'古法万足工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and (jsmc='古法万足金' or jsmc='万足古法') ;

drop temporary table if exists $tempgfwz20;
create temporary table $tempgfwz20 as 
select 
'古法万足工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempgfwz200
union all
select * from $tempgfwz201 
)a;
update $tempgfwz20 a,$wwth b set a.wwth=b.jehj where b.csmch='古法万足金'  or b.csmch='万足古法';



drop temporary table if exists $tempgfwj200 ;
create temporary table $tempgfwj200  as 
 select '古法999.99工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempgfwj201 ;
create temporary table $tempgfwj201  as 
select'古法999.99工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and (jsmc='古法999.99') ;

drop temporary table if exists $tempgfwj20;
create temporary table $tempgfwj20 as 
select 
'古法999.99工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempgfwj200
union all
select * from $tempgfwj201 
)a;
update $tempgfwj20 a,$wwth b set a.wwth=b.jehj where b.csmch='古法999.99';



drop temporary table if exists $tempqzccj200 ;
create temporary table $tempqzccj200  as 
 select '千足赤辰金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempqzccj201 ;
create temporary table $tempqzccj201  as 
select'千足赤辰金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ( jsmc='千足赤辰金' OR ((jsmc='千足金')and (ckmc='千足赤辰金'  ))) ;

drop temporary table if exists $tempqzccj20;
create temporary table $tempqzccj20 as 
select 
'千足赤辰金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempqzccj200
union all
select * from $tempqzccj201 
)a;
update $tempqzccj20 a,$wwth b set a.wwth=b.jehj where b.csmch='千足赤辰金';

drop temporary table if exists $tempwzccj200 ;
create temporary table $tempwzccj200  as 
 select '万足赤辰金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempwzccj201 ;
create temporary table $tempwzccj201  as 
select'万足赤辰金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end ) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and ( jsmc='万足赤辰金' OR ((jsmc='金9999')and (ckmc='万足赤辰金'  )));

drop temporary table if exists $tempwzccj20;
create temporary table $tempwzccj20 as 
select 
'万足赤辰金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempwzccj200
union all
select * from $tempwzccj201 
)a;
update $tempwzccj20 a,$wwth b set a.wwth=b.jehj where b.csmch='万足赤辰金';



drop temporary table if exists $YJGF1 ;
create temporary table $YJGF1  as 
 select '硬金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $YJGF2 ;
create temporary table $YJGF2  as 
select'硬金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and (  jsmc='千足硬金' )  AND CKMC<>'镶嵌Q柜' AND CKMC <>'镶嵌柜-德钰东方' AND CKMC <>'德钰东方K金柜'  and ckmc<>'镶嵌硬金柜' and CKMC<>'客单组镶嵌德钰东方' and CKMC<>'客单组镶嵌柜' and ckmc<>'古法金柜' and ckmc<>'古法硬金柜' ;

drop temporary table if exists $YJGF;
create temporary table $YJGF as 
select 
'硬金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $YJGF1
union all
select * from $YJGF2 
)a;
update $YJGF a,$wwth b set a.wwth=b.jehj where b.csmch='千足硬金';

 
drop temporary table if exists $temp210 ;
create temporary table $temp210  as 
 select '万足金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $temp211 ;
create temporary table $temp211  as 
select'万足金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and jsmc  = '金9999'  and ckmc<>'万足赤辰金' ;

drop temporary table if exists $temp21;
create temporary table $temp21 as 
select 
'万足金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp210
union all
select * from $temp211 
)a;
update $temp21 a,$wwth b set a.wwth=b.jehj where b.csmch='金9999';
 

drop temporary table if exists $temp21088 ;
create temporary table $temp21088  as 
 select '五九金工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $temp21188 ;
create temporary table $temp21188  as 
select'五九金工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq  and jsmc  = '金99999';

drop temporary table if exists $temp2188;
create temporary table $temp2188 as 
select 
'五九金工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp21088
union all
select * from $temp21188 
)a;
update $temp2188 a,$wwth b set a.wwth=b.jehj where b.csmch='金99999';


 
drop temporary table if exists $temp212 ;
create temporary table $temp212  as 
 select '足金(5G)工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $temp213 ;
create temporary table $temp213  as 
select'足金(5G)工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and ((( jsmc='千足金' or  jsmc='足金' )  AND ckmc='精品G柜' ) OR (jsmc='足金(5G)'));

drop temporary table if exists $temp214;
create temporary table $temp214 as 
select 
'足金(5G)工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp212
union all
select * from $temp213 
)a;
update $temp214 a,$wwth b set a.wwth=b.jehj where b.csmch='足金(5G)';



drop temporary table if exists $tempwq212 ;
create temporary table $tempwq212  as 
 select '足金(无氰)工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 
  ;


drop temporary table if exists $tempwq213 ;
create temporary table $tempwq213  as 
select'足金(无氰)工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end ) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and  sffx='收' and chf like '深圳工厂%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
sum(case when swlx='委外入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
sum(case when swlx='成色转换'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) 
              when swlx='成色转换'  and sffx='发'  then 0-ifnull(jcgfje,0) - ifnull(FJGFJE,0) else 0 end) as qtrk,
0 AS rkxj,

0 AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料'     and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料'      and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ROUND(ifnull(jcgfje,0),0) + ROUND(ifnull(FJGFJE,0),0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx='调拨入库' and sffx='收' and chf like '因美优品%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '浙江德鑫%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '福建中金%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and (jsmc='足金(无氰)');

drop temporary table if exists $tempwq214;
create temporary table $tempwq214 as 
select 
'足金(无氰)工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $tempwq212
union all
select * from $tempwq213 
)a;
update $tempwq214 a,$wwth b set a.wwth=b.jehj where b.csmch='足金(无氰)';


drop temporary table if exists $temp31 ;
create temporary table $temp31  as 
 select '维修仓|件数' as plm,
 sum(qcjs) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and ckmc='维修仓' and v_rq=DATE(rq);

drop temporary table if exists $temp32 ;
create temporary table $temp32  as 
select'维修仓|件数' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(js,0) else 0 end) AS krtcp,
sum(case when swlx in ('调拨入库','维修') and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS fzgcrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '特艺城展厅%' then ifnull(js,0) else 0 end) AS fzztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like 'B2B云展厅%'  then ifnull(js,0) else 0 end) AS B2Brk,
sum(case when swlx in ('调拨入库','维修') and  sffx='收' and chf like '深圳工厂%'  then ifnull(js,0) else 0 end) AS szgcrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(js,0) else 0 end) AS szztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '北京运营中心%' then ifnull(js,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '北京金德尚运营中心%'  then ifnull(js,0) else 0 end) AS bjJDSztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(js,0) else 0 end) as bjJDSrkje,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '总部万足展厅%'  then ifnull(js,0) else 0 end) AS zbztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '山东运营中心%' then ifnull(js,0) else 0 end) AS sdztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '德诚珠宝%' then ifnull(js,0) else 0 end) AS sdXXYztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '江西金德尚运营中心%' then ifnull(js,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '江西南昌展厅%' then ifnull(js,0) else 0 end) AS jxxxyztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like 'K金展厅%' then ifnull(js,0) else 0 end) AS KJztrk,
0 AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(js,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(js,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(js,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发' then ifnull(js,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(js,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(js,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(js,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'  then ifnull(js,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发' then ifnull(js,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(js,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'  then ifnull(js,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(js,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发' then ifnull(js,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发' then ifnull(js,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(js,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(js,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(js,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(js,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(js,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,

sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '因美优品%'  then ifnull(js,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(js,0) else 0 end) AS ymypck,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '浙江德鑫%'   then ifnull(js,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(js,0) else 0 end) AS zjdxck,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '福建中金%'  then ifnull(js,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发' then ifnull(js,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(js,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(js,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(js,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(js,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(js,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(js,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(js,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(js,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and ckmc='维修仓';

drop temporary table if exists $temp33;
create temporary table $temp33 as 
select 
'维修仓|件数' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck ,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp31 
union all
select * from $temp32 
)a;
update $temp33
set dqjc=qc+rkxj-ckxj;

drop temporary table if exists $temp34 ;
create temporary table $temp34  as 
 select '维修仓|重量' as plm,
 sum(qcjz) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc and ckmc='维修仓' and v_rq=DATE(rq);

drop temporary table if exists $temp35 ;
create temporary table $temp35  as 
select'维修仓|重量' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收'   then ifnull(jz,0) else 0 end) AS krtcp,
sum(case when swlx in ('调拨入库','维修') and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS fzgcrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '特艺城展厅%' then ifnull(jz,0) else 0 end) AS fzztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jz,0) else 0 end) AS B2Brk,
sum(case when swlx in ('调拨入库','维修') and  sffx='收' and chf like '深圳工厂%'  then ifnull(js,0) else 0 end) AS szgcrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '深圳展厅%'   and djm<>'单件调拨入库单'  then ifnull(jz,0) else 0 end) AS szztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '北京运营中心%' then ifnull(jz,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '北京金德尚运营中心%'  then ifnull(jz,0) else 0 end) AS bjJDSztrk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jz,0) else 0 end) as bjJDSrkje,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '总部万足展厅%'  then ifnull(jz,0) else 0 end) AS zbztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '山东运营中心%' then ifnull(jz,0) else 0 end) AS sdztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '德诚珠宝%' then ifnull(jz,0) else 0 end) AS sdXXYztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '江西金德尚运营中心%' then ifnull(jz,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like '江西南昌展厅%' then ifnull(jz,0) else 0 end) AS jxxxyztrk,
sum(case when swlx in ('调拨入库','维修')  and sffx='收' and chf like 'K金展厅%' then ifnull(jz,0) else 0 end) AS KJztrk,
0 AS WWRK,
sum(case when swlx='购客户成品'  and sffx='收'  then ifnull(jz,0) else 0 end) AS cgrk,
0 AS qtrk,
0 AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发'  and djm<>'单件调拨出库单'  then ifnull(js,0) else 0 end) AS szztck,
sum(case WHEN swlx<>'熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcck,
sum(case WHEN swlx='熔料' and  djm = '调拨出库单' and rhf like '深圳工厂%' and sffx='发'   and djm<>'单件调拨出库单' then ifnull(jz,0) else 0 end) AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jz,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jz,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发'  then ifnull(jz,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发'  then ifnull(jz,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发' then ifnull(jz,0) else 0 end) AS KJztck,
sum(case when swlx='委外退货' and sffx='发'   then ifnull(jz,0) else 0 end) AS wwth,
sum(case when swlx='熔料'       and rhf like '福州工厂%' and sffx='发'  then ifnull(jz,0) else 0 end) AS rlzl,
sum(case when swlx IN ('调拨出库','维修','清洗','质量问题') and rhf like '福州工厂%' and sffx='发' then ifnull(jz,0) else 0 end) AS wxzl,
sum(case when swlx='清洗' and sffx='发'  then ifnull(jz,0) else 0 end)AS qxzl,   
sum(case when swlx='质量问题' and sffx='发'  then ifnull(jz,0) else 0 end)AS wtzl,   
0 AS ckxj,
0 AS dqjc,
sum(case when swlx='盈亏调整'  and sffx='收'  then ifnull(bqjg,0) else 0 end) AS yk,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '因美优品%'  then ifnull(jz,0) else 0 end) AS ymyprk,
sum(case when djm='调拨出库单' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end) AS ymypck,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '浙江德鑫%'   then ifnull(jz,0) else 0 end) AS zjdxrk,
sum(case when djm='调拨出库单' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) AS zjdxck,
sum(case when swlx in ('调拨入库','维修') and sffx='收' and chf like '福建中金%'  then ifnull(jz,0) else 0 end) AS fjzjrk,
sum(case when djm='调拨出库单' and rhf like '福建中金%' and sffx='发' then ifnull(jz,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jz,0) else 0 end) as mxhck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz
where  wdmc=v_wdmc and DATE(rq)=v_rq and ckmc='维修仓';

drop temporary table if exists $temp36;
create temporary table $temp36 as 
select 
'维修仓|重量' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck , 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $temp34 
union all
select * from $temp35 
)a;
update $temp36
set dqjc=qc+rkxj-ckxj;



drop temporary table if exists $temp17 ;
create temporary table $temp17  as 
 select '原料' as plm,
 sum(ifnull(qcjz,0)) AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 from $temp_ztkcrzz
where wdmc=v_wdmc 

and CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
and v_rq=DATE(rq);

drop temporary table if exists $temp18 ;
create temporary table $temp18  as 
select '原料' as plm,
0 as qc,
sum(case when swlx='客户来料' and sffx='收' and b.customer_name<>'今日多料' and b.customer_name<>'深圳工厂'   then ifnull(jz,0) else 0 end) as krtcp,
sum(case when swlx='调拨入库' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')  and sffx='收'  then ifnull(jz,0) else 0 end) as fzgcrk ,
sum(case when swlx='调拨入库' and CHF like '特艺城展厅%' and sffx='收'  then ifnull(jz,0) else 0 end) as fzztrk,
sum(case when swlx='调拨入库' and CHF like 'B2B云展厅%' and sffx='收'  then ifnull(jz,0) else 0 end) as B2Brk,
sum(case when swlx='调拨入库' and CHF like '深圳工厂%' and sffx='收'  then ifnull(jz,0) else 0 end)+sum(case when swlx='客户来料' and sffx='收' and b.customer_name='深圳工厂'   then ifnull(jz,0) else 0 end) as szgcrk,
sum(case when swlx='调拨入库' and CHF like '深圳展厅%' and sffx='收'  then ifnull(jz,0) else 0 end) as szztrk,
sum(case when swlx='调拨入库' and CHF like '北京运营中心%' and sffx='收' then ifnull(jz,0) else 0 end) as bjztrk,
0 as bjrkje,
sum(case when swlx='调拨入库' and CHF like '北京金德尚运营中心%' and sffx='收' then ifnull(jz,0) else 0 end)as bjJDSztrk,
sum(case when swlx='调拨入库' and CHF like '商品中心(XXY)%' and sffx='收' then ifnull(jz,0) else 0 end)as bjJDSrkje,
sum(case when swlx='调拨入库' and CHF like '总部万足展厅%' and sffx='收'  then ifnull(jz,0) else 0 end)as zbztrk,
sum(case when swlx='调拨入库' and CHF like '山东运营中心%' and sffx='收'  then ifnull(jz,0) else 0 end) as sdztrk,
sum(case when swlx='调拨入库' and CHF like '德诚珠宝%' and sffx='收'  then ifnull(jz,0) else 0 end) as sdXXYztrk,
sum(case when swlx='调拨入库' and CHF like '江西金德尚运营中心%' and sffx='收'  then ifnull(jz,0) else 0 end) as jxjdsyyzxrk,
sum(case when swlx='调拨入库' and CHF like '江西南昌展厅%' and sffx='收'  then ifnull(jz,0) else 0 end) as jxxxyztrk,
sum(case when swlx='调拨入库' and CHF like 'K金展厅%' and sffx='收'  then ifnull(jz,0) else 0 end) as KJztrk,
0.000 as wwrk,
sum(case when swlx='采购入库'  and sffx='收' then ifnull(jz,0) else 0 end) as cgrk,
0 as qtrk,
sum(case when sffx='收'  then ifnull(jz,0) else 0 end) as rkxj,
sum(case when swlx='销售出库' and sffx='发'  then ifnull(jz,0) else 0 end)as xsck,
sum(case when swlx='调拨出库' and rhf like '深圳展厅%' and sffx='发' then ifnull(jz,0) else 0 end)as szztck,
0 as szgcck,
sum(case when (swlx='调拨出库' or swlx='五九换料') and rhf like '深圳工厂%' and sffx='发' then ifnull(jz,0) else 0 end)as szgcRLck,
sum(case when swlx='调拨出库' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end)as bjztck, 
0 as bjckje,
sum(case when swlx='调拨出库' and rhf like '北京金德尚运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end)as bjJDSztck, 
sum(case when swlx='调拨出库' and rhf like '商品中心(XXY)%' and sffx='发'  then ifnull(jz,0) else 0 end)as bjJDSckje,
sum(case when swlx='调拨出库' and rhf like '特艺城展厅%' and sffx='发'  then ifnull(jz,0) else 0 end)as fzztck,
sum(case when swlx='调拨出库' and rhf like 'B2B云展厅%' and sffx='发'  then ifnull(jz,0) else 0 end)as B2Bck,
sum(case when swlx='调拨出库' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jz,0) else 0 end)as zbztck,
sum(case when swlx='调拨出库' and rhf like '山东运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end)as sdztck,
sum(case when swlx='调拨出库' and rhf like '德诚珠宝%' and sffx='发'  then ifnull(jz,0) else 0 end)as sdXXYztck,
sum(case when swlx='调拨出库' and rhf like '江西金德尚运营中心%' and sffx='发'  then ifnull(jz,0) else 0 end)as jxjdsyyzxck,
sum(case when swlx='调拨出库' and rhf like '江西南昌展厅%' and sffx='发'  then ifnull(jz,0) else 0 end)as jxxxyztck,
sum(case when swlx='调拨出库' and rhf like 'K金展厅%' and sffx='发'  then ifnull(jz,0) else 0 end)as KJztck,
sum(case when (swlx='委外付料') and sffx='发' and plmc='金料' then ifnull(jz,0) else 0 end)as wwth,
sum(case when (swlx='调拨出库' or swlx='五九换料') and rhf like '福州工厂%'  and sffx='发' and plmc='金料' then ifnull(jz,0) else 0 end)as rlzl,
sum(case when (swlx='付客户料') and sffx='发' and plmc='金料' then ifnull(jz,0) else 0 end) as wxzl,
0.000 as qxzl ,
0 as wtzl,
sum(case when sffx='发'  then ifnull(jz,0) else 0 end) as ckxj,
0.000 as dqjc,
sum(case when swlx='客户来料' and sffx='收' and b.customer_name='今日多料'   then ifnull(jz,0) else 0 end) as Yk,
sum(case when swlx='调拨入库' and CHF like '因美优品%' and sffx='收'  then ifnull(jz,0) else 0 end)as ymyprk,
sum(case when swlx='调拨出库' and rhf like '因美优品%' and sffx='发'  then ifnull(jz,0) else 0 end)as ymypck,
sum(case when swlx='调拨入库' and CHF like '浙江德鑫%' and sffx='收'  then ifnull(jz,0) else 0 end) as zjdxrk,
sum(case when swlx='调拨出库' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jz,0) else 0 end) as zjdxck ,
sum(case when swlx='调拨入库' and CHF like '福建中金%' and sffx='收'  then ifnull(jz,0) else 0 end) as fjzjrk,
sum(case when swlx='调拨出库' and rhf like '福建中金%' and sffx='发'  then ifnull(jz,0) else 0 end) as fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jz,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jz,0) else 0 end) as mxhck, 
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jz,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jz,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jz,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jz,0) else 0 end) as syztck
from $temp_splsz a 
left join t_fast_customer b on a.customer_identity=b.customer_identity
where  wdmc=v_wdmc and DATE(rq)=v_rq 

and CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY ) 
and jsmc not like '%虚拟金料%';

drop temporary table if exists $temp19;
create temporary table $temp19 as 
select 
'原料' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)+sum(qxzl)+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,
sum(yk) as yk,
SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck 
from (
select * from $temp17 
union all
select * from $temp18 
)a;

update $temp19  
set   rlzl=ifnull($temp19.rlzl,0);


update $temp19

set rkxj= ifnull(krtcp,0)+ifnull(fzgcrk,0)+ifnull(fzztrk,0)+ifnull(B2Brk,0)+ifnull(szgcrk,0)+ifnull(szztrk,0)+ifnull(bjztrk,0)+ifnull(zbztrk,0)+ifnull(sdztrk,0)+ifnull(wwrk,0)+ifnull(qtrk,0)+ifnull(cgrk,0)+ifnull(ymyprk,0)+ifnull(zjdxrk,0)+ifnull(fjzjrk,0)++ifnull(mxhrk,0)+ifnull(jxjdsyyzxrk,0)+ifnull(jxxxyztrk,0)+ifnull(bjJDSztrk,0)+ifnull(sdXXYztrk,0)+ifnull(KJztrk,0)+ifnull(cdztrk,0)+ifnull(hnztrk,0)+ifnull(syztrk,0);

update $temp19

set ckxj=ifnull(xsck,0)+ifnull(szztck,0)+ifnull(szgcck,0)+ifnull(bjztck,0)+ifnull(fzztck,0)+ifnull(B2Bck,0)+ifnull(zbztck,0)+ifnull(sdztck,0)+ifnull(wwth,0)+ifnull(rlzl,0)+ifnull(wxzl,0)+ifnull(qxzl,0)+ifnull(ymypck,0)+ifnull(zjdxck,0)+ifnull(fjzjck,0)+ifnull(mxhck,0)+ifnull(szgcrlck,0)+ifnull(jxjdsyyzxck,0)+ifnull(jxxxyztck,0)++ifnull(kjztck,0)+ifnull(sdxxyztck,0)+ifnull(bjJDSztck,0)+ifnull(cdztck,0)+ifnull(hnztck,0)+ifnull(syztck,0);

update $temp19

set dqjc=qc+rkxj+yk-ckxj; 



drop temporary table if exists $ylgf1 ;
create temporary table $ylgf1  as 
 select '原料工费' as plm,
 0 AS qc,
 0 as krtcp,
 0 as fzgcrk,
 0 as fzztrk,
 0 as B2BRK,
 0 as szgcrk,
 0 as szztrk,
 0 as bjztrk,
 0 as bjrkje,
 0 as bjjdsztrk,
 0 as bjJDSrkje,
 0 as zbztrk,
 0 as sdztrk,
 0 as sdxxyztrk,
 0 as jxjdsyyzxrk,
 0 as jxxxyztrk,
 0 as KJztrk,
 0 as wwrk,
 0 as cgrk,
 0 as qtrk,
 0 as rkxj,
 0 as xsck,
 0 as szztck,
 0 as szgcck,
 0 as sZGCRLck,
 0 as bjztck,
 0 as bjckje,
 0 as bjJDSztck,
 0 as bjJDSckje,
 0 as fzztck,
 0 as B2BCK,
 0 as zbztck,
 0 as sdztck,
 0 as sdXXYztck,
 0 as jxjdsyyzxck,
 0 as jxxxyztck,
 0 as KJztck,
 0 as wwth,
 0 as rlzl,
 0 as wxzl,
 0 as qxzl ,
 0 as wtzl,
 0 as ckxj,
 0 as dqjc,
 0 as yk,
 0 as ymyprk,
 0 as ymypck,
 0 as zjdxrk,
 0 as zjdxck,
 0 as fjzjrk,
 0 as fjzjck,
 0 as mxhrk, 
 0 as mxhck, 
 0 as cdztrk, 
 0 as cdztck,
 0 as hnztrk,
 0 as hnztck,
 0 as syztrk,
 0 as syztck
 ;  



drop temporary table if exists $YLGF2 ;
create temporary table $YLGF2  as 
select'原料工费' as plm,0 AS qc,

sum(case when swlx='客户退饰' and sffx='收' and b.customer_name<>'今日多料' and b.customer_name<>'深圳工厂' then ifnull(jcgfje,0)+ ifnull(FJGFJE,0)+ifnull(BQJG,0)  else 0 end) AS krtcp,
sum(case when swlx='调拨入库' and  sffx='收' and (chf like '福州工厂%' or chf like '福州K金工厂%' or chf like '福州镶嵌工厂%')    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '特艺城展厅%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'B2B云展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Brk,
sum(case when swlx='调拨入库' and CHF like '深圳工厂%' and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)+
      sum(case when swlx='客户来料' and sffx='收' and b.customer_name='深圳工厂' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS szgcrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '深圳展厅%'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京运营中心%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztrk,
0 AS bjrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '北京金德尚运营中心%'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '商品中心(XXY)%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSrkje,
sum(case when swlx='调拨入库' and sffx='收' and chf like '总部万足展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '山东运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '德诚珠宝%' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西金德尚运营中心%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxjdsyyzxrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like '江西南昌展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztrk,
sum(case when swlx='调拨入库' and sffx='收' and chf like 'K金展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztrk,
0.000 AS WWRK,
sum(case when swlx='采购入库'  and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS cgrk,
0 as qtrk,
sum(case when sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS rkxj,

sum(case when swlx='销售出库' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS xsck,
sum(case when djm='调拨出库单' and rhf like '深圳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS szztck,
0 AS szgcck,
sum(case when (swlx='调拨出库' or swlx='五九换料') and rhf like '深圳工厂%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end)AS szgcRLck,
sum(case when djm='调拨出库单' and rhf like '北京运营中心%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjztck,
0 AS bjckje,
sum(case when djm='调拨出库单' and rhf like '北京金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjjdsztck,
sum(case when djm='调拨出库单' and rhf like '商品中心(XXY)%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS bjJDSckje,
sum(case when djm='调拨出库单' and rhf like '特艺城展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fzztck,
sum(case when djm='调拨出库单' and rhf like 'B2B云展厅%'   and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS B2Bck,
sum(case when djm='调拨出库单' and rhf like '总部万足展厅%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zbztck,
sum(case when djm='调拨出库单' and rhf like '山东运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdztck,
sum(case when djm='调拨出库单' and rhf like '德诚珠宝%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS sdXXYztck,
sum(case when djm='调拨出库单' and rhf like '江西金德尚运营中心%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0)else 0 end) AS jxjdsyyzxck,
sum(case when djm='调拨出库单' and rhf like '江西南昌展厅%' and sffx='发'    then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS jxxxyztck,
sum(case when djm='调拨出库单' and rhf like 'K金展厅%' and sffx='发'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS KJztck,
sum(case when (swlx='委外付料') and sffx='发' and plmc='金料' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wwth,
sum(case when (swlx='调拨出库' or swlx='五九换料') and rhf like '福州工厂%' and sffx='发' and plmc='金料' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS rlzl,
sum(case when (swlx='付客户料') and sffx='发' and plmc='金料' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS wxzl,
0.000 AS qxzl,   
0 AS wtzl,   
sum(case when sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ckxj,
0.000 AS dqjc,
sum(case when swlx='客户来料' and sffx='收' and b.customer_name='今日多料'   then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS yk,
sum(case when swlx='调拨入库' and CHF like '因美优品%' and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymyprk,
sum(case when swlx='调拨出库' and rhf like '因美优品%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS ymypck,
sum(case when swlx='调拨入库' and CHF like '浙江德鑫%' and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxrk,
sum(case when swlx='调拨出库' and rhf like '浙江德鑫%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS zjdxck,
sum(case when swlx='调拨入库' and CHF like '福建中金%' and sffx='收'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjrk,
sum(case when swlx='调拨出库' and rhf like '福建中金%' and sffx='发'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) AS fjzjck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '梦享会%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhrk,
sum(case when djm='调拨出库单' and rhf like '梦享会%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as mxhck, 
sum(case when swlx='调拨入库' and sffx='收' and chf like '成都展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztrk,
sum(case when djm='调拨出库单' and rhf like '成都展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as cdztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '海南展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztrk,
sum(case when djm='调拨出库单' and rhf like '海南展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as hnztck,
sum(case when swlx='调拨入库' and sffx='收' and chf like '沈阳展厅%'  then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztrk,
sum(case when djm='调拨出库单' and rhf like '沈阳展厅%' and sffx='发' then ifnull(jcgfje,0) + ifnull(FJGFJE,0) else 0 end) as syztck
from $temp_splsz a
left join t_fast_customer b on a.customer_identity=b.customer_identity
where  wdmc=v_wdmc and DATE(rq)=v_rq 

and CKMC in (SELECT COUNTER_NAME FROM T_SHOWROOM_COUNTER WHERE TYPE = 2 AND IS_DELETE = 0 AND SHOWROOM_IDENTITY = V_SHOWROOM_IDENTITY )
;

drop temporary table if exists $YLGF;
create temporary table $YLGF as 
select 
'原料工费' as plm,
sum(qc) as qc,
sum(krtcp) as krtcp,
sum(fzgcrk) as fzgcrk,
SUM(fzztrk) as fzztrk,
SUM(B2Brk) as B2Brk,
SUM(szgcrk) as szgcrk,
sum(szztrk) as szztrk,
SUM(bjztrk) as bjztrk,
SUM(bjrkje) as bjrkje,
SUM(bjJDSztrk) as bjJDSztrk,
SUM(bjJDSrkje) as bjJDSrkje,
SUM(zbztrk) as zbztrk,
SUM(sdztrk) as sdztrk,
SUM(sdXXYztrk) as sdXXYztrk,
SUM(KJztrk) as KJztrk,
SUM(WWRK) as wwrk,
sum(cgrk) as cgrk,
sum(qtrk) as qtrk,
sum(krtcp)+sum(fzgcrk)+sum(fzztrk)+sum(B2Brk)+sum(szgcrk)+sum(szztrk)+sum(bjztrk)+sum(zbztrk)+sum(sdztrk)+sum(wwrk)+sum(qtrk)+sum(cgrk)+sum(ymyprk)+sum(zjdxrk)+sum(fjzjrk)++sum(mxhrk)+sum(jxjdsyyzxrk)+sum(jxxxyztrk)+sum(bjJDSztrk)+sum(sdXXYztrk)+sum(KJztrk)+sum(cdztrk)+sum(hnztrk)+sum(syztrk)  as rkxj,
sum(xsck) as xsck,
sum(szztck) as szztck,
SUM(szgcck) as szgcck,
SUM(szgcRLck) as szgcRLck,
SUM(bjztck) as bjztck,
SUM(bjckje) as bjckje,
SUM(bjJDSztck) as bjJDSztck,
SUM(bjJDSckje) as bjJDSckje,
SUM(fzztck) as fzztck,
SUM(B2Bck) as B2Bck,
SUM(zbztck) as zbztck,
SUM(sdztck) as sdztck,
SUM(sdXXYztck) as sdXXYztck,
SUM(KJztck) as KJztck,
sum(wwth) as wwth ,
sum(rlzl) as rlzl,
sum(wxzl) as wxzl,
SUM(qxzl) as qxzl,
SUM(wtzl) as wtzl,
sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)+sum(qxzl)+sum(wtzl)+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)+sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as ckxj,
sum(qc)+sum(rkxj)-sum(ckxj) as dqjc,

SUM(jxjdsyyzxck) as jxjdsyyzxck,
SUM(jxxxyztck) as jxxxyztck,
SUM(jxjdsyyzxrk) as jxjdsyyzxrk,
SUM(jxxxyztrk) as jxxxyztrk,
SUM(ymyprk) as ymyprk,
SUM(ymypck) as ymypck,
SUM(zjdxrk) as zjdxrk,
SUM(zjdxck) as zjdxck,
SUM(fjzjrk) as fjzjrk,
SUM(fjzjck) as fjzjck,
sum(mxhrk) as mxhrk, 
sum(mxhck) as mxhck, 
sum(cdztrk) as cdztrk, 
sum(cdztck) as cdztck,
sum(hnztrk) as hnztrk,
sum(hnztck) as hnztck,
sum(syztrk) as syztrk,
sum(syztck) as syztck  
from (
select * from $YLGF1
union all
select * from $YLGF2 
)a;


update $YLGF
set rkxj=ifnull(krtcp,0)+ifnull(fzgcrk,0)+ifnull(fzztrk,0)+ifnull(B2Brk,0)+ifnull(szgcrk,0)+ifnull(szztrk,0)+ifnull(bjztrk,0)+ifnull(zbztrk,0)+ifnull(sdztrk,0)+ifnull(wwrk,0)+ifnull(qtrk,0)+ifnull(cgrk,0)+ifnull(ymyprk,0)+ifnull(cdztrk,0)+ifnull(hnztrk,0)+ifnull(syztrk,0);

update $YLGF
set ckxj=ifnull(xsck,0)+ifnull(szztck,0)+ifnull(szgcck,0)+ifnull(bjztck,0)+ifnull(fzztck,0)+ifnull(B2Bck,0)+ifnull(zbztck,0)+ifnull(sdztck,0)+ifnull(wwth,0)+ifnull(rlzl,0)+ifnull(wxzl,0)+ifnull(qxzl,0)+ifnull(wtzl,0)+ifnull(ymypck,0)+ifnull(cdztck,0)+ifnull(hnztck,0)+ifnull(syztck,0);

update $YLGF
set dqjc=qc+rkxj-ckxj; 



drop temporary table if exists TEMP_RESAULT;
create temporary table TEMP_RESAULT as 
select plm,qc,krtcp,fzgcrk,fzztrk,B2BRK,szgcrk,szztrk,bjztrk,bjrkje,bjJDSztrk,bjJDSrkje,zbztrk,sdztrk,sdxxyztrk,KJztrk,wwrk,cgrk,qtrk,rkxj,jxjdsyyzxck,jxxxyztck,
xsck,szztck,szgcck,szgcrlck,bjztck,bjckje,bjJDSztck,bjJDSckje,fzztck,B2BCK,zbztck,sdztck,sdxxyztck,kjztck,wwth,rlzl,wxzl,qxzl,wtzl,ckxj,dqjc,yk,jxjdsyyzxrk,jxxxyztrk,ymyprk,ymypck,zjdxrk,zjdxck,fjzjrk,fjzjck,mxhrk,mxhck,cdztrk,cdztck,hnztrk,hnztck,syztrk,syztck
from (
 select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck) as char(20)) as ckxj,

cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp20   
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempzj20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck)  as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp21

UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck)  as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp2188
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp214
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempwq214
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempzj3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgf3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgfwz3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgfwj3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgf20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgfwz20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempgfwj20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck  as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempqzccj3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempwzccj3
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempqzccj20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempwzccj20
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(round(szgcck,0) as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(round(wwth,0) as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(round(wxzl,0) as char(20)) as wxzl,
cast(round(qxzl,0) as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(sum(xsck)+sum(szztck)+sum(szgcck)+sum(bjztck)+sum(fzztck)+sum(B2Bck)+sum(zbztck)+sum(sdztck)+sum(wwth)+sum(rlzl)+sum(wxzl)/*+sum(qxzl)*/+sum(ymypck)+sum(zjdxck)+sum(fjzjck)+sum(mxhck)+sum(szgcrlck)+sum(jxjdsyyzxck)+sum(jxxxyztck)++sum(kjztck)+sum(sdxxyztck)+sum(bjJDSztck)+sum(cdztck)+sum(hnztck)+sum(syztck) as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(0 as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $YJGF
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $YJ
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp15
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp1588
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp1888
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $tempwq1888
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp6
union ALL
select plm,
cast(cast(qc as signed) as char(20))as qc,
cast(cast(krtcp as signed) as char(20))as krtcp,
cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
cast(cast(fzztrk as signed) as char(20))as fzztrk,
cast(cast(b2brk as signed) as char(20))as b2brk,
cast(cast(szgcrk as signed) as char(20))as szgcrk,
cast(cast(szztrk as signed) as char(20))as szztrk,
cast(cast(bjztrk as signed) as char(20))as bjztrk,
cast(cast(bjrkje as signed) as char(20))as bjrkje,
cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
cast(cast(zbztrk as signed) as char(20))as zbztrk,
cast(cast(sdztrk as signed) as char(20))as sdztrk,
cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
cast(cast(KJztrk as signed) as char(20))as KJztrk,
cast(cast(wwrk as signed) as char(20))as wwrk,
cast(cast(cgrk as signed) as char(20))as cgrk,    
cast(cast(qtrk as signed) as char(20))as qtrk,
cast(cast(rkxj as signed) as char(20))as rkxj,
cast(cast(xsck as signed) as char(20))as xsck,    
cast(cast(szztck as signed) as char(20))as szztck,
cast(cast(szgcck as signed) as char(20))as szgcck,
cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
cast(cast(bjztck as signed) as char(20))as bjztck,
cast(cast(bjckje as signed) as char(20))as bjckje,
cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
cast(cast(fzztck as signed) as char(20))as fzztck,
cast(cast(b2bck as signed) as char(20))as b2bck,
cast(cast(zbztck as signed) as char(20))as zbztck,
cast(cast(sdztck as signed) as char(20))as sdztck,
cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
cast(cast(KJztck as signed) as char(20))as KJztck,
cast(cast(wwth as signed) as char(20))as wwth,
cast(cast(rlzl as signed) as char(20))as rlzl,
cast(cast(wxzl as signed) as char(20))as wxzl,
cast(cast(qxzl as signed) as char(20))as qxzl,
cast(cast(wtzl as signed) as char(20))as wtzl,
cast(cast(ckxj as signed) as char(20))as ckxj,
cast(cast(dqjc as signed) as char(20))as dqjc,
cast(cast(yk as signed) as char(20))as yk,
cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
cast(jxxxyztck as char(20))as jxxxyztck,
cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
cast(jxxxyztrk as char(20))as jxxxyztrk,
cast(ymyprk as char(20))as ymyprk,
cast(ymypck as char(20))as ymypck,
cast(zjdxrk as char(20))as zjdxrk,
cast(zjdxck as char(20))as zjdxck,
cast(fjzjrk as char(20))as fjzjrk,
cast(fjzjck as char(20))as fjzjck ,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp9
union ALL
select plm,
cast(cast(qc as signed) as char(20))as qc,
cast(cast(krtcp as signed) as char(20))as krtcp,
cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
cast(cast(fzztrk as signed) as char(20))as fzztrk,
cast(cast(b2brk as signed) as char(20))as b2brk,
cast(cast(szgcrk as signed) as char(20))as szgcrk,
cast(cast(szztrk as signed) as char(20))as szztrk,
cast(cast(bjztrk as signed) as char(20))as bjztrk,
cast(cast(bjrkje as signed) as char(20))as bjrkje,
cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
cast(cast(zbztrk as signed) as char(20))as zbztrk,
cast(cast(sdztrk as signed) as char(20))as sdztrk,
cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
cast(cast(KJztrk as signed) as char(20))as KJztrk,
cast(cast(wwrk as signed) as char(20))as wwrk,
cast(cast(cgrk as signed) as char(20))as cgrk,    
cast(cast(qtrk as signed) as char(20))as qtrk,
cast(cast(rkxj as signed) as char(20))as rkxj,
cast(cast(xsck as signed) as char(20))as xsck,    
cast(cast(szztck as signed) as char(20))as szztck,
cast(cast(szgcck as signed) as char(20))as szgcck,
cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
cast(cast(bjztck as signed) as char(20))as bjztck,
cast(cast(bjckje as signed) as char(20))as bjckje,
cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
cast(cast(fzztck as signed) as char(20))as fzztck,
cast(cast(b2bck as signed) as char(20))as b2bck,
cast(cast(zbztck as signed) as char(20))as zbztck,
cast(cast(sdztck as signed) as char(20))as sdztck,
cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
cast(cast(KJztck as signed) as char(20))as KJztck,
cast(cast(wwth as signed) as char(20))as wwth,
cast(cast(rlzl as signed) as char(20))as rlzl,
cast(cast(wxzl as signed) as char(20))as wxzl,
cast(cast(qxzl as signed) as char(20))as qxzl,
cast(cast(wtzl as signed) as char(20))as wtzl,
cast(cast(ckxj as signed) as char(20))as ckxj,
cast(cast(dqjc as signed) as char(20))as dqjc,
cast(cast(yk as signed) as char(20))as yk,
cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
cast(jxxxyztck as char(20))as jxxxyztck,
cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
cast(jxxxyztrk as char(20))as jxxxyztrk,
cast(ymyprk as char(20))as ymyprk,
cast(ymypck as char(20))as ymypck,
cast(zjdxrk as char(20))as zjdxrk,
cast(zjdxck as char(20))as zjdxck,
cast(fjzjrk as char(20))as fjzjrk,
cast(fjzjck as char(20))as fjzjck ,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp12
-- UNION ALL
-- select 
-- plm as plm,
-- 0 as qc,
-- 0 as krtcp,
-- 0 as fzgcrk,
-- 0 as fzztrk,
-- 0 as B2Brk,
-- 0 as szgcrk,
-- 0 as szztrk,
-- 0 as bjztrk,
-- 0 as bjrkje,
-- 0 as bjJDSztrk,
-- 0 as bjJDSrkje,
-- 0 as zbztrk,
-- 0 as sdztrk,
-- 0 as sdXXYztrk,
-- 0 as KJztrk,
-- 0 as wwrk,
-- 0 as cgrk,
-- 0 as qtrk,
-- 0 as rkxj,
-- 0 as xsck,
-- 0 as szztck,
-- 0 as szgcck,
-- 0 as szgcRLck,
-- 0 as bjztck,
-- 0 as bjckje,
-- 0 as bjJDSztck,
-- 0 as bjJDSckje,
-- 0 as fzztck,
-- 0 as B2Bck,
-- 0 as zbztck,
-- 0 as sdztck,
-- 0 as sdXXYztck,
-- 0 as KJztck,
-- 0 as wwth,
-- 0 as rlzl,
-- 0 as wxzl,
-- 0 as qxzl,
-- 0 as wtzl,
-- 0 as ckxj,
-- 0 as dqjc,
-- 0 as yk,
-- 0 as jxjdsyyzxck,
-- 0 as jxxxyztck,
-- 0 as jxjdsyyzxrk,
-- 0 as jxxxyztrk,
-- 0  as ymyprk,
-- 0 as ymypck,
-- 0 as zjdxrk,
-- 0 as zjdxck,
-- 0 as fjzjrk,
-- 0 as fjzjck,
-- 0 as mxhrk,
-- 0 as mxhck,
-- 0 as cdztrk,
-- 0 as cdztck,
-- 0 as hnztrk,
-- 0 as hnztck
-- from $temp6_new
-- union ALL
-- select plm,
-- 0 as qc,
-- 0 as krtcp,
-- 0 as fzgcrk,
-- 0 as fzztrk,
-- 0 as B2Brk,
-- 0 as szgcrk,
-- 0 as szztrk,
-- 0 as bjztrk,
-- 0 as bjrkje,
-- 0 as bjJDSztrk,
-- 0 as bjJDSrkje,
-- 0 as zbztrk,
-- 0 as sdztrk,
-- 0 as sdXXYztrk,
-- 0 as KJztrk,
-- 0 as wwrk,
-- 0 as cgrk,
-- 0 as qtrk,
-- 0 as rkxj,
-- 0 as xsck,
-- 0 as szztck,
-- 0 as szgcck,
-- 0 as szgcRLck,
-- 0 as bjztck,
-- 0 as bjckje,
-- 0 as bjJDSztck,
-- 0 as bjJDSckje,
-- 0 as fzztck,
-- 0 as B2Bck,
-- 0 as zbztck,
-- 0 as sdztck,
-- 0 as sdXXYztck,
-- 0 as KJztck,
-- 0 as wwth,
-- 0 as rlzl,
-- 0 as wxzl,
-- 0 as qxzl,
-- 0 as wtzl,
-- 0 as ckxj,
-- 0 as dqjc,
-- 0 as yk,
-- 0 as jxjdsyyzxck,
-- 0 as jxxxyztck,
-- 0 as jxjdsyyzxrk,
-- 0 as jxxxyztrk,
-- 0  as ymyprk,
-- 0 as ymypck,
-- 0 as zjdxrk,
-- 0 as zjdxck,
-- 0 as fjzjrk,
-- 0 as fjzjck,
-- 0 as mxhrk,
-- 0 as mxhck,
-- 0 as cdztrk,
-- 0 as cdztck,
-- 0 as hnztrk,
-- 0 as hnztck
-- from $temp9_new
-- union all 
-- select plm,
-- 0 as qc,
-- 0 as krtcp,
-- 0 as fzgcrk,
-- 0 as fzztrk,
-- 0 as B2Brk,
-- 0 as szgcrk,
-- 0 as szztrk,
-- 0 as bjztrk,
-- 0 as bjrkje,
-- 0 as bjJDSztrk,
-- 0 as bjJDSrkje,
-- 0 as zbztrk,
-- 0 as sdztrk,
-- 0 as sdXXYztrk,
-- 0 as KJztrk,
-- 0 as wwrk,
-- 0 as cgrk,
-- 0 as qtrk,
-- 0 as rkxj,
-- 0 as xsck,
-- 0 as szztck,
-- 0 as szgcck,
-- 0 as szgcRLck,
-- 0 as bjztck,
-- 0 as bjckje,
-- 0 as bjJDSztck,
-- 0 as bjJDSckje,
-- 0 as fzztck,
-- 0 as B2Bck,
-- 0 as zbztck,
-- 0 as sdztck,
-- 0 as sdXXYztck,
-- 0 as KJztck,
-- 0 as wwth,
-- 0 as rlzl,
-- 0 as wxzl,
-- 0 as qxzl,
-- 0 as wtzl,
-- 0 as ckxj,
-- 0 as dqjc,
-- 0 as yk,
-- 0 as jxjdsyyzxck,
-- 0 as jxxxyztck,
-- 0 as jxjdsyyzxrk,
-- 0 as jxxxyztrk,
-- 0  as ymyprk,
-- 0 as ymypck,
-- 0 as zjdxrk,
-- 0 as zjdxck,
-- 0 as fjzjrk,
-- 0 as fjzjck,
-- 0 as mxhrk,
-- 0 as mxhck,
-- 0 as cdztrk,
-- 0 as cdztck,
-- 0 as hnztrk,
-- 0 as hnztck
-- from $temp12_new
UNION ALL
select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp6_new
union ALL
select plm,
cast(cast(qc as signed) as char(20))as qc,
cast(cast(krtcp as signed) as char(20))as krtcp,
cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
cast(cast(fzztrk as signed) as char(20))as fzztrk,
cast(cast(b2brk as signed) as char(20))as b2brk,
cast(cast(szgcrk as signed) as char(20))as szgcrk,
cast(cast(szztrk as signed) as char(20))as szztrk,
cast(cast(bjztrk as signed) as char(20))as bjztrk,
cast(cast(bjrkje as signed) as char(20))as bjrkje,
cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
cast(cast(zbztrk as signed) as char(20))as zbztrk,
cast(cast(sdztrk as signed) as char(20))as sdztrk,
cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
cast(cast(KJztrk as signed) as char(20))as KJztrk,
cast(cast(wwrk as signed) as char(20))as wwrk,
cast(cast(cgrk as signed) as char(20))as cgrk,    
cast(cast(qtrk as signed) as char(20))as qtrk,
cast(cast(rkxj as signed) as char(20))as rkxj,
cast(cast(xsck as signed) as char(20))as xsck,    
cast(cast(szztck as signed) as char(20))as szztck,
cast(cast(szgcck as signed) as char(20))as szgcck,
cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
cast(cast(bjztck as signed) as char(20))as bjztck,
cast(cast(bjckje as signed) as char(20))as bjckje,
cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
cast(cast(fzztck as signed) as char(20))as fzztck,
cast(cast(b2bck as signed) as char(20))as b2bck,
cast(cast(zbztck as signed) as char(20))as zbztck,
cast(cast(sdztck as signed) as char(20))as sdztck,
cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
cast(cast(KJztck as signed) as char(20))as KJztck,
cast(cast(wwth as signed) as char(20))as wwth,
cast(cast(rlzl as signed) as char(20))as rlzl,
cast(cast(wxzl as signed) as char(20))as wxzl,
cast(cast(qxzl as signed) as char(20))as qxzl,
cast(cast(wtzl as signed) as char(20))as wtzl,
cast(cast(ckxj as signed) as char(20))as ckxj,
cast(cast(dqjc as signed) as char(20))as dqjc,
cast(cast(yk as signed) as char(20))as yk,
cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
cast(jxxxyztck as char(20))as jxxxyztck,
cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
cast(jxxxyztrk as char(20))as jxxxyztrk,
cast(ymyprk as char(20))as ymyprk,
cast(ymypck as char(20))as ymypck,
cast(zjdxrk as char(20))as zjdxrk,
cast(zjdxck as char(20))as zjdxck,
cast(fjzjrk as char(20))as fjzjrk,
cast(fjzjck as char(20))as fjzjck ,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp9_new
union all 
select plm,
cast(cast(qc as signed) as char(20))as qc,
cast(cast(krtcp as signed) as char(20))as krtcp,
cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
cast(cast(fzztrk as signed) as char(20))as fzztrk,
cast(cast(b2brk as signed) as char(20))as b2brk,
cast(cast(szgcrk as signed) as char(20))as szgcrk,
cast(cast(szztrk as signed) as char(20))as szztrk,
cast(cast(bjztrk as signed) as char(20))as bjztrk,
cast(cast(bjrkje as signed) as char(20))as bjrkje,
cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
cast(cast(zbztrk as signed) as char(20))as zbztrk,
cast(cast(sdztrk as signed) as char(20))as sdztrk,
cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
cast(cast(KJztrk as signed) as char(20))as KJztrk,
cast(cast(wwrk as signed) as char(20))as wwrk,
cast(cast(cgrk as signed) as char(20))as cgrk,    
cast(cast(qtrk as signed) as char(20))as qtrk,
cast(cast(rkxj as signed) as char(20))as rkxj,
cast(cast(xsck as signed) as char(20))as xsck,    
cast(cast(szztck as signed) as char(20))as szztck,
cast(cast(szgcck as signed) as char(20))as szgcck,
cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
cast(cast(bjztck as signed) as char(20))as bjztck,
cast(cast(bjckje as signed) as char(20))as bjckje,
cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
cast(cast(fzztck as signed) as char(20))as fzztck,
cast(cast(b2bck as signed) as char(20))as b2bck,
cast(cast(zbztck as signed) as char(20))as zbztck,
cast(cast(sdztck as signed) as char(20))as sdztck,
cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
cast(cast(KJztck as signed) as char(20))as KJztck,
cast(cast(wwth as signed) as char(20))as wwth,
cast(cast(rlzl as signed) as char(20))as rlzl,
cast(cast(wxzl as signed) as char(20))as wxzl,
cast(cast(qxzl as signed) as char(20))as qxzl,
cast(cast(wtzl as signed) as char(20))as wtzl,
cast(cast(ckxj as signed) as char(20))as ckxj,
cast(cast(dqjc as signed) as char(20))as dqjc,
cast(cast(yk as signed) as char(20))as yk,
cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
cast(jxxxyztck as char(20))as jxxxyztck,
cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
cast(jxxxyztrk as char(20))as jxxxyztrk,
cast(ymyprk as char(20))as ymyprk,
cast(ymypck as char(20))as ymypck,
cast(zjdxrk as char(20))as zjdxrk,
cast(zjdxck as char(20))as zjdxck,
cast(fjzjrk as char(20))as fjzjrk,
cast(fjzjck as char(20))as fjzjck ,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp12_new
#UNION ALL
#select 
#plm as plm,
#cast(qc as char(20)) as qc,
#cast(krtcp as char(20)) as krtcp,
#cast(fzgcrk as char(20)) as fzgcrk,
#cast(fzztrk as char(20)) as fzztrk,
#cast(B2Brk as char(20)) as B2Brk,
#cast(szgcrk as char(20)) as szgcrk,
#cast(szztrk as char(20)) as szztrk,
#cast(bjztrk as char(20)) as bjztrk,
#cast(bjrkje as char(20)) as bjrkje,
#cast(bjJDSztrk as char(20)) as bjJDSztrk,
#cast(bjJDSrkje as char(20)) as bjJDSrkje,
#cast(zbztrk as char(20)) as zbztrk,
#cast(sdztrk as char(20)) as sdztrk,
#cast(sdXXYztrk as char(20)) as sdXXYztrk,
#cast(KJztrk as char(20)) as KJztrk,
#cast(wwrk as char(20)) as wwrk,
#cast(cgrk as char(20)) as cgrk,
#cast(qtrk as char(20)) as qtrk,
#cast(rkxj as char(20)) as rkxj,
#cast(xsck as char(20)) as xsck,
#cast(szztck as char(20)) as szztck,
#cast(szgcck as char(20)) as szgcck,
#cast(szgcRLck as char(20)) as szgcRLck,
#cast(bjztck as char(20)) as bjztck,
#cast(bjckje as char(20)) as bjckje,
#cast(bjJDSztck as char(20)) as bjJDSztck,
#cast(bjJDSckje as char(20)) as bjJDSckje,
#cast(fzztck as char(20)) as fzztck,
#cast(B2Bck as char(20)) as B2Bck,
#cast(zbztck as char(20)) as zbztck,
#cast(sdztck as char(20)) as sdztck,
#cast(sdXXYztck as char(20)) as sdXXYztck,
#cast(KJztck as char(20)) as KJztck,
#cast(wwth as char(20)) as wwth,
#cast(rlzl as char(20)) as rlzl,
#cast(wxzl as char(20)) as wxzl,
#cast(qxzl as char(20)) as qxzl,
#cast(wtzl as char(20)) as wtzl,
#cast(ckxj as char(20)) as ckxj,
#cast(dqjc as char(20)) as dqjc,
#cast(yk as char(20)) as yk,
#cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
#cast(jxxxyztck as char(20)) as jxxxyztck,
#cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
#cast(jxxxyztrk as char(20)) as jxxxyztrk,
#cast(ymyprk as char(20))  as ymyprk,
#cast(ymypck as char(20)) as ymypck,
#cast(zjdxrk as char(20)) as zjdxrk,
#cast(zjdxck as char(20)) as zjdxck,
#cast(fjzjrk as char(20)) as fjzjrk,
#cast(fjzjck as char(20)) as fjzjck,
#cast(mxhrk as char(20)) as mxhrk,
#cast(mxhck as char(20)) as mxhck
#from $ZJZ
#union ALL
#select plm,
#cast(cast(qc as signed) as char(20))as qc,
#cast(cast(krtcp as signed) as char(20))as krtcp,
#cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
#cast(cast(fzztrk as signed) as char(20))as fzztrk,
#cast(cast(b2brk as signed) as char(20))as b2brk,
#cast(cast(szgcrk as signed) as char(20))as szgcrk,
#cast(cast(szztrk as signed) as char(20))as szztrk,
#cast(cast(bjztrk as signed) as char(20))as bjztrk,
#cast(cast(bjrkje as signed) as char(20))as bjrkje,
#cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
#cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
#cast(cast(zbztrk as signed) as char(20))as zbztrk,
#cast(cast(sdztrk as signed) as char(20))as sdztrk,
#cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
#cast(cast(KJztrk as signed) as char(20))as KJztrk,
#cast(cast(wwrk as signed) as char(20))as wwrk,
#cast(cast(cgrk as signed) as char(20))as cgrk,    
#cast(cast(qtrk as signed) as char(20))as qtrk,
#cast(cast(rkxj as signed) as char(20))as rkxj,
#cast(cast(xsck as signed) as char(20))as xsck,    
#cast(cast(szztck as signed) as char(20))as szztck,
#cast(cast(szgcck as signed) as char(20))as szgcck,
#cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
#cast(cast(bjztck as signed) as char(20))as bjztck,
#cast(cast(bjckje as signed) as char(20))as bjckje,
#cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
#cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
#cast(cast(fzztck as signed) as char(20))as fzztck,
#cast(cast(b2bck as signed) as char(20))as b2bck,
#cast(cast(zbztck as signed) as char(20))as zbztck,
#cast(cast(sdztck as signed) as char(20))as sdztck,
#cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
#cast(cast(KJztck as signed) as char(20))as KJztck,
#cast(cast(wwth as signed) as char(20))as wwth,
#cast(cast(rlzl as signed) as char(20))as rlzl,
#cast(cast(wxzl as signed) as char(20))as wxzl,
#cast(cast(qxzl as signed) as char(20))as qxzl,
#cast(cast(wtzl as signed) as char(20))as wtzl,
#cast(cast(ckxj as signed) as char(20))as ckxj,
#cast(cast(dqjc as signed) as char(20))as dqjc,
#cast(cast(yk as signed) as char(20))as yk,
#cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
#cast(jxxxyztck as char(20))as jxxxyztck,
#cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
#cast(jxxxyztrk as char(20))as jxxxyztrk,
#cast(ymyprk as char(20))as ymyprk,
#cast(ymypck as char(20))as ymypck,
#cast(zjdxrk as char(20))as zjdxrk,
#cast(zjdxck as char(20))as zjdxck,
#cast(fjzjrk as char(20))as fjzjrk,
#cast(fjzjck as char(20))as fjzjck ,
#cast(mxhrk as char(20)) as mxhrk,
#cast(mxhck as char(20)) as mxhck
#from $ZJJ
#union ALL
#select plm,
#cast(cast(qc as signed) as char(20))as qc,
#cast(cast(krtcp as signed) as char(20))as krtcp,
#cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
#cast(cast(fzztrk as signed) as char(20))as fzztrk,
#cast(cast(b2brk as signed) as char(20))as b2brk,
#cast(cast(szgcrk as signed) as char(20))as szgcrk,
#cast(cast(szztrk as signed) as char(20))as szztrk,
#cast(cast(bjztrk as signed) as char(20))as bjztrk,
#cast(cast(bjrkje as signed) as char(20))as bjrkje,
#cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
#cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
#cast(cast(zbztrk as signed) as char(20))as zbztrk,
#cast(cast(sdztrk as signed) as char(20))as sdztrk,
#cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
#cast(cast(KJztrk as signed) as char(20))as KJztrk,
#cast(cast(wwrk as signed) as char(20))as wwrk,
#cast(cast(cgrk as signed) as char(20))as cgrk,    
#cast(cast(qtrk as signed) as char(20))as qtrk,
#cast(cast(rkxj as signed) as char(20))as rkxj,
#cast(cast(xsck as signed) as char(20))as xsck,    
#cast(cast(szztck as signed) as char(20))as szztck,
#cast(cast(szgcck as signed) as char(20))as szgcck,
#cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
#cast(cast(bjztck as signed) as char(20))as bjztck,
#cast(cast(bjckje as signed) as char(20))as bjckje,
#cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
#cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
#cast(cast(fzztck as signed) as char(20))as fzztck,
#cast(cast(b2bck as signed) as char(20))as b2bck,
#cast(cast(zbztck as signed) as char(20))as zbztck,
#cast(cast(sdztck as signed) as char(20))as sdztck,
#cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
#cast(cast(KJztck as signed) as char(20))as KJztck,
#cast(cast(wwth as signed) as char(20))as wwth,
#cast(cast(rlzl as signed) as char(20))as rlzl,
#cast(cast(wxzl as signed) as char(20))as wxzl,
#cast(cast(qxzl as signed) as char(20))as qxzl,
#cast(cast(wtzl as signed) as char(20))as wtzl,
#cast(cast(ckxj as signed) as char(20))as ckxj,
#cast(cast(dqjc as signed) as char(20))as dqjc,
#cast(cast(yk as signed) as char(20))as yk,
#cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
#cast(jxxxyztck as char(20))as jxxxyztck,
#cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
#cast(jxxxyztrk as char(20))as jxxxyztrk,
#cast(ymyprk as char(20))as ymyprk,
#cast(ymypck as char(20))as ymypck,
#cast(zjdxrk as char(20))as zjdxrk,
#cast(zjdxck as char(20))as zjdxck,
#cast(fjzjrk as char(20))as fjzjrk,
#cast(fjzjck as char(20))as fjzjck ,
#cast(mxhrk as char(20)) as mxhrk,
#cast(mxhck as char(20)) as mxhck
#from $ZJE
-- UNION ALL
-- select 
-- plm as plm,
-- cast(qc as char(20)) as qc,
-- cast(krtcp as char(20)) as krtcp,
-- cast(fzgcrk as char(20)) as fzgcrk,
-- cast(fzztrk as char(20)) as fzztrk,
-- cast(B2Brk as char(20)) as B2Brk,
-- cast(szgcrk as char(20)) as szgcrk,
-- cast(szztrk as char(20)) as szztrk,
-- cast(bjztrk as char(20)) as bjztrk,
-- cast(bjrkje as char(20)) as bjrkje,
-- cast(bjJDSztrk as char(20)) as bjJDSztrk,
-- cast(bjJDSrkje as char(20)) as bjJDSrkje,
-- cast(zbztrk as char(20)) as zbztrk,
-- cast(sdztrk as char(20)) as sdztrk,
-- cast(sdXXYztrk as char(20)) as sdXXYztrk,
-- cast(KJztrk as char(20)) as KJztrk,
-- cast(wwrk as char(20)) as wwrk,
-- cast(cgrk as char(20)) as cgrk,
-- cast(qtrk as char(20)) as qtrk,
-- cast(rkxj as char(20)) as rkxj,
-- cast(xsck as char(20)) as xsck,
-- cast(szztck as char(20)) as szztck,
-- cast(szgcck as char(20)) as szgcck,
-- cast(szgcRLck as char(20)) as szgcRLck,
-- cast(bjztck as char(20)) as bjztck,
-- cast(bjckje as char(20)) as bjckje,
-- cast(bjJDSztck as char(20)) as bjJDSztck,
-- cast(bjJDSckje as char(20)) as bjJDSckje,
-- cast(fzztck as char(20)) as fzztck,
-- cast(B2Bck as char(20)) as B2Bck,
-- cast(zbztck as char(20)) as zbztck,
-- cast(sdztck as char(20)) as sdztck,
-- cast(sdXXYztck as char(20)) as sdXXYztck,
-- cast(KJztck as char(20)) as KJztck,
-- cast(wwth as char(20)) as wwth,
-- cast(rlzl as char(20)) as rlzl,
-- cast(wxzl as char(20)) as wxzl,
-- cast(qxzl as char(20)) as qxzl,
-- cast(wtzl as char(20)) as wtzl,
-- cast(ckxj as char(20)) as ckxj,
-- cast(dqjc as char(20)) as dqjc,
-- cast(0 as char(20)) as yk,
-- cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
-- cast(jxxxyztck as char(20)) as jxxxyztck,
-- cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
-- cast(jxxxyztrk as char(20)) as jxxxyztrk,
-- cast(ymyprk as char(20))  as ymyprk,
-- cast(ymypck as char(20)) as ymypck,
-- cast(zjdxrk as char(20)) as zjdxrk,
-- cast(zjdxck as char(20)) as zjdxck,
-- cast(fjzjrk as char(20)) as fjzjrk,
-- cast(fjzjck as char(20)) as fjzjck,
-- cast(mxhrk as char(20)) as mxhrk,
-- cast(mxhck as char(20)) as mxhck,
-- cast(cdztrk as char(20)) as cdztrk,
-- cast(cdztck as char(20)) as cdztck,
-- cast(hnztrk as char(20)) as hnztrk,
-- cast(hnztck as char(20)) as hnztck
-- from $temp36
-- union ALL
-- select plm,
-- cast(cast(qc as signed) as char(20))as qc,
-- cast(cast(krtcp as signed) as char(20))as krtcp,
-- cast(cast(fzgcrk as signed) as char(20))as fzgcrk,
-- cast(cast(fzztrk as signed) as char(20))as fzztrk,
-- cast(cast(b2brk as signed) as char(20))as b2brk,
-- cast(cast(szgcrk as signed) as char(20))as szgcrk,
-- cast(cast(szztrk as signed) as char(20))as szztrk,
-- cast(cast(bjztrk as signed) as char(20))as bjztrk,
-- cast(cast(bjrkje as signed) as char(20))as bjrkje,
-- cast(cast(bjJDSztrk as signed) as char(20))as bjJDSztrk,
-- cast(cast(bjJDSrkje as signed) as char(20))as bjJDSrkje,
-- cast(cast(zbztrk as signed) as char(20))as zbztrk,
-- cast(cast(sdztrk as signed) as char(20))as sdztrk,
-- cast(cast(sdXXYztrk as signed) as char(20))as sdXXYztrk,
-- cast(cast(KJztrk as signed) as char(20))as KJztrk,
-- cast(cast(wwrk as signed) as char(20))as wwrk,
-- cast(cast(cgrk as signed) as char(20))as cgrk,    
-- cast(cast(qtrk as signed) as char(20))as qtrk,
-- cast(cast(rkxj as signed) as char(20))as rkxj,
-- cast(cast(xsck as signed) as char(20))as xsck,    
-- cast(cast(szztck as signed) as char(20))as szztck,
-- cast(cast(szgcck as signed) as char(20))as szgcck,
-- cast(cast(szgcRLck as signed) as char(20))as szgcRLck,
-- cast(cast(bjztck as signed) as char(20))as bjztck,
-- cast(cast(bjckje as signed) as char(20))as bjckje,
-- cast(cast(bjJDSztck as signed) as char(20))as bjJDSztck,
-- cast(cast(bjJDSckje as signed) as char(20))as bjJDSckje,
-- cast(cast(fzztck as signed) as char(20))as fzztck,
-- cast(cast(b2bck as signed) as char(20))as b2bck,
-- cast(cast(zbztck as signed) as char(20))as zbztck,
-- cast(cast(sdztck as signed) as char(20))as sdztck,
-- cast(cast(sdXXYztck as signed) as char(20))as sdXXYztck,
-- cast(cast(KJztck as signed) as char(20))as KJztck,
-- cast(cast(wwth as signed) as char(20))as wwth,
-- cast(cast(rlzl as signed) as char(20))as rlzl,
-- cast(cast(wxzl as signed) as char(20))as wxzl,
-- cast(cast(qxzl as signed) as char(20))as qxzl,
-- cast(cast(wtzl as signed) as char(20))as wtzl,
-- cast(cast(ckxj as signed) as char(20))as ckxj,
-- cast(cast(dqjc as signed) as char(20))as dqjc,
-- cast(cast(0 as signed) as char(20))as yk,
-- cast(jxjdsyyzxck as char(20))as jxjdsyyzxck,
-- cast(jxxxyztck as char(20))as jxxxyztck,
-- cast(jxjdsyyzxrk as char(20))as jxjdsyyzxrk,
-- cast(jxxxyztrk as char(20))as jxxxyztrk,
-- cast(ymyprk as char(20))as ymyprk,
-- cast(ymypck as char(20))as ymypck,
-- cast(zjdxrk as char(20))as zjdxrk,
-- cast(zjdxck as char(20))as zjdxck,
-- cast(fjzjrk as char(20))as fjzjrk,
-- cast(fjzjck as char(20))as fjzjck ,
-- cast(mxhrk as char(20)) as mxhrk,
-- cast(mxhck as char(20)) as mxhck,
-- cast(cdztrk as char(20)) as cdztrk,
-- cast(cdztck as char(20)) as cdztck,
-- cast(hnztrk as char(20)) as hnztrk,
-- cast(hnztck as char(20)) as hnztck
-- from $temp33
UNION ALL
select 
plm as plm,
0 as qc,
0 as krtcp,
0 as fzgcrk,
0 as fzztrk,
0 as B2Brk,
0 as szgcrk,
0 as szztrk,
0 as bjztrk,
0 as bjrkje,
0 as bjJDSztrk,
0 as bjJDSrkje,
0 as zbztrk,
0 as sdztrk,
0 as sdXXYztrk,
0 as KJztrk,
0 as wwrk,
0 as cgrk,
0 as qtrk,
0 as rkxj,
0 as xsck,
0 as szztck,
0 as szgcck,
0 as szgcRLck,
0 as bjztck,
0 as bjckje,
0 as bjJDSztck,
0 as bjJDSckje,
0 as fzztck,
0 as B2Bck,
0 as zbztck,
0 as sdztck,
0 as sdXXYztck,
0 as KJztck,
0 as wwth,
0 as rlzl,
0 as wxzl,
0 as qxzl,
0 as wtzl,
0 as ckxj,
0 as dqjc,
0 as yk,
0 as jxjdsyyzxck,
0 as jxxxyztck,
0 as jxjdsyyzxrk,
0 as jxxxyztrk,
0  as ymyprk,
0 as ymypck,
0 as zjdxrk,
0 as zjdxck,
0 as fjzjrk,
0 as fjzjck,
0 as mxhrk,
0 as mxhck,
0 as cdztrk,
0 as cdztck,
0 as hnztrk,
0 as hnztck,
0 as syztrk,
0 as syztck
from $temp36
union ALL
select plm,
0 as qc,
0 as krtcp,
0 as fzgcrk,
0 as fzztrk,
0 as B2Brk,
0 as szgcrk,
0 as szztrk,
0 as bjztrk,
0 as bjrkje,
0 as bjJDSztrk,
0 as bjJDSrkje,
0 as zbztrk,
0 as sdztrk,
0 as sdXXYztrk,
0 as KJztrk,
0 as wwrk,
0 as cgrk,
0 as qtrk,
0 as rkxj,
0 as xsck,
0 as szztck,
0 as szgcck,
0 as szgcRLck,
0 as bjztck,
0 as bjckje,
0 as bjJDSztck,
0 as bjJDSckje,
0 as fzztck,
0 as B2Bck,
0 as zbztck,
0 as sdztck,
0 as sdXXYztck,
0 as KJztck,
0 as wwth,
0 as rlzl,
0 as wxzl,
0 as qxzl,
0 as wtzl,
0 as ckxj,
0 as dqjc,
0 as yk,
0 as jxjdsyyzxck,
0 as jxxxyztck,
0 as jxjdsyyzxrk,
0 as jxxxyztrk,
0  as ymyprk,
0 as ymypck,
0 as zjdxrk,
0 as zjdxck,
0 as fjzjrk,
0 as fjzjck,
0 as mxhrk,
0 as mxhck,
0 as cdztrk,
0 as cdztck,
0 as hnztrk,
0 as hnztck,
0 as syztrk,
0 as syztck
from $temp33
union all
select 
NULL as plm,
NULL as qc,
NULL as krtcp,
NULL as fzgcrk,
NULL as fzztrk,
NULL as B2Brk,
NULL as szgcrk,
NULL as szztrk,
NULL as bjztrk,
NULL as bjrkje,
NULL as bjJDSztrk,
NULL as bjJDSrkje,
NULL as zbztrk,
NULL as sdztrk,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL as wwrk,
NULL as cgrk,
NULL as qtrk,
NULL as rkxj,
NULL as xsck,
NULL as szztck,
NULL as szgcck,
NULL as bjztck,
NULL as bjckje,
NULL as bjJDSztck,
NULL as bjJDSckje,
NULL as fzztck,
NULL as B2Bck,
NULL as zbztck,
NULL as sdztck,
NULL as wwth,
NULL as rlzl,
NULL as wxzl,
NULL as qxzl,
NULL as wtzl,
NULL as ckxj,
NULL as dqjc,
NULL as yk,
NULL as jxjdsyyzxck,
NULL as jxxxyztck,
NULL as jxjdsyyzxrk,
NULL as jxxxyztrk,
NULL as ymyprk,
NULL as ymypck,
NULL as zjdxrk,
NULL as zjdxck,
NULL as fjzjrk,
NULL as fjzjck,
null as mxhrk,
null as mxhck,
null as cdztrk,
null as cdztck,
null as hnztrk,
null as hnztck,
null as syztrk,
null as syztck
/*union all
select 
'名称' as plm,
'期初' as qc,
'客户来料' as krtcp,
'福州工厂' as fzgcrk,
'福州展厅' as fzztrk ,
'B2B云展厅' as B2Brk,
'深圳工厂' as szgcrk,
'深圳展厅' as szztrk,
'北京展厅' as bjztrk,
'北京展厅金额' as bjrkje ,
'北京金德尚' as bjztrk,
'商品中心(XXY)' as bjrkje,
'总部5楼' as zbztrk,
'山东展厅' as sdztrk,
'德诚珠宝' as sdztrk,
'K金展厅' as sdztrk,
'' as wwrk,
'购料重量' as cgrk,
'其他' as qtrk,
'小计' as rkxj,
'售料' as xsck,
'深圳展厅' as szztck ,
'深圳工厂' as szgcck,
'深圳工厂' as szgcrlck,
'北京展厅' as bjztck,
'北京展厅金额' as bjckje,
'北京金德尚' as bjJDSztck,
'商品中心(XXY)' as bjJDSckje,
'福州展厅' as fzztck,
'B2B云展厅' as B2Bck,
'总部5楼'as zbztck,
'山东展厅' as sdztck,
'德诚珠宝' as sdxxyztck,
'K金展厅' as kjztck,
'委外付料' as wwth,
'福州工厂' as rlzl,
'其他' as wxzl,
'' as qxzl,
'' as wtzl,
'小计' as ckxj,
'当期结存' as dqjc,
NULL as yk ,
'江西金德尚运营中心' as jxjdsyyzxck,
'江西南昌展厅' as jxxxyztck,
'江西金德尚运营中心' as jxjdsyyzxrk,
'江西南昌展厅' as jxxxyztrk,
'因美优品' as ymyprk ,
'因美优品' as  ymypck,
'浙江德鑫' as zjdxrk,
'浙江德鑫' as zjdxck,
'福建中金' as fjzjrk,
'福建中金' as fjzjck,
'梦享会' as mxhrk,
'梦享会' as mxhck,
'成都展厅' as cdztrk,
'成都展厅' as cdztck,
'海南展厅' as hnztrk,
'海南展厅' as hnztck*/
 union ALL 
 
 select 
plm as plm,
cast(qc as char(20)) as qc,
cast(krtcp as char(20)) as krtcp,
cast(fzgcrk as char(20)) as fzgcrk,
cast(fzztrk as char(20)) as fzztrk,
cast(B2Brk as char(20)) as B2Brk,
cast(szgcrk as char(20)) as szgcrk,
cast(szztrk as char(20)) as szztrk,
cast(bjztrk as char(20)) as bjztrk,
cast(bjrkje as char(20)) as bjrkje,
cast(bjJDSztrk as char(20)) as bjJDSztrk,
cast(bjJDSrkje as char(20)) as bjJDSrkje,
cast(zbztrk as char(20)) as zbztrk,
cast(sdztrk as char(20)) as sdztrk,
cast(sdXXYztrk as char(20)) as sdXXYztrk,
cast(KJztrk as char(20)) as KJztrk,
cast(wwrk as char(20)) as wwrk,
cast(cgrk as char(20)) as cgrk,
cast(qtrk as char(20)) as qtrk,
cast(rkxj as char(20)) as rkxj,
cast(xsck as char(20)) as xsck,
cast(szztck as char(20)) as szztck,
cast(szgcck as char(20)) as szgcck,
cast(szgcRLck as char(20)) as szgcRLck,
cast(bjztck as char(20)) as bjztck,
cast(bjckje as char(20)) as bjckje,
cast(bjJDSztck as char(20)) as bjJDSztck,
cast(bjJDSckje as char(20)) as bjJDSckje,
cast(fzztck as char(20)) as fzztck,
cast(B2Bck as char(20)) as B2Bck,
cast(zbztck as char(20)) as zbztck,
cast(sdztck as char(20)) as sdztck,
cast(sdXXYztck as char(20)) as sdXXYztck,
cast(KJztck as char(20)) as KJztck,
cast(wwth as char(20)) as wwth,
cast(rlzl as char(20)) as rlzl,
cast(wxzl as char(20)) as wxzl,
cast(qxzl as char(20)) as qxzl,
cast(wtzl as char(20)) as wtzl,
cast(ckxj as char(20)) as ckxj,
cast(dqjc as char(20)) as dqjc,
cast(yk as char(20)) as yk,
cast(jxjdsyyzxck as char(20)) as jxjdsyyzxck,
cast(jxxxyztck as char(20)) as jxxxyztck,
cast(jxjdsyyzxrk as char(20)) as jxjdsyyzxrk,
cast(jxxxyztrk as char(20)) as jxxxyztrk,
cast(ymyprk as char(20))  as ymyprk,
cast(ymypck as char(20)) as ymypck,
cast(zjdxrk as char(20)) as zjdxrk,
cast(zjdxck as char(20)) as zjdxck,
cast(fjzjrk as char(20)) as fjzjrk,
cast(fjzjck as char(20)) as fjzjck,
cast(mxhrk as char(20)) as mxhrk,
cast(mxhck as char(20)) as mxhck,
cast(cdztrk as char(20)) as cdztrk,
cast(cdztck as char(20)) as cdztck,
cast(hnztrk as char(20)) as hnztrk,
cast(hnztck as char(20)) as hnztck,
cast(syztrk as char(20)) as syztrk,
cast(syztck as char(20)) as syztck
from $temp19
)f;






SELECT COUNT(*) AS COUNT FROM TEMP_RESAULT;



IF V_START = -1 THEN 
  SELECT * FROM TEMP_RESAULT;
ELSE 
  SELECT * FROM TEMP_RESAULT LIMIT V_START, V_LEN;
END IF;
-- select 
-- '合计'as plm,
-- cast($temp3.qc+$tempgf3.qc+$temp6.qc+$temp6_new.qc+$temp15.qc+$temp36.qc+$YJ.qc+$temp1588.qc+$temp1888.qc+$tempwq1888.qc+$tempgfwz3.qc+$tempgfwj3.qc+$tempzj3.qc+$tempqzccj3.qc+$tempwzccj3.qc/*+$ZJZ.qc*/ as char(20))as qc,
-- cast($temp3.krtcp+$tempgf3.krtcp+$temp6.krtcp+$temp6_new.krtcp+$temp15.krtcp+$temp36.krtcp+$YJ.krtcp+$temp1588.krtcp+$temp1888.krtcp+$tempwq1888.krtcp+$tempgfwz3.krtcp+$tempgfwj3.krtcp+$tempzj3.krtcp+$tempqzccj3.krtcp+$tempwzccj3.krtcp /*+$ZJZ.krtcp*/ as char(20))as krtcp,
-- cast($temp3.fzgcrk+$tempgf3.fzgcrk+$temp6.fzgcrk+$temp6_new.fzgcrk+$temp15.fzgcrk+$temp36.fzgcrk +$YJ.fzgcrk +$temp1588.fzgcrk+$temp1888.fzgcrk+$tempwq1888.fzgcrk+$tempgfwz3.fzgcrk+$tempgfwj3.fzgcrk+$tempzj3.fzgcrk+$tempqzccj3.fzgcrk+$tempwzccj3.fzgcrk /*+$ZJZ.fzgcrk*/ as char(20))as fzgcrk,
-- cast($temp3.fzztrk+$tempgf3.fzztrk+$temp6.fzztrk+$temp6_new.fzztrk+$temp15.fzztrk+$temp36.fzztrk+$YJ.fzztrk+$temp1588.fzztrk+$temp1888.fzztrk+$tempwq1888.fzztrk+$tempgfwz3.fzztrk+$tempgfwj3.fzztrk+$tempzj3.fzztrk+$tempqzccj3.fzztrk+$tempwzccj3.fzztrk /*+$ZJZ.fzztrk*/ as char(20))as fzztrk,
-- cast($temp3.B2BRK+$tempgf3.B2BRK+$temp6.B2BRK+$temp6_new.B2BRK+$temp15.B2BRK+$temp36.B2BRK+$YJ.B2BRK+$temp1588.B2BRK+$temp1888.B2BRK+$tempwq1888.B2BRK+$tempgfwz3.B2BRK+$tempgfwj3.B2BRK+$tempzj3.B2BRK+$tempqzccj3.B2BRK+$tempwzccj3.B2BRK /*+$ZJZ.B2BRK*/ as char(20))as B2BRK,
-- cast($temp3.szgcrk+$tempgf3.szgcrk+$temp6.szgcrk+$temp6_new.szgcrk+$temp15.szgcrk+$temp36.szgcrk+$YJ.szgcrk+$temp1588.szgcrk+$temp1888.szgcrk+$tempwq1888.szgcrk+$tempgfwz3.szgcrk+$tempgfwj3.szgcrk+$tempzj3.szgcrk+$tempqzccj3.szgcrk+$tempwzccj3.szgcrk/*+$ZJZ.szgcrk*/ as char(20))as szgcrk,
-- cast($temp3.szztrk+$tempgf3.szztrk+$temp6.szztrk+$temp6_new.szztrk+$temp15.szztrk+$temp36.szztrk +$YJ.szztrk +$temp1588.szztrk +$temp1888.szztrk+$tempwq1888.szztrk+$tempgfwz3.szztrk+$tempgfwj3.szztrk+$tempzj3.szztrk+$tempqzccj3.szztrk+$tempwzccj3.szztrk/*+$ZJZ.szztrk*/ as char(20))as szztrk,
-- cast($temp3.bjztrk+$tempgf3.bjztrk+$temp6.bjztrk+$temp6_new.bjztrk+$temp15.bjztrk+$temp36.bjztrk+$YJ.bjztrk+$temp1588.bjztrk+$temp1888.bjztrk+$tempwq1888.bjztrk+$tempgfwz3.bjztrk+$tempgfwj3.bjztrk+$tempzj3.bjztrk+$tempqzccj3.bjztrk+$tempwzccj3.bjztrk/*+$ZJZ.bjztrk*/  as char(20))as bjztrk,
-- cast($temp3.bjrkje+$tempgf3.bjrkje+$temp6.bjrkje+$temp6_new.bjrkje+$temp15.bjrkje+$temp36.bjrkje+$YJ.bjrkje+$temp1588.bjrkje+$temp1888.bjrkje+$tempwq1888.bjrkje+$tempgfwz3.bjrkje+$tempgfwj3.bjrkje+$tempzj3.bjrkje+$tempqzccj3.bjrkje+$tempwzccj3.bjrkje/*+$ZJZ.bjrkje*/  as char(20))as bjrkje,
-- cast($temp3.bjJDSztrk+$tempgf3.bjJDSztrk+$temp6.bjJDSztrk+$temp6_new.bjJDSztrk+$temp15.bjJDSztrk+$temp36.bjJDSztrk+$YJ.bjJDSztrk+$temp1588.bjJDSztrk+$temp1888.bjJDSztrk+$tempwq1888.bjJDSztrk+$tempgfwz3.bjJDSztrk+$tempgfwj3.bjJDSztrk+$tempzj3.bjJDSztrk+$tempqzccj3.bjJDSztrk+$tempwzccj3.bjJDSztrk/*+$ZJZ.bjJDSztrk*/ as char(20))as bjJDSztrk,
-- cast($temp3.bjJDSrkje+$tempgf3.bjJDSrkje+$temp6.bjJDSrkje+$temp6_new.bjJDSrkje+$temp15.bjJDSrkje+$temp36.bjJDSrkje+$YJ.bjJDSrkje+$temp1588.bjJDSrkje+$temp1888.bjJDSrkje+$tempwq1888.bjJDSrkje+$tempgfwz3.bjJDSrkje+$tempgfwj3.bjJDSrkje+$tempzj3.bjJDSrkje+$tempqzccj3.bjJDSrkje+$tempwzccj3.bjJDSrkje/*+$ZJZ.bjJDSrkje*/  as char(20))as bjJDSrkje,
-- cast($temp3.zbztrk+$tempgf3.zbztrk+$temp6.zbztrk+$temp6_new.zbztrk+$temp15.zbztrk+$temp36.zbztrk+$YJ.zbztrk+$temp1588.zbztrk+$temp1888.zbztrk+$tempwq1888.zbztrk+$tempgfwz3.zbztrk+$tempgfwj3.zbztrk+$tempzj3.zbztrk+$tempqzccj3.zbztrk+$tempwzccj3.zbztrk/*+$ZJZ.zbztrk*/  as char(20))as zbztrk,
-- cast($temp3.sdztrk+$tempgf3.sdztrk+$temp6.sdztrk+$temp6_new.sdztrk+$temp15.sdztrk+$temp36.sdztrk+$YJ.sdztrk+$temp1588.sdztrk+$temp1888.sdztrk+$tempwq1888.sdztrk+$tempgfwz3.sdztrk+$tempgfwj3.sdztrk+$tempzj3.sdztrk+$tempqzccj3.sdztrk+$tempwzccj3.sdztrk/*+$ZJZ.sdztrk*/   as char(20))as sdztrk,
-- cast($temp3.sdxxyztrk+$tempgf3.sdxxyztrk+$temp6.sdxxyztrk+$temp6_new.sdxxyztrk+$temp15.sdxxyztrk+$temp36.sdxxyztrk+$YJ.sdxxyztrk+$temp1588.sdxxyztrk+$temp1888.sdxxyztrk+$tempwq1888.sdxxyztrk+$tempgfwz3.sdxxyztrk+$tempgfwj3.sdxxyztrk+$tempzj3.sdxxyztrk+$tempqzccj3.sdxxyztrk+$tempwzccj3.sdxxyztrk/*+$ZJZ.sdxxyztrk*/ as char(20))as sdxxyztrk,
-- cast($temp3.KJztrk+$tempgf3.KJztrk+$temp6.KJztrk+$temp6_new.KJztrk+$temp15.KJztrk+$temp36.KJztrk +$YJ.KJztrk +$temp1588.KJztrk+$temp1888.KJztrk+$tempwq1888.KJztrk+$tempgfwz3.KJztrk+$tempgfwj3.KJztrk+$tempzj3.KJztrk+$tempqzccj3.KJztrk+$tempwzccj3.KJztrk/*+$ZJZ.KJztrk*/ as char(20))as KJztrk,
-- cast($temp3.wwrk+$tempgf3.wwrk+$temp6.wwrk+$temp6_new.wwrk+$temp15.wwrk+$temp36.wwrk+$YJ.wwrk+$temp1588.wwrk+$temp1888.wwrk+$tempwq1888.wwrk+$tempgfwz3.wwrk+$tempgfwj3.wwrk+$tempzj3.wwrk+$tempqzccj3.wwrk+$tempwzccj3.wwrk/*+$ZJZ.wwrk */as char(20))as wwrk,
-- cast($temp3.cgrk+$tempgf3.cgrk+$temp6.cgrk+$temp6_new.cgrk+$temp15.cgrk+$temp36.cgrk+$YJ.cgrk+$temp1588.cgrk+$temp1888.cgrk+$tempwq1888.cgrk+$tempgfwz3.cgrk+$tempgfwj3.cgrk+$tempzj3.cgrk+$tempqzccj3.cgrk+$tempwzccj3.cgrk/*+$ZJZ.cgrk*/ as char(20))as cgrk,
-- cast($temp3.qtrk+$tempgf3.qtrk+$temp6.qtrk+$temp6_new.qtrk+$temp15.qtrk+$temp36.qtrk+$YJ.qtrk+$temp1588.qtrk+$temp1888.qtrk+$tempwq1888.qtrk+$tempgfwz3.qtrk+$tempgfwj3.qtrk+$tempzj3.qtrk+$tempqzccj3.qtrk+$tempwzccj3.qtrk/*+$ZJZ.qtrk*/   as char(20))as qtrk,
-- cast($temp3.rkxj+$tempgf3.rkxj+$temp6.rkxj+$temp15.rkxj+$temp6_new.rkxj+$temp36.rkxj+$YJ.rkxj+$temp1588.rkxj+$temp1888.rkxj+$tempwq1888.rkxj+$tempgfwz3.rkxj+$tempgfwj3.rkxj+$tempzj3.rkxj+$tempqzccj3.rkxj+$tempwzccj3.rkxj/*+$ZJZ.rkxj*/ as char(20))as rkxj,
-- cast($temp3.xsck+$tempgf3.xsck+$temp6.xsck+$temp6_new.xsck+$temp15.xsck+$temp36.xsck+$YJ.xsck+$temp1588.xsck+$temp1888.xsck+$tempwq1888.xsck+$tempgfwz3.xsck+$tempgfwj3.xsck+$tempzj3.xsck+$tempqzccj3.xsck+$tempwzccj3.xsck/*+$ZJZ.xsck*/   as char(20))as xsck,
-- cast($temp3.szztck+$tempgf3.szztck+$temp6.szztck+$temp6_new.szztck+$temp15.szztck+$temp36.szztck+$YJ.szztck+$temp1588.szztck+$temp1888.szztck+$tempwq1888.szztck+$tempgfwz3.szztck+$tempgfwj3.szztck+$tempzj3.szztck+$tempqzccj3.szztck+$tempwzccj3.szztck/*+$ZJZ.szztck*/ as char(20))as szztck,
-- cast($temp3.szgcck+$tempgf3.szgcck+$temp6.szgcck+$temp6_new.szgcck+$temp15.szgcck+$temp36.szgcck+$YJ.szgcck+$temp1588.szgcck+$temp1888.szgcck+$tempwq1888.szgcck+$tempgfwz3.szgcck+$tempgfwj3.szgcck+$tempzj3.szgcck+$tempqzccj3.szgcck+$tempwzccj3.szgcck/*+$ZJZ.szgcck*/  as char(20))as szgcck,
-- cast($temp3.szgcrlck+$tempgf3.szgcrlck+$temp6.szgcrlck+$temp6_new.szgcrlck+$temp15.szgcrlck+$temp36.szgcrlck+$YJ.szgcrlck+$temp1588.szgcrlck+$temp1888.szgcrlck+$tempwq1888.szgcrlck+$tempgfwz3.szgcrlck+$tempgfwj3.szgcrlck+$tempzj3.szgcrlck+$tempqzccj3.szgcrlck+$tempwzccj3.szgcrlck/*+$ZJZ.szgcrlck*/ as char(20))as szgcrlck,
-- cast($temp3.bjztck+$tempgf3.bjztck+$temp6.bjztck+$temp6_new.bjztck+$temp15.bjztck+$temp36.bjztck+$YJ.bjztck+$temp1588.bjztck+$temp1888.bjztck+$tempwq1888.bjztck+$tempgfwz3.bjztck+$tempgfwj3.bjztck+$tempzj3.bjztck+$tempqzccj3.bjztck+$tempwzccj3.bjztck/*+$ZJZ.bjztck*/  as char(20))as bjztck,
-- cast($temp3.bjckje+$tempgf3.bjckje+$temp6.bjckje+$temp6_new.bjckje+$temp15.bjckje+$temp36.bjckje+$YJ.bjckje+$temp1588.bjckje+$temp1888.bjckje+$tempwq1888.bjckje+$tempgfwz3.bjckje+$tempgfwj3.bjckje+$tempzj3.bjckje+$tempqzccj3.bjckje+$tempwzccj3.bjckje/*+$ZJZ.bjckje*/  as char(20))as bjckje,
-- cast($temp3.bjJDSztck+$tempgf3.bjJDSztck+$temp6.bjJDSztck+$temp6_new.bjJDSztck+$temp15.bjJDSztck+$temp36.bjJDSztck +$YJ.bjJDSztck +$temp1588.bjJDSztck+$temp1888.bjJDSztck+$tempwq1888.bjJDSztck+$tempgfwz3.bjJDSztck+$tempgfwj3.bjJDSztck+$tempzj3.bjJDSztck+$tempqzccj3.bjJDSztck+$tempwzccj3.bjJDSztck/*+$ZJZ.bjJDSztck*/  as char(20))as bjJDSztck,
-- cast($temp3.bjJDSckje+$tempgf3.bjJDSckje+$temp6.bjJDSckje+$temp6_new.bjJDSckje+$temp15.bjJDSckje+$temp36.bjJDSckje+$YJ.bjJDSckje+$temp1588.bjJDSckje+$temp1888.bjJDSckje+$tempwq1888.bjJDSckje+$tempgfwz3.bjJDSckje+$tempgfwj3.bjJDSckje+$tempzj3.bjJDSckje+$tempqzccj3.bjJDSckje+$tempwzccj3.bjJDSckje/*+$ZJZ.bjJDSckje*/  as char(20))as bjJDSckje,
-- cast($temp3.fzztck+$tempgf3.fzztck+$temp6.fzztck+$temp6_new.fzztck+$temp15.fzztck+$temp36.fzztck +$YJ.fzztck +$temp1588.fzztck+$temp1888.fzztck+$tempwq1888.fzztck+$tempgfwz3.fzztck+$tempgfwj3.fzztck+$tempzj3.fzztck+$tempqzccj3.fzztck+$tempwzccj3.fzztck/*+$ZJZ.fzztck*/  as char(20))as fzztck,
-- cast($temp3.B2BCK+$tempgf3.B2BCK+$temp6.B2BCK+$temp6_new.B2BCK+$temp15.B2BCK+$temp36.B2BCK +$YJ.B2BCK +$temp1588.B2BCK+$temp1888.B2BCK+$tempwq1888.B2BCK+$tempgfwz3.B2BCK+$tempgfwj3.B2BCK+$tempzj3.B2BCK+$tempqzccj3.B2BCK+$tempwzccj3.B2BCK/*+$ZJZ.B2BCK*/  as char(20))as B2Bck,
-- cast($temp3.zbztck+$tempgf3.zbztck+$temp6.zbztck+$temp6_new.zbztck+$temp15.zbztck+$temp36.zbztck +$YJ.zbztck +$temp1588.zbztck+$temp1888.zbztck+$tempwq1888.zbztck+$tempgfwz3.zbztck+$tempgfwj3.zbztck+$tempzj3.zbztck+$tempqzccj3.zbztck+$tempwzccj3.zbztck/*+$ZJZ.zbztck*/  as char(20))as zbztck,
-- cast($temp3.sdztck+$tempgf3.sdztck+$temp6.sdztck+$temp6_new.sdztck+$temp15.sdztck+$temp36.sdztck+$YJ.sdztck+$temp1588.sdztck+$temp1888.sdztck+$tempwq1888.sdztck+$tempgfwz3.sdztck+$tempgfwj3.sdztck+$tempzj3.sdztck+$tempqzccj3.sdztck+$tempwzccj3.sdztck/*+$ZJZ.sdztck*/   as char(20))as sdztck,
-- cast($temp3.sdxxyztck+$tempgf3.sdxxyztck+$temp6.sdxxyztck+$temp6_new.sdxxyztck+$temp15.sdxxyztck+$temp36.sdxxyztck+$YJ.sdxxyztck+$temp1588.sdxxyztck+$temp1888.sdxxyztck+$tempwq1888.sdxxyztck+$tempgfwz3.sdxxyztck+$tempgfwj3.sdxxyztck+$tempzj3.sdxxyztck+$tempqzccj3.sdxxyztck+$tempwzccj3.sdxxyztck/*+$ZJZ.sdxxyztck*/ as char(20))as sdxxyztck,
-- cast($temp3.kjztck+$tempgf3.kjztck+$temp6.kjztck+$temp6_new.kjztck+$temp15.kjztck+$temp36.kjztck+$YJ.kjztck+$temp1588.kjztck+$temp1888.kjztck+$tempwq1888.kjztck+$tempgfwz3.kjztck+$tempgfwj3.kjztck+$tempzj3.kjztck+$tempqzccj3.kjztck+$tempwzccj3.kjztck/*+$ZJZ.kjztck*/   as char(20))as kjztck,
-- cast($temp3.wwth+$tempgf3.wwth+$temp6.wwth+$temp6_new.wwth+$temp15.wwth+$temp36.wwth+$YJ.wwth+$temp1588.wwth+$temp1888.wwth+$tempwq1888.wwth+$tempgfwz3.wwth+$tempgfwj3.wwth+$tempzj3.wwth+$tempqzccj3.wwth+$tempwzccj3.wwth/*+$ZJZ.wwth*/  as char(20))as wwth,
-- cast($temp3.rlzl+$tempgf3.rlzl+$temp6.rlzl+$temp6_new.rlzl+$temp15.rlzl+$temp36.rlzl+$YJ.rlzl+$temp1588.rlzl+$temp1888.rlzl+$tempwq1888.rlzl+$tempgfwz3.rlzl+$tempgfwj3.rlzl+$tempzj3.rlzl+$tempqzccj3.rlzl+$tempwzccj3.rlzl/*+$ZJZ.rlzl*/  as char(20))as rlzl,
-- cast($temp3.wxzl+$tempgf3.wxzl+$temp6.wxzl+$temp6_new.wxzl+$temp15.wxzl+$temp36.wxzl+$YJ.wxzl+$temp1588.wxzl+$temp1888.wxzl+$tempwq1888.wxzl+$tempgfwz3.wxzl+$tempgfwj3.wxzl+$tempzj3.wxzl+$tempqzccj3.wxzl+$tempwzccj3.wxzl/*+$ZJZ.wxzl*/  as char(20))as wxzl,
-- cast($temp3.qxzl+$tempgf3.qxzl+$temp6.qxzl+$temp6_new.qxzl+$temp15.qxzl+$temp36.qxzl+$YJ.qxzl+$temp1588.qxzl+$temp1888.qxzl+$tempwq1888.qxzl+$tempgfwz3.qxzl+$tempgfwj3.qxzl+$tempzj3.qxzl+$tempqzccj3.qxzl+$tempwzccj3.qxzl/*+$ZJZ.qxzl*/   as char(20))as qxzl,
-- cast($temp3.wtzl+$tempgf3.wtzl+$temp6.wtzl+$temp6_new.wtzl+$temp15.wtzl+$temp36.wtzl+$YJ.wtzl+$temp1588.wtzl+$temp1888.wtzl+$tempwq1888.wtzl+$tempgfwz3.wtzl+$tempgfwj3.wtzl+$tempzj3.wtzl+$tempqzccj3.wtzl+$tempwzccj3.wtzl/*+$ZJZ.wtzl*/  as char(20))as wtzl,
-- cast($temp3.ckxj+$tempgf3.ckxj+$temp6.ckxj+$temp6_new.ckxj+$temp15.ckxj+$temp36.ckxj+$YJ.ckxj+$temp1588.ckxj+$temp1888.ckxj+$tempwq1888.ckxj+$tempgfwz3.ckxj+$tempgfwj3.ckxj+$tempzj3.ckxj+$tempqzccj3.ckxj+$tempwzccj3.ckxj/*+$ZJZ.ckxj*/  as char(20))as ckxj,
-- cast($temp3.dqjc+$tempgf3.dqjc+$temp6.dqjc+$temp6_new.dqjc+$temp15.dqjc+$temp36.dqjc+$YJ.dqjc+$temp1588.dqjc+$temp1888.dqjc+$tempwq1888.dqjc+$tempgfwz3.dqjc+$tempgfwj3.dqjc+$tempzj3.dqjc+$tempqzccj3.dqjc+$tempwzccj3.dqjc/*+$ZJZ.dqjc*/  as char(20))as dqjc,
-- cast($temp3.yk+$tempgf3.yk+$temp6.yk+$temp6_new.yk+$temp15.yk+$temp36.yk+$YJ.yk+$temp1588.yk+$temp1888.yk+$tempwq1888.yk+$tempgfwz3.yk+$tempgfwj3.yk+$tempzj3.yk+$tempqzccj3.yk+$tempwzccj3.yk/*+$ZJZ.yk*/  as char(20))as yk,
-- cast($temp3.jxjdsyyzxck+$tempgf3.jxjdsyyzxck+$temp6.jxjdsyyzxck+$temp6_new.jxjdsyyzxck+$temp15.jxjdsyyzxck+$temp36.jxjdsyyzxck+$YJ.jxjdsyyzxck+$temp1588.jxjdsyyzxck+$temp1888.jxjdsyyzxck+$tempwq1888.jxjdsyyzxck+$tempgfwz3.jxjdsyyzxck+$tempgfwj3.jxjdsyyzxck+$tempzj3.jxjdsyyzxck+$tempqzccj3.jxjdsyyzxck+$tempwzccj3.jxjdsyyzxck/*+$ZJZ.jxjdsyyzxck*/ as char(20))as jxjdsyyzxck,
-- cast($temp3.jxxxyztck+$tempgf3.jxxxyztck+$temp6.jxxxyztck+$temp6_new.jxxxyztck+$temp15.jxxxyztck+$temp36.jxxxyztck+$YJ.jxxxyztck+$temp1588.jxxxyztck+$temp1888.jxxxyztck+$tempwq1888.jxxxyztck+$tempgfwz3.jxxxyztck+$tempgfwj3.jxxxyztck+$tempzj3.jxxxyztck+$tempqzccj3.jxxxyztck+$tempwzccj3.jxxxyztck/*+$ZJZ.jxxxyztck*/  as char(20))as jxxxyztck,
-- cast($temp3.jxjdsyyzxrk+$tempgf3.jxjdsyyzxrk+$temp6.jxjdsyyzxrk+$temp6_new.jxjdsyyzxrk+$temp15.jxjdsyyzxrk+$temp36.jxjdsyyzxrk+$YJ.jxjdsyyzxrk+$temp1588.jxjdsyyzxrk+$temp1888.jxjdsyyzxrk+$tempwq1888.jxjdsyyzxrk+$tempgfwz3.jxjdsyyzxrk+$tempgfwj3.jxjdsyyzxrk+$tempzj3.jxjdsyyzxrk+$tempqzccj3.jxjdsyyzxrk+$tempwzccj3.jxjdsyyzxrk/*+$ZJZ.jxjdsyyzxrk*/  as char(20))as jxjdsyyzxrk,
-- cast($temp3.jxxxyztrk+$tempgf3.jxxxyztrk+$temp6.jxxxyztrk+$temp6_new.jxxxyztrk+$temp15.jxxxyztrk+$temp36.jxxxyztrk+$YJ.jxxxyztrk+$temp1588.jxxxyztrk+$temp1888.jxxxyztrk+$tempwq1888.jxxxyztrk+$tempgfwz3.jxxxyztrk+$tempgfwj3.jxxxyztrk+$tempzj3.jxxxyztrk+$tempqzccj3.jxxxyztrk+$tempwzccj3.jxxxyztrk/*+$ZJZ.jxxxyztrk*/ as char(20))as jxxxyztrk,
-- cast($temp3.ymyprk+$tempgf3.ymyprk+$temp6.ymyprk+$temp6_new.ymyprk+$temp15.ymyprk+$temp36.ymyprk+$YJ.ymyprk+$temp1588.ymyprk+$temp1888.ymyprk+$tempwq1888.ymyprk+$tempgfwz3.ymyprk+$tempgfwj3.ymyprk+$tempzj3.ymyprk+$tempqzccj3.ymyprk+$tempwzccj3.ymyprk/*+$ZJZ.ymyprk*/ as char(20))as ymyprk,
-- cast($temp3.ymypck+$tempgf3.ymypck+$temp6.ymypck+$temp6_new.ymypck+$temp15.ymypck+$temp36.ymypck+$YJ.ymypck+$temp1588.ymypck+$temp1888.ymypck+$tempwq1888.ymypck+$tempgfwz3.ymypck+$tempgfwj3.ymypck+$tempzj3.ymypck+$tempqzccj3.ymypck+$tempwzccj3.ymypck/*+$ZJZ.ymypck*/  as char(20))as ymypck,
-- cast($temp3.zjdxrk+$tempgf3.zjdxrk+$temp6.zjdxrk+$temp6_new.zjdxrk+$temp15.zjdxrk+$temp36.zjdxrk+$YJ.zjdxrk+$temp1588.zjdxrk+$temp1888.zjdxrk+$tempwq1888.zjdxrk+$tempgfwz3.zjdxrk+$tempgfwj3.zjdxrk+$tempzj3.zjdxrk+$tempqzccj3.zjdxrk+$tempwzccj3.zjdxrk/*+$ZJZ.zjdxrk */ as char(20))as zjdxrk,
-- cast($temp3.zjdxck+$tempgf3.zjdxck+$temp6.zjdxck+$temp6_new.zjdxck+$temp15.zjdxck+$temp36.zjdxck+$YJ.zjdxck+$temp1588.zjdxck+$temp1888.zjdxck+$tempwq1888.zjdxck+$tempgfwz3.zjdxck+$tempgfwj3.zjdxck+$tempzj3.zjdxck+$tempqzccj3.zjdxck+$tempwzccj3.zjdxck/*+$ZJZ.zjdxck*/  as char(20))as zjdxck,
-- cast($temp3.fjzjrk+$tempgf3.fjzjrk+$temp6.fjzjrk+$temp6_new.fjzjrk+$temp15.fjzjrk+$temp36.fjzjrk+$YJ.fjzjrk+$temp1588.fjzjrk+$temp1888.fjzjrk+$tempwq1888.fjzjrk+$tempgfwz3.fjzjrk+$tempgfwj3.fjzjrk+$tempzj3.fjzjrk+$tempqzccj3.fjzjrk+$tempwzccj3.fjzjrk/*+$ZJZ.fjzjrk*/  as char(20))as fjzjrk,
-- cast($temp3.fjzjck+$tempgf3.fjzjck+$temp6.fjzjck+$temp6_new.fjzjck+$temp15.fjzjck+$temp36.fjzjck+$YJ.fjzjck+$temp1588.fjzjck+$temp1888.fjzjck+$tempwq1888.fjzjck+$tempgfwz3.fjzjck+$tempgfwj3.fjzjck+$tempzj3.fjzjck+$tempqzccj3.fjzjck+$tempwzccj3.fjzjck/*+$ZJZ.fjzjck*/  as char(20))as fjzjck,
-- cast($temp3.mxhrk+$tempgf3.mxhrk+$temp6.mxhrk+$temp6_new.mxhrk+$temp15.mxhrk+$temp36.mxhrk+$YJ.mxhrk+$temp1588.mxhrk+$temp1888.mxhrk+$tempwq1888.mxhrk+$tempgfwz3.mxhrk+$tempgfwj3.mxhrk+$tempzj3.mxhrk+$tempqzccj3.mxhrk+$tempwzccj3.mxhrk /*+$ZJZ.mxhrk*/ as char(20)) as mxhrk,
-- cast($temp3.mxhck+$tempgf3.mxhck+$temp6.mxhck+$temp6_new.mxhck+$temp15.mxhck+$temp36.mxhck+$YJ.mxhck+$temp1588.mxhck+$temp1888.mxhck+$tempwq1888.mxhck+$tempgfwz3.mxhck+$tempgfwj3.mxhck+$tempzj3.mxhck+$tempqzccj3.mxhck+$tempwzccj3.mxhck/*+$ZJZ.mxhck*/ as char(20)) as mxhck,
-- cast($temp3.cdztrk+$tempgf3.cdztrk+$temp6.cdztrk+$temp6_new.cdztrk+$temp15.cdztrk+$temp36.cdztrk+$YJ.cdztrk+$temp1588.cdztrk+$temp1888.cdztrk+$tempwq1888.cdztrk+$tempgfwz3.cdztrk+$tempgfwj3.cdztrk+$tempzj3.cdztrk+$tempqzccj3.cdztrk+$tempwzccj3.cdztrk /*+$ZJZ.mxhrk*/ as char(20)) as cdztrk,
-- cast($temp3.cdztck+$tempgf3.cdztck+$temp6.cdztck+$temp6_new.cdztck+$temp15.cdztck+$temp36.cdztck+$YJ.cdztck+$temp1588.cdztck+$temp1888.cdztck+$tempwq1888.cdztck+$tempgfwz3.cdztck+$tempgfwj3.cdztck+$tempzj3.cdztck+$tempqzccj3.cdztck+$tempwzccj3.cdztck/*+$ZJZ.mxhck*/ as char(20)) as cdztck
-- from $temp3,$tempgf3,$temp6,$temp6_new,$temp15 ,$temp1588 ,$temp36 ,$YJ ,$temp1888,$tempwq1888 ,$tempgfwz3,$tempgfwj3,$tempzj3,$tempqzccj3,$tempwzccj3/*,$ZJZ*/;

 select 
'合计'as plm,
cast($temp3.qc+$tempgf3.qc+$temp6.qc+$temp6_new.qc+$temp15.qc+ $YJ.qc+$temp1588.qc+$temp1888.qc+$tempwq1888.qc+$tempgfwz3.qc+$tempgfwj3.qc+$tempzj3.qc+$tempqzccj3.qc+$tempwzccj3.qc/*+$ZJZ.qc*/ as char(20))as qc,
cast($temp3.krtcp+$tempgf3.krtcp+$temp6.krtcp+$temp6_new.krtcp+$temp15.krtcp+ $YJ.krtcp+$temp1588.krtcp+$temp1888.krtcp+$tempwq1888.krtcp+$tempgfwz3.krtcp+$tempgfwj3.krtcp+$tempzj3.krtcp+$tempqzccj3.krtcp+$tempwzccj3.krtcp as char(20))as krtcp,
cast($temp3.fzgcrk+$tempgf3.fzgcrk+$temp6.fzgcrk+$temp6_new.fzgcrk+$temp15.fzgcrk+ $YJ.fzgcrk +$temp1588.fzgcrk+$temp1888.fzgcrk+$tempwq1888.fzgcrk+$tempgfwz3.fzgcrk+$tempgfwj3.fzgcrk+$tempzj3.fzgcrk+$tempqzccj3.fzgcrk+$tempwzccj3.fzgcrk /*+$ZJZ.fzgcrk*/ as char(20))as fzgcrk,
cast($temp3.fzztrk+$tempgf3.fzztrk+$temp6.fzztrk+$temp6_new.fzztrk+$temp15.fzztrk+ $YJ.fzztrk+$temp1588.fzztrk+$temp1888.fzztrk+$tempwq1888.fzztrk+$tempgfwz3.fzztrk+$tempgfwj3.fzztrk+$tempzj3.fzztrk+$tempqzccj3.fzztrk+$tempwzccj3.fzztrk /*+$ZJZ.fzztrk*/ as char(20))as fzztrk,
cast($temp3.B2BRK+$tempgf3.B2BRK+$temp6.B2BRK+$temp6_new.B2BRK+$temp15.B2BRK+ $YJ.B2BRK+$temp1588.B2BRK+$temp1888.B2BRK+$tempwq1888.B2BRK+$tempgfwz3.B2BRK+$tempgfwj3.B2BRK+$tempzj3.B2BRK+$tempqzccj3.B2BRK+$tempwzccj3.B2BRK /*+$ZJZ.B2BRK*/ as char(20))as B2BRK,
cast($temp3.szgcrk+$tempgf3.szgcrk+$temp6.szgcrk+$temp6_new.szgcrk+$temp15.szgcrk+ $YJ.szgcrk+$temp1588.szgcrk+$temp1888.szgcrk+$tempwq1888.szgcrk+$tempgfwz3.szgcrk+$tempgfwj3.szgcrk+$tempzj3.szgcrk+$tempqzccj3.szgcrk+$tempwzccj3.szgcrk/*+$ZJZ.szgcrk*/ as char(20))as szgcrk,
cast($temp3.szztrk+$tempgf3.szztrk+$temp6.szztrk+$temp6_new.szztrk+$temp15.szztrk+ $YJ.szztrk +$temp1588.szztrk +$temp1888.szztrk+$tempwq1888.szztrk+$tempgfwz3.szztrk+$tempgfwj3.szztrk+$tempzj3.szztrk+$tempqzccj3.szztrk+$tempwzccj3.szztrk/*+$ZJZ.szztrk*/ as char(20))as szztrk,
cast($temp3.bjztrk+$tempgf3.bjztrk+$temp6.bjztrk+$temp6_new.bjztrk+$temp15.bjztrk+ $YJ.bjztrk+$temp1588.bjztrk+$temp1888.bjztrk+$tempwq1888.bjztrk+$tempgfwz3.bjztrk+$tempgfwj3.bjztrk+$tempzj3.bjztrk+$tempqzccj3.bjztrk+$tempwzccj3.bjztrk/*+$ZJZ.bjztrk*/  as char(20))as bjztrk,
cast($temp3.bjrkje+$tempgf3.bjrkje+$temp6.bjrkje+$temp6_new.bjrkje+$temp15.bjrkje+ $YJ.bjrkje+$temp1588.bjrkje+$temp1888.bjrkje+$tempwq1888.bjrkje+$tempgfwz3.bjrkje+$tempgfwj3.bjrkje+$tempzj3.bjrkje+$tempqzccj3.bjrkje+$tempwzccj3.bjrkje/*+$ZJZ.bjrkje*/  as char(20))as bjrkje,
cast($temp3.bjJDSztrk+$tempgf3.bjJDSztrk+$temp6.bjJDSztrk+$temp6_new.bjJDSztrk+$temp15.bjJDSztrk+ $YJ.bjJDSztrk+$temp1588.bjJDSztrk+$temp1888.bjJDSztrk+$tempwq1888.bjJDSztrk+$tempgfwz3.bjJDSztrk+$tempgfwj3.bjJDSztrk+$tempzj3.bjJDSztrk+$tempqzccj3.bjJDSztrk+$tempwzccj3.bjJDSztrk/*+$ZJZ.bjJDSztrk*/ as char(20))as bjJDSztrk,
cast($temp3.bjJDSrkje+$tempgf3.bjJDSrkje+$temp6.bjJDSrkje+$temp6_new.bjJDSrkje+$temp15.bjJDSrkje+ $YJ.bjJDSrkje+$temp1588.bjJDSrkje+$temp1888.bjJDSrkje+$tempwq1888.bjJDSrkje+$tempgfwz3.bjJDSrkje+$tempgfwj3.bjJDSrkje+$tempzj3.bjJDSrkje+$tempqzccj3.bjJDSrkje+$tempwzccj3.bjJDSrkje/*+$ZJZ.bjJDSrkje*/  as char(20))as bjJDSrkje,
cast($temp3.zbztrk+$tempgf3.zbztrk+$temp6.zbztrk+$temp6_new.zbztrk+$temp15.zbztrk+ $YJ.zbztrk+$temp1588.zbztrk+$temp1888.zbztrk+$tempwq1888.zbztrk+$tempgfwz3.zbztrk+$tempgfwj3.zbztrk+$tempzj3.zbztrk+$tempqzccj3.zbztrk+$tempwzccj3.zbztrk/*+$ZJZ.zbztrk*/  as char(20))as zbztrk,
cast($temp3.sdztrk+$tempgf3.sdztrk+$temp6.sdztrk+$temp6_new.sdztrk+$temp15.sdztrk+ +$YJ.sdztrk+$temp1588.sdztrk+$temp1888.sdztrk+$tempwq1888.sdztrk+$tempgfwz3.sdztrk+$tempgfwj3.sdztrk+$tempzj3.sdztrk+$tempqzccj3.sdztrk+$tempwzccj3.sdztrk/*+$ZJZ.sdztrk*/   as char(20))as sdztrk,
cast($temp3.sdxxyztrk+$tempgf3.sdxxyztrk+$temp6.sdxxyztrk+$temp6_new.sdxxyztrk+$temp15.sdxxyztrk+ $YJ.sdxxyztrk+$temp1588.sdxxyztrk+$temp1888.sdxxyztrk+$tempwq1888.sdxxyztrk+$tempgfwz3.sdxxyztrk+$tempgfwj3.sdxxyztrk+$tempzj3.sdxxyztrk+$tempqzccj3.sdxxyztrk+$tempwzccj3.sdxxyztrk/*+$ZJZ.sdxxyztrk*/ as char(20))as sdxxyztrk,
cast($temp3.KJztrk+$tempgf3.KJztrk+$temp6.KJztrk+$temp6_new.KJztrk+$temp15.KJztrk+ $YJ.KJztrk +$temp1588.KJztrk+$temp1888.KJztrk+$tempwq1888.KJztrk+$tempgfwz3.KJztrk+$tempgfwj3.KJztrk+$tempzj3.KJztrk+$tempqzccj3.KJztrk+$tempwzccj3.KJztrk/*+$ZJZ.KJztrk*/ as char(20))as KJztrk,
cast($temp3.wwrk+$tempgf3.wwrk+$temp6.wwrk+$temp6_new.wwrk+$temp15.wwrk+ $YJ.wwrk+$temp1588.wwrk+$temp1888.wwrk+$tempwq1888.wwrk+$tempgfwz3.wwrk+$tempgfwj3.wwrk+$tempzj3.wwrk+$tempqzccj3.wwrk+$tempwzccj3.wwrk as char(20))as wwrk,
cast($temp3.cgrk+$tempgf3.cgrk+$temp6.cgrk+$temp6_new.cgrk+$temp15.cgrk+ $YJ.cgrk+$temp1588.cgrk+$temp1888.cgrk+$tempwq1888.cgrk+$tempgfwz3.cgrk+$tempgfwj3.cgrk+$tempzj3.cgrk+$tempqzccj3.cgrk+$tempwzccj3.cgrk/*+$ZJZ.cgrk*/ as char(20))as cgrk,
cast($temp3.qtrk+$tempgf3.qtrk+$temp6.qtrk+$temp6_new.qtrk+$temp15.qtrk+ $YJ.qtrk+$temp1588.qtrk+$temp1888.qtrk+$tempwq1888.qtrk+$tempgfwz3.qtrk+$tempgfwj3.qtrk+$tempzj3.qtrk+$tempqzccj3.qtrk+$tempwzccj3.qtrk/*+$ZJZ.qtrk*/   as char(20))as qtrk,
cast($temp3.rkxj+$tempgf3.rkxj+$temp6.rkxj+$temp15.rkxj+$temp6_new.rkxj+ $YJ.rkxj+$temp1588.rkxj+$temp1888.rkxj+$tempwq1888.rkxj+$tempgfwz3.rkxj+$tempgfwj3.rkxj+$tempzj3.rkxj+$tempqzccj3.rkxj+$tempwzccj3.rkxj/*+$ZJZ.rkxj*/ as char(20))as rkxj,
cast($temp3.xsck+$tempgf3.xsck+$temp6.xsck+$temp6_new.xsck+$temp15.xsck+ $YJ.xsck+$temp1588.xsck+$temp1888.xsck+$tempwq1888.xsck+$tempgfwz3.xsck+$tempgfwj3.xsck+$tempzj3.xsck+$tempqzccj3.xsck+$tempwzccj3.xsck/*+$ZJZ.xsck*/   as char(20))as xsck,
cast($temp3.szztck+$tempgf3.szztck+$temp6.szztck+$temp6_new.szztck+$temp15.szztck+ $YJ.szztck+$temp1588.szztck+$temp1888.szztck+$tempwq1888.szztck+$tempgfwz3.szztck+$tempgfwj3.szztck+$tempzj3.szztck+$tempqzccj3.szztck+$tempwzccj3.szztck/*+$ZJZ.szztck*/ as char(20))as szztck,
cast($temp3.szgcck+$tempgf3.szgcck+$temp6.szgcck+$temp6_new.szgcck+$temp15.szgcck+ $YJ.szgcck+$temp1588.szgcck+$temp1888.szgcck+$tempwq1888.szgcck+$tempgfwz3.szgcck+$tempgfwj3.szgcck+$tempzj3.szgcck+$tempqzccj3.szgcck+$tempwzccj3.szgcck/*+$ZJZ.szgcck*/  as char(20))as szgcck,
cast($temp3.szgcrlck+$tempgf3.szgcrlck+$temp6.szgcrlck+$temp6_new.szgcrlck+$temp15.szgcrlck+ $YJ.szgcrlck+$temp1588.szgcrlck+$temp1888.szgcrlck+$tempwq1888.szgcrlck+$tempgfwz3.szgcrlck+$tempgfwj3.szgcrlck+$tempzj3.szgcrlck+$tempqzccj3.szgcrlck+$tempwzccj3.szgcrlck/*+$ZJZ.szgcrlck*/ as char(20))as szgcrlck,
cast($temp3.bjztck+$tempgf3.bjztck+$temp6.bjztck+$temp6_new.bjztck+$temp15.bjztck+ $YJ.bjztck+$temp1588.bjztck+$temp1888.bjztck+$tempwq1888.bjztck+$tempgfwz3.bjztck+$tempgfwj3.bjztck+$tempzj3.bjztck+$tempqzccj3.bjztck+$tempwzccj3.bjztck/*+$ZJZ.bjztck*/  as char(20))as bjztck,
cast($temp3.bjckje+$tempgf3.bjckje+$temp6.bjckje+$temp6_new.bjckje+$temp15.bjckje+ $YJ.bjckje+$temp1588.bjckje+$temp1888.bjckje+$tempwq1888.bjckje+$tempgfwz3.bjckje+$tempgfwj3.bjckje+$tempzj3.bjckje+$tempqzccj3.bjckje+$tempwzccj3.bjckje/*+$ZJZ.bjckje*/  as char(20))as bjckje,
cast($temp3.bjJDSztck+$tempgf3.bjJDSztck+$temp6.bjJDSztck+$temp6_new.bjJDSztck+$temp15.bjJDSztck+ $YJ.bjJDSztck +$temp1588.bjJDSztck+$temp1888.bjJDSztck+$tempwq1888.bjJDSztck+$tempgfwz3.bjJDSztck+$tempgfwj3.bjJDSztck+$tempzj3.bjJDSztck+$tempqzccj3.bjJDSztck+$tempwzccj3.bjJDSztck/*+$ZJZ.bjJDSztck*/  as char(20))as bjJDSztck,
cast($temp3.bjJDSckje+$tempgf3.bjJDSckje+$temp6.bjJDSckje+$temp6_new.bjJDSckje+$temp15.bjJDSckje+ $YJ.bjJDSckje+$temp1588.bjJDSckje+$temp1888.bjJDSckje+$tempwq1888.bjJDSckje+$tempgfwz3.bjJDSckje+$tempgfwj3.bjJDSckje+$tempzj3.bjJDSckje+$tempqzccj3.bjJDSckje+$tempwzccj3.bjJDSckje/*+$ZJZ.bjJDSckje*/  as char(20))as bjJDSckje,
cast($temp3.fzztck+$tempgf3.fzztck+$temp6.fzztck+$temp6_new.fzztck+$temp15.fzztck+ $YJ.fzztck +$temp1588.fzztck+$temp1888.fzztck+$tempwq1888.fzztck+$tempgfwz3.fzztck+$tempgfwj3.fzztck+$tempzj3.fzztck+$tempqzccj3.fzztck+$tempwzccj3.fzztck/*+$ZJZ.fzztck*/  as char(20))as fzztck,
cast($temp3.B2BCK+$tempgf3.B2BCK+$temp6.B2BCK+$temp6_new.B2BCK+$temp15.B2BCK+ $YJ.B2BCK +$temp1588.B2BCK+$temp1888.B2BCK+$tempwq1888.B2BCK+$tempgfwz3.B2BCK+$tempgfwj3.B2BCK+$tempzj3.B2BCK+$tempqzccj3.B2BCK+$tempwzccj3.B2BCK/*+$ZJZ.B2BCK*/  as char(20))as B2Bck,
cast($temp3.zbztck+$tempgf3.zbztck+$temp6.zbztck+$temp6_new.zbztck+$temp15.zbztck+ $YJ.zbztck +$temp1588.zbztck+$temp1888.zbztck+$tempwq1888.zbztck+$tempgfwz3.zbztck+$tempgfwj3.zbztck+$tempzj3.zbztck+$tempqzccj3.zbztck+$tempwzccj3.zbztck/*+$ZJZ.zbztck*/  as char(20))as zbztck,
cast($temp3.sdztck+$tempgf3.sdztck+$temp6.sdztck+$temp6_new.sdztck+$temp15.sdztck+ $YJ.sdztck+$temp1588.sdztck+$temp1888.sdztck+$tempwq1888.sdztck+$tempgfwz3.sdztck+$tempgfwj3.sdztck+$tempzj3.sdztck+$tempqzccj3.sdztck+$tempwzccj3.sdztck/*+$ZJZ.sdztck*/   as char(20))as sdztck,
cast($temp3.sdxxyztck+$tempgf3.sdxxyztck+$temp6.sdxxyztck+$temp6_new.sdxxyztck+$temp15.sdxxyztck+ $YJ.sdxxyztck+$temp1588.sdxxyztck+$temp1888.sdxxyztck+$tempwq1888.sdxxyztck+$tempgfwz3.sdxxyztck+$tempgfwj3.sdxxyztck+$tempzj3.sdxxyztck+$tempqzccj3.sdxxyztck+$tempwzccj3.sdxxyztck/*+$ZJZ.sdxxyztck*/ as char(20))as sdxxyztck,
cast($temp3.kjztck+$tempgf3.kjztck+$temp6.kjztck+$temp6_new.kjztck+$temp15.kjztck+ $YJ.kjztck+$temp1588.kjztck+$temp1888.kjztck+$tempwq1888.kjztck+$tempgfwz3.kjztck+$tempgfwj3.kjztck+$tempzj3.kjztck+$tempqzccj3.kjztck+$tempwzccj3.kjztck/*+$ZJZ.kjztck*/   as char(20))as kjztck,
cast($temp3.wwth+$tempgf3.wwth+$temp6.wwth+$temp6_new.wwth+$temp15.wwth+ $YJ.wwth+$temp1588.wwth+$temp1888.wwth+$tempwq1888.wwth+$tempgfwz3.wwth+$tempgfwj3.wwth+$tempzj3.wwth+$tempqzccj3.wwth+$tempwzccj3.wwth/*+$ZJZ.wwth*/  as char(20))as wwth,
cast($temp3.rlzl+$tempgf3.rlzl+$temp6.rlzl+$temp6_new.rlzl+$temp15.rlzl+ $YJ.rlzl+$temp1588.rlzl+$temp1888.rlzl+$tempwq1888.rlzl+$tempgfwz3.rlzl+$tempgfwj3.rlzl+$tempzj3.rlzl+$tempqzccj3.rlzl+$tempwzccj3.rlzl/*+$ZJZ.rlzl*/  as char(20))as rlzl,
cast($temp3.wxzl+$tempgf3.wxzl+$temp6.wxzl+$temp6_new.wxzl+$temp15.wxzl+ $YJ.wxzl+$temp1588.wxzl+$temp1888.wxzl+$tempwq1888.wxzl+$tempgfwz3.wxzl+$tempgfwj3.wxzl+$tempzj3.wxzl+$tempqzccj3.wxzl+$tempwzccj3.wxzl/*+$ZJZ.wxzl*/  as char(20))as wxzl,
cast($temp3.qxzl+$tempgf3.qxzl+$temp6.qxzl+$temp6_new.qxzl+$temp15.qxzl+ $YJ.qxzl+$temp1588.qxzl+$temp1888.qxzl+$tempwq1888.qxzl+$tempgfwz3.qxzl+$tempgfwj3.qxzl+$tempzj3.qxzl+$tempqzccj3.qxzl+$tempwzccj3.qxzl/*+$ZJZ.qxzl*/   as char(20))as qxzl,
cast($temp3.wtzl+$tempgf3.wtzl+$temp6.wtzl+$temp6_new.wtzl++$temp15.wtzl+ $YJ.wtzl+$temp1588.wtzl+$temp1888.wtzl+$tempwq1888.wtzl+$tempgfwz3.wtzl+$tempgfwj3.wtzl+$tempzj3.wtzl+$tempqzccj3.wtzl+$tempwzccj3.wtzl/*+$ZJZ.wtzl*/  as char(20))as wtzl,
cast($temp3.ckxj+$tempgf3.ckxj+$temp6.ckxj+$temp6_new.ckxj+$temp15.ckxj+ $YJ.ckxj+$temp1588.ckxj+$temp1888.ckxj+$tempwq1888.ckxj+$tempgfwz3.ckxj+$tempgfwj3.ckxj+$tempzj3.ckxj+$tempqzccj3.ckxj+$tempwzccj3.ckxj/*+$ZJZ.ckxj*/  as char(20))as ckxj,
cast($temp3.dqjc+$tempgf3.dqjc+$temp6.dqjc+$temp6_new.dqjc+$temp15.dqjc+ $YJ.dqjc+$temp1588.dqjc+$temp1888.dqjc+$tempwq1888.dqjc+$tempgfwz3.dqjc+$tempgfwj3.dqjc+$tempzj3.dqjc+$tempqzccj3.dqjc+$tempwzccj3.dqjc/*+$ZJZ.dqjc*/  as char(20))as dqjc,
cast($temp3.yk+$tempgf3.yk+$temp6.yk+$temp6_new.yk+$temp15.yk+ $YJ.yk+$temp1588.yk+$temp1888.yk+$tempwq1888.yk+$tempgfwz3.yk+$tempgfwj3.yk+$tempzj3.yk+$tempqzccj3.yk+$tempwzccj3.yk/*+$ZJZ.yk*/  as char(20))as yk,
cast($temp3.jxjdsyyzxck+$tempgf3.jxjdsyyzxck+$temp6.jxjdsyyzxck+$temp6_new.jxjdsyyzxck+$temp15.jxjdsyyzxck+ $YJ.jxjdsyyzxck+$temp1588.jxjdsyyzxck+$temp1888.jxjdsyyzxck+$tempwq1888.jxjdsyyzxck+$tempgfwz3.jxjdsyyzxck+$tempgfwj3.jxjdsyyzxck+$tempzj3.jxjdsyyzxck+$tempqzccj3.jxjdsyyzxck+$tempwzccj3.jxjdsyyzxck/*+$ZJZ.jxjdsyyzxck*/ as char(20))as jxjdsyyzxck,
cast($temp3.jxxxyztck+$tempgf3.jxxxyztck+$temp6.jxxxyztck+$temp6_new.jxxxyztck+$temp15.jxxxyztck+ $YJ.jxxxyztck+$temp1588.jxxxyztck+$temp1888.jxxxyztck+$tempwq1888.jxxxyztck+$tempgfwz3.jxxxyztck+$tempgfwj3.jxxxyztck+$tempzj3.jxxxyztck+$tempqzccj3.jxxxyztck+$tempwzccj3.jxxxyztck/*+$ZJZ.jxxxyztck*/  as char(20))as jxxxyztck,
cast($temp3.jxjdsyyzxrk+$tempgf3.jxjdsyyzxrk+$temp6.jxjdsyyzxrk+$temp6_new.jxjdsyyzxrk+$temp15.jxjdsyyzxrk+ $YJ.jxjdsyyzxrk+$temp1588.jxjdsyyzxrk+$temp1888.jxjdsyyzxrk+$tempwq1888.jxjdsyyzxrk+$tempgfwz3.jxjdsyyzxrk+$tempgfwj3.jxjdsyyzxrk+$tempzj3.jxjdsyyzxrk+$tempqzccj3.jxjdsyyzxrk+$tempwzccj3.jxjdsyyzxrk/*+$ZJZ.jxjdsyyzxrk*/  as char(20))as jxjdsyyzxrk,
cast($temp3.jxxxyztrk+$tempgf3.jxxxyztrk+$temp6.jxxxyztrk+$temp6_new.jxxxyztrk+$temp15.jxxxyztrk+ $YJ.jxxxyztrk+$temp1588.jxxxyztrk+$temp1888.jxxxyztrk+$tempwq1888.jxxxyztrk+$tempgfwz3.jxxxyztrk+$tempgfwj3.jxxxyztrk+$tempzj3.jxxxyztrk+$tempqzccj3.jxxxyztrk+$tempwzccj3.jxxxyztrk/*+$ZJZ.jxxxyztrk*/ as char(20))as jxxxyztrk,
cast($temp3.ymyprk+$tempgf3.ymyprk+$temp6.ymyprk+$temp6_new.ymyprk+$temp15.ymyprk+ $YJ.ymyprk+$temp1588.ymyprk+$temp1888.ymyprk+$tempwq1888.ymyprk+$tempgfwz3.ymyprk+$tempgfwj3.ymyprk+$tempzj3.ymyprk+$tempqzccj3.ymyprk+$tempwzccj3.ymyprk/*+$ZJZ.ymyprk*/ as char(20))as ymyprk,
cast($temp3.ymypck+$tempgf3.ymypck+$temp6.ymypck+$temp6_new.ymypck+$temp15.ymypck+ $YJ.ymypck+$temp1588.ymypck+$temp1888.ymypck+$tempwq1888.ymypck+$tempgfwz3.ymypck+$tempgfwj3.ymypck+$tempzj3.ymypck+$tempqzccj3.ymypck+$tempwzccj3.ymypck/*+$ZJZ.ymypck*/  as char(20))as ymypck,
cast($temp3.zjdxrk+$tempgf3.zjdxrk+$temp6.zjdxrk+$temp6_new.zjdxrk+$temp15.zjdxrk+ $YJ.zjdxrk+$temp1588.zjdxrk+$temp1888.zjdxrk+$tempwq1888.zjdxrk+$tempgfwz3.zjdxrk+$tempgfwj3.zjdxrk+$tempzj3.zjdxrk+$tempqzccj3.zjdxrk+$tempwzccj3.zjdxrk/*+$ZJZ.zjdxrk */ as char(20))as zjdxrk,
cast($temp3.zjdxck+$tempgf3.zjdxck+$temp6.zjdxck+$temp6_new.zjdxck+$temp15.zjdxck+ $YJ.zjdxck+$temp1588.zjdxck+$temp1888.zjdxck+$tempwq1888.zjdxck+$tempgfwz3.zjdxck+$tempgfwj3.zjdxck+$tempzj3.zjdxck+$tempqzccj3.zjdxck+$tempwzccj3.zjdxck/*+$ZJZ.zjdxck*/  as char(20))as zjdxck,
cast($temp3.fjzjrk+$tempgf3.fjzjrk+$temp6.fjzjrk+$temp6_new.fjzjrk+$temp15.fjzjrk+ $YJ.fjzjrk+$temp1588.fjzjrk+$temp1888.fjzjrk+$tempwq1888.fjzjrk+$tempgfwz3.fjzjrk+$tempgfwj3.fjzjrk+$tempzj3.fjzjrk+$tempqzccj3.fjzjrk+$tempwzccj3.fjzjrk/*+$ZJZ.fjzjrk*/  as char(20))as fjzjrk,
cast($temp3.fjzjck+$tempgf3.fjzjck+$temp6.fjzjck+$temp6_new.fjzjck+$temp15.fjzjck+ $YJ.fjzjck+$temp1588.fjzjck+$temp1888.fjzjck+$tempwq1888.fjzjck+$tempgfwz3.fjzjck+$tempgfwj3.fjzjck+$tempzj3.fjzjck+$tempqzccj3.fjzjck+$tempwzccj3.fjzjck/*+$ZJZ.fjzjck*/  as char(20))as fjzjck,
cast($temp3.mxhrk+$tempgf3.mxhrk+$temp6.mxhrk+$temp6_new.mxhrk+$temp15.mxhrk+ $YJ.mxhrk+$temp1588.mxhrk+$temp1888.mxhrk+$tempwq1888.mxhrk+$tempgfwz3.mxhrk+$tempgfwj3.mxhrk+$tempzj3.mxhrk+$tempqzccj3.mxhrk+$tempwzccj3.mxhrk /*+$ZJZ.mxhrk*/ as char(20)) as mxhrk,
cast($temp3.mxhck+$tempgf3.mxhck+$temp6.mxhck+$temp6_new.mxhck+$temp15.mxhck+ $YJ.mxhck+$temp1588.mxhck+$temp1888.mxhck+$tempwq1888.mxhck+$tempgfwz3.mxhck+$tempgfwj3.mxhck+$tempzj3.mxhck+$tempqzccj3.mxhck+$tempwzccj3.mxhck/*+$ZJZ.mxhck*/ as char(20)) as mxhck,
cast($temp3.cdztrk+$tempgf3.cdztrk+$temp6.cdztrk+$temp6_new.cdztrk+$temp15.cdztrk+ $YJ.cdztrk+$temp1588.cdztrk+$temp1888.cdztrk+$tempwq1888.cdztrk+$tempgfwz3.cdztrk+$tempgfwj3.cdztrk+$tempzj3.cdztrk+$tempqzccj3.cdztrk+$tempwzccj3.cdztrk /*+$ZJZ.mxhrk*/ as char(20)) as cdztrk,
cast($temp3.cdztck+$tempgf3.cdztck+$temp6.cdztck+$temp6_new.cdztck+$temp15.cdztck+ $YJ.cdztck+$temp1588.cdztck+$temp1888.cdztck+$tempwq1888.cdztck+$tempgfwz3.cdztck+$tempgfwj3.cdztck+$tempzj3.cdztck+$tempqzccj3.cdztck+$tempwzccj3.cdztck/*+$ZJZ.mxhck*/ as char(20)) as cdztck,
cast($temp3.hnztrk+$tempgf3.hnztrk+$temp6.hnztrk+$temp6_new.hnztrk+$temp15.hnztrk+ $YJ.hnztrk+$temp1588.hnztrk+$temp1888.hnztrk+$tempwq1888.hnztrk+$tempgfwz3.hnztrk+$tempgfwj3.hnztrk+$tempzj3.hnztrk+$tempqzccj3.hnztrk+$tempwzccj3.hnztrk /*+$ZJZ.mxhrk*/ as char(20)) as hnztrk,
cast($temp3.hnztck+$tempgf3.hnztck+$temp6.hnztck+$temp6_new.hnztck+$temp15.hnztck+ $YJ.hnztck+$temp1588.hnztck+$temp1888.hnztck+$tempwq1888.hnztck+$tempgfwz3.hnztck+$tempgfwj3.hnztck+$tempzj3.hnztck+$tempqzccj3.hnztck+$tempwzccj3.hnztck/*+$ZJZ.mxhck*/ as char(20)) as hnztck,
cast($temp3.syztrk+$tempgf3.syztrk+$temp6.syztrk+$temp6_new.syztrk+$temp15.syztrk+ $YJ.syztrk+$temp1588.syztrk+$temp1888.syztrk+$tempwq1888.syztrk+$tempgfwz3.syztrk+$tempgfwj3.syztrk+$tempzj3.syztrk+$tempqzccj3.syztrk+$tempwzccj3.syztrk /*+$ZJZ.mxhrk*/ as char(20)) as syztrk,
cast($temp3.syztck+$tempgf3.syztck+$temp6.syztck+$temp6_new.syztck+$temp15.syztck+ $YJ.syztck+$temp1588.syztck+$temp1888.syztck+$tempwq1888.syztck+$tempgfwz3.syztck+$tempgfwj3.syztck+$tempzj3.syztck+$tempqzccj3.syztck+$tempwzccj3.syztck/*+$ZJZ.mxhck*/ as char(20)) as syztck

from $temp3,$tempgf3,$temp6,$temp6_new,$temp15 ,$temp1588 , $YJ ,$temp1888,$tempwq1888 ,$tempgfwz3,$tempgfwj3,$tempzj3,$tempqzccj3,$tempwzccj3 ;

drop temporary table if exists $temp1;
drop temporary table if exists $temp2;
drop temporary table if exists $temp3;
drop temporary table if exists $tempzj1;
drop temporary table if exists $tempzj2;
drop temporary table if exists $tempzj3;
drop temporary table if exists $yj0 ;
drop temporary table if exists $YJ1 ;
drop temporary table if exists $YJ;
drop temporary table if exists $temp4 ;
drop temporary table if exists $temp5 ;
drop temporary table if exists $temp6;
drop temporary table if exists $temp7 ;
drop temporary table if exists $temp8 ;
drop temporary table if exists $temp9;
drop temporary table if exists $temp10 ;
drop temporary table if exists $temp11 ;
drop temporary table if exists $temp12;

drop temporary table if exists $temp4_new ;
drop temporary table if exists $temp5_new ;
drop temporary table if exists $temp6_new;
drop temporary table if exists $temp7_new ;
drop temporary table if exists $temp8_new ;
drop temporary table if exists $temp9_new;
drop temporary table if exists $temp10_new ;
drop temporary table if exists $temp11_new ;
drop temporary table if exists $temp12_new;

drop temporary table if exists $tempgf1 ;
drop temporary table if exists $tempgf2 ;
drop temporary table if exists $tempgf3;
drop temporary table if exists $tempgfwz1 ;
drop temporary table if exists $tempgfwz2 ;
drop temporary table if exists $tempgfwz3;
drop temporary table if exists $tempgfwj1 ;
drop temporary table if exists $tempgfwj2 ;
drop temporary table if exists $tempgfwj3;
drop temporary table if exists $tempqzccj1 ;
drop temporary table if exists $tempqzccj2 ;
drop temporary table if exists $tempqzccj3;
drop temporary table if exists $tempwzccj1 ;
drop temporary table if exists $tempwzccj2 ;
drop temporary table if exists $tempwzccj3;
/*drop temporary table if exists $ZJZ1 ;
drop temporary table if exists $zjz2 ;
drop temporary table if exists $ZJZ;
drop temporary table if exists $ZJJ1 ;
drop temporary table if exists $ZJJ2 ;
drop temporary table if exists $ZJJ;
drop temporary table if exists $ZJE1 ;
drop temporary table if exists $ZJE2 ;
drop temporary table if exists $ZJE;*/
drop temporary table if exists $temp13 ;
drop temporary table if exists $temp14 ;
drop temporary table if exists $temp15;
drop temporary table if exists $temp1388 ;
drop temporary table if exists $temp1488 ;
drop temporary table if exists $temp1588;
drop temporary table if exists $temp1688 ;
drop temporary table if exists $temp1788 ;
drop temporary table if exists $temp1888;
drop temporary table if exists $tempwq1688 ;
drop temporary table if exists $tempwq1788 ;
drop temporary table if exists $tempwq1888;
drop temporary table if exists $wwth;
drop temporary table if exists $temp200 ;
drop temporary table if exists $temp201 ;
drop temporary table if exists $temp20;
drop temporary table if exists $tempzj200 ;
drop temporary table if exists $tempzj201 ;
drop temporary table if exists $tempzj20;
drop temporary table if exists $tempgf200 ;
drop temporary table if exists $tempgf201 ;
drop temporary table if exists $tempgf20;
drop temporary table if exists $tempgfwz200 ;
drop temporary table if exists $tempgfwz201 ;
drop temporary table if exists $tempgfwz20;
drop temporary table if exists $tempgfwj200 ;
drop temporary table if exists $tempgfwj201 ;
drop temporary table if exists $tempgfwj20;
drop temporary table if exists $tempqzccj200 ;
drop temporary table if exists $tempqzccj201 ;
drop temporary table if exists $tempqzccj20;
drop temporary table if exists $tempwzccj200 ;
drop temporary table if exists $tempwzccj201 ;
drop temporary table if exists $tempwzccj20;
drop temporary table if exists $YJGF1 ;
drop temporary table if exists $YJGF2 ;
drop temporary table if exists $YJGF;
drop temporary table if exists $temp210 ;
drop temporary table if exists $temp211 ;
drop temporary table if exists $temp21;
drop temporary table if exists $temp21088 ;
drop temporary table if exists $temp21188 ;
drop temporary table if exists $temp2188;
drop temporary table if exists $temp212 ;
drop temporary table if exists $temp213 ;
drop temporary table if exists $temp214;
drop temporary table if exists $tempwq212 ;
drop temporary table if exists $tempwq213 ;
drop temporary table if exists $tempwq214;
drop temporary table if exists $temp31 ;
drop temporary table if exists $temp32 ;
drop temporary table if exists $temp33;
drop temporary table if exists $temp34 ;
drop temporary table if exists $temp35 ;
drop temporary table if exists $temp36;
drop temporary table if exists $temp17 ;
drop temporary table if exists $temp18 ;
drop temporary table if exists $temp19;
drop temporary table if exists $ylgf1 ;
drop temporary table if exists $YLGF2 ;
drop temporary table if exists $YLGF;
drop temporary table if exists TEMP_RESAULT;

END
;;
delimiter ;

SET FOREIGN_KEY_CHECKS = 1;
